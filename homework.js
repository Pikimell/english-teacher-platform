import"./assets/main-Ci6GKLq-.js";import"./assets/catalog-CUy5064c.js";import{a as w}from"./assets/auth-D2b1UgGY.js";import{a as g,b as C,c as L}from"./assets/practice-BIgcHkuR.js";import{u as E}from"./assets/homework-updates-BonAOvpp.js";import"./assets/custom-lessons-store-BKMVZjuV.js";import"./assets/vendor-CWxt7QI6.js";const h=document.querySelector("[data-homework-status]"),k=document.querySelector("[data-homework-list]");if(h&&k){let c=function(t){h.textContent=t||"",h.hidden=!t},o=function(){k.innerHTML=""},y=function(t){if(!t||typeof t!="object")return null;if(typeof t.url=="string"&&t.url)return t.url;if(typeof t.link=="string"&&t.link)return t.link;const e=new URLSearchParams,r=t.lessonId||t.topicId||t.id||null,n=t.htmlPath||t.lessonPath||null,u=t.category||t.lessonCategory||null,p=t.level||t.lessonLevel||null,a=t.title||t.lessonTitle||t.name||null;return r&&e.set("topic",r),u&&e.set("category",u),p&&e.set("level",p),a&&e.set("title",a),n&&e.set("file",n),e.has("topic")?`lesson.html?${e.toString()}`:null},f=function(t){const e=(t==null?void 0:t.dueDate)||(t==null?void 0:t.deadline)||(t==null?void 0:t.due_at)||(t==null?void 0:t.dueAt)||null;if(!e)return null;const r=new Date(e);if(Number.isNaN(r.getTime()))return null;try{return new Intl.DateTimeFormat("uk-UA",{dateStyle:"medium"}).format(r)}catch{return r.toLocaleDateString("uk-UA")}},d=function(t){const e=document.createElement("article");e.className="homework-card",e.setAttribute("role","listitem"),e.dataset.id=t==null?void 0:t.lessonId;const r=document.createElement("h3");r.className="homework-card__title",r.textContent=t==null?void 0:t.lessonName,e.appendChild(r);const n=f(t);if(n){const a=document.createElement("p");a.className="homework-card__meta",a.textContent=`Строк: ${n}`,e.appendChild(a)}const u=(t==null?void 0:t.description)||(t==null?void 0:t.lessonDescription)||(t==null?void 0:t.summary)||"";if(u){const a=document.createElement("p");a.className="homework-card__description",a.textContent=u,e.appendChild(a)}if(y(t)){const a=document.createElement("button");a.className="homework-card__link",a.textContent="відкрити",e.appendChild(a),e.addEventListener("click",()=>{b(t==null?void 0:t.lessonId)})}return e},l=function(t){if(!Array.isArray(t)||!t.length){c("Домашніх робіт поки немає.");return}c("");const e=document.createDocumentFragment();t.forEach(r=>{e.appendChild(d(r))}),k.appendChild(e)},m=0;async function i(t){if(!t||!t.email){c("Увійдіть, щоб переглянути призначені домашні роботи."),o();return}const e=++m;c("Завантаження домашніх робіт…"),o();try{const r=await g(t.email);if(e!==m)return;l(r)}catch(r){if(console.log(r),e!==m)return;console.error("Не вдалося завантажити домашні роботи",r),c("Не вдалося завантажити домашні роботи. Спробуйте пізніше."),o()}}w.subscribe(t=>{if(!t.isSignedIn){c("Увійдіть, щоб переглянути призначені домашні роботи."),o();return}i(t.user)})}async function b(m){const o=w.getUser().email,f=[...(await C({userEmail:o,lessonId:m,limit:1e3})).items].sort((i,t)=>i.homeworkType==="task"),d=document.createElement("div");for(const i of f)if(i.homeworkType==="task")try{const t=JSON.parse(i.homeworkData),e=L(t);e.id=i._id,E(e,i.answers),d.appendChild(e)}catch(t){console.log(t)}else if(i.homeworkType==="theory"){const t=i.homeworkData;d.insertAdjacentHTML("afterbegin",t)}const l=document.querySelector(".js-homework-content");l.innerHTML="",l.append(...d.children)}
//# sourceMappingURL=homework.js.map
