import"./assets/main-DFnbEuqS.js";import"./assets/catalog-DoDS_e-q.js";import{a as g}from"./assets/custom-lesson-presets-BtHs6aRX.js";import{d as w,g as s,e as L,f as C}from"./assets/practice-CEIBsXMP.js";import"./assets/custom-lessons-store-BKMVZjuV.js";import"./assets/vendor-CWxt7QI6.js";const E=document.querySelector(".js-homework-content");E.addEventListener("change",a=>{const i=a.target.id,c=a.target.closest("section").id,l=a.target.value,m=a.target.name;let u=a.target.nodeName.toLowerCase();u==="input"&&a.target.type!=="input"&&(u=a.target.type),w({inputId:i,taskId:c,value:l,type:u,name:m})});function b(a,i){for(const c of i){const l=c.inputId,m=a.querySelector(`#${l}`);c.type!=="checkbox"&&c.type!="radio"?m.setAttribute("value",c.value):m.setAttribute("checked",!0)}}const k=document.querySelector("[data-homework-status]"),y=document.querySelector("[data-homework-list]");if(k&&y){let i=function(t){k.textContent=t||"",k.hidden=!t},c=function(){y.innerHTML=""},l=function(t){if(!t||typeof t!="object")return null;if(typeof t.url=="string"&&t.url)return t.url;if(typeof t.link=="string"&&t.link)return t.link;const e=new URLSearchParams,r=t.lessonId||t.topicId||t.id||null,d=t.htmlPath||t.lessonPath||null,f=t.category||t.lessonCategory||null,h=t.level||t.lessonLevel||null,n=t.title||t.lessonTitle||t.name||null;return r&&e.set("topic",r),f&&e.set("category",f),h&&e.set("level",h),n&&e.set("title",n),d&&e.set("file",d),e.has("topic")?`lesson.html?${e.toString()}`:null},m=function(t){const e=(t==null?void 0:t.dueDate)||(t==null?void 0:t.deadline)||(t==null?void 0:t.due_at)||(t==null?void 0:t.dueAt)||null;if(!e)return null;const r=new Date(e);if(Number.isNaN(r.getTime()))return null;try{return new Intl.DateTimeFormat("uk-UA",{dateStyle:"medium"}).format(r)}catch{return r.toLocaleDateString("uk-UA")}},u=function(t){const e=document.createElement("article");e.className="homework-card",e.setAttribute("role","listitem"),e.dataset.id=t==null?void 0:t.lessonId;const r=document.createElement("h3");r.className="homework-card__title",r.textContent=t==null?void 0:t.lessonName,e.appendChild(r);const d=m(t);if(d){const n=document.createElement("p");n.className="homework-card__meta",n.textContent=`Строк: ${d}`,e.appendChild(n)}const f=(t==null?void 0:t.description)||(t==null?void 0:t.lessonDescription)||(t==null?void 0:t.summary)||"";if(f){const n=document.createElement("p");n.className="homework-card__description",n.textContent=f,e.appendChild(n)}if(l(t)){const n=document.createElement("button");n.className="homework-card__link",n.textContent="відкрити",e.appendChild(n),e.addEventListener("click",()=>{v(t==null?void 0:t.lessonId)})}return e},p=function(t){if(console.log(t),!Array.isArray(t)||!t.length){i("Домашніх робіт поки немає.");return}i("");const e=document.createDocumentFragment();t.forEach(r=>{e.appendChild(u(r))}),y.appendChild(e)},a=0;async function o(t){if(!t||!t.email){i("Увійдіть, щоб переглянути призначені домашні роботи."),c();return}const e=++a;i("Завантаження домашніх робіт…"),c();try{const r=await s(t.email);if(e!==a)return;const d=r;console.log(d),p(d)}catch(r){if(console.log(r),e!==a)return;console.error("Не вдалося завантажити домашні роботи",r),i("Не вдалося завантажити домашні роботи. Спробуйте пізніше."),c()}}g.subscribe(t=>{if(!t.isSignedIn){i("Увійдіть, щоб переглянути призначені домашні роботи."),c();return}o(t.user)})}async function v(a){const c=g.getUser().email,m=[...(await L({userEmail:c,lessonId:a,limit:1e3})).items].sort((o,t)=>o.homeworkType==="task"),u=document.createElement("div");for(const o of m)if(console.log(o),o.homeworkType==="task")try{const t=JSON.parse(o.homeworkData),e=C(t);e.id=o._id,b(e,o.answers),u.appendChild(e)}catch{}else if(o.homeworkType==="theory"){const t=o.homeworkData;u.insertAdjacentHTML("afterbegin",t)}const p=document.querySelector(".js-homework-content");p.innerHTML=u.innerHTML}
//# sourceMappingURL=homework.js.map
