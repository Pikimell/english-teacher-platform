import{i as z,a as G}from"./custom-lesson-presets-BtHs6aRX.js";const Le=async A=>(await z.post("/homework/list",A)).data,Ee=async A=>(await z.post("/homework",A)).data,_e=async A=>{const S={page:1,limit:100,userEmail:A},B=await z.post("/homework/lessons",S),{data:t}=B;return t.items=t.items.reverse(),t.items},Ae=async(A=1,S=1e3)=>(await z.get("/user")).data,$e={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},Se=function(){const A=typeof import.meta<"u"&&$e&&"/"||"/";function S(n){const e=A.endsWith("/")?A:`${A}/`,o=String(n||"");return/^[a-z]+:/i.test(o)||o.startsWith(e)?o:`${e}${o.replace(/^\/+/,"")}`}function B(){try{const e=new URL(window.location.href).pathname.split("/");let o=e.pop();(!o||!/\.html?$/i.test(o))&&(o="index.html");const l=o.replace(/\.html?$/i,".json");return e.push("practice",l),e.join("/")}catch{return null}}function t(n,e={},...o){const l=document.createElement(n);for(const[p,i]of Object.entries(e||{}))p==="class"?l.className=i:p==="html"?l.innerHTML=i:p.startsWith("on")&&typeof i=="function"?l.addEventListener(p.slice(2),i):l.setAttribute(p,i);for(const p of o)p!=null&&l.appendChild(typeof p=="string"?document.createTextNode(p):p);return l}function M(n){const e=n.slice();for(let o=e.length-1;o>0;o--){const l=Math.floor(Math.random()*(o+1));[e[o],e[l]]=[e[l],e[o]]}return e}function w(n){return String(n||"").trim().toLowerCase().replace(/\s+/g," ")}const v={users:null,request:null,active:null};function J(){return v.users?Promise.resolve(v.users):(v.request||(v.request=Ae().then(n=>{const e=Array.isArray(n==null?void 0:n.items)?n.items:[];return v.users=e,e}).catch(n=>{throw console.error("Не вдалося завантажити список студентів",n),n}).finally(()=>{v.request=null})),v.request)}function V(n){if(!n||typeof n!="object")return"Невідомий студент";const e=n.firstName||n.firstname||n.nameFirst||"",o=n.lastName||n.lastname||n.nameLast||"";return[e,o].map(i=>String(i||"").trim()).filter(Boolean).join(" ")||n.displayName||n.fullName||n.username||n.email||(n.id?`ID ${n.id}`:"")||"Без імені"}function k(){if(!v.active)return;const{panel:n,button:e}=v.active;n.style.display="none",n.dataset.open="false",e.setAttribute("aria-expanded","false"),v.active=null}const T=new Set;let q=!1;function N(n){const{button:e,panel:o}=n;if(!(!e||!o)){if(!e.isConnected&&!o.isConnected){T.delete(n);return}if(q){e.hidden=!1;return}e.hidden=!0,o.style.display="none",o.dataset.open="false"}}function K(n,e){const o={button:n,panel:e};return T.add(o),N(o),()=>{T.delete(o)}}function Q(n){const e=!!n;q!==e&&(q=e,q||k(),T.forEach(o=>N(o)))}G.subscribe(({user:n})=>{Q(G.isAdmin(n))});function X(n){if(!v.active)return;const{panel:e,button:o}=v.active,l=n.target;e.contains(l)||o.contains(l)||k()}function Y(n){n.key==="Escape"&&k()}function Z(n,e,o){if(n.innerHTML="",!e.length){n.appendChild(t("div",{class:"muted",style:"font-size:13px;text-align:center;padding:12px 8px;"},"Список студентів порожній"));return}const l=t("ul",{style:"list-style:none;margin:0;padding:0;max-height:220px;overflow:auto;"});e.forEach(p=>{const i=t("button",{type:"button",style:"width:100%;background:transparent;border:none;text-align:left;padding:8px 10px;border-radius:8px;cursor:pointer;display:flex;flex-direction:column;gap:2px;",onmouseenter:()=>{i.style.backgroundColor="#f1f5f9"},onmouseleave:()=>{i.style.backgroundColor="transparent"},onclick:()=>{const a=window.location.search.slice(8),f=document.querySelector("h1").textContent;console.log(a);const s={lessonId:a,userEmail:p.email,lessonName:f,homeworkType:"task",homeworkData:JSON.stringify(o)};Ee(s),k()}},t("span",{style:"font-size:14px;font-weight:600;color:#0f172a;"},V(p)),p.email?t("span",{class:"muted",style:"font-size:12px;color:#475569;"},p.email):null),r=t("li",{style:"margin:0;padding:0;"},i);l.appendChild(r)}),n.appendChild(l)}function ee(){return t("div",{class:"practice-share-panel",role:"dialog","aria-label":"Надсилання завдання студенту",style:"position:absolute;top:38px;right:0;min-width:240px;max-width:280px;border:1px solid #e2e8f0;border-radius:12px;background:#fff;box-shadow:0 18px 40px rgba(15,23,42,0.18);padding:8px;z-index:30;display:none;","data-open":"false"})}function te(n,e,o){if(e.dataset.open==="true"){k();return}v.active&&v.active.panel!==e&&k(),e.dataset.open="true",e.style.display="block",n.setAttribute("aria-expanded","true"),e.innerHTML="",e.appendChild(t("div",{class:"muted",style:"font-size:13px;padding:12px 8px;text-align:center;"},"Завантаження…")),v.active={panel:e,button:n},J().then(p=>{Z(e,p,o)}).catch(()=>{e.innerHTML="",e.appendChild(t("div",{style:"color:#ef4444;font-size:13px;text-align:center;padding:12px 8px;"},"Не вдалося завантажити студентів. Спробуйте ще раз."))})}function ne(n){const e=ee(),o=t("button",{type:"button",class:"practice-share-trigger for-admin js-share-homework-btn",title:"Надіслати студенту","aria-haspopup":"dialog","aria-expanded":"false",style:"border:none;background:#2563eb;color:#fff;padding:4px 10px;border-radius:999px;font-size:12px;line-height:1;cursor:pointer;box-shadow:0 4px 12px rgba(37,99,235,0.24);",onclick:l=>{l.preventDefault(),te(o,e,n)}},"Надіслати");return{button:o,panel:e}}document.addEventListener("click",X),document.addEventListener("keydown",Y);function j(n){const e=t("div",{class:"hint-wrap",style:"margin-top:6px;"}),o=t("button",{type:"button",class:"hint-toggle","aria-label":"Показати підказку",title:"Підказка",style:"border:none;background:transparent;color:#94a3b8;cursor:pointer;padding:0;font-size:14px;line-height:1;"},"?"),l=t("div",{class:"hint-box muted",style:"display:none;margin-top:6px;color:#475569;"},`Підказка: ${n}`);return o.addEventListener("click",()=>{const p=l.style.display==="none";l.style.display=p?"block":"none",o.setAttribute("aria-expanded",p?"true":"false")}),e.appendChild(o),e.appendChild(l),e}function re(n,e){n.appendChild(t("h3",{},e.prompt||"Choose the correct option"));const o=[];(e.items||[]).forEach((i,r)=>{const a=`${e.id||"mcq"}-${r}`,f=Array.isArray(i.answer)&&i.answer.length>1,s=t("div",{class:"mcq-item",style:"margin-bottom:10px;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"},t("div",{class:"q",style:"margin-bottom:8px;font-weight:600;"},i.q));(i.choices||[]).forEach((d,c)=>{const h=`${a}-${c}`,g=t("label",{for:h,style:"display:flex;align-items:center;gap:8px;margin:4px 0;"},t("input",{type:f?"checkbox":"radio",name:a,id:h,value:String(c)}),t("span",{},d));s.appendChild(g)}),i.explanation&&s.appendChild(t("div",{class:"exp muted",style:"display:none;margin-top:6px;color:#475569;"},i.explanation)),o.push({block:s,item:i,name:a}),n.appendChild(s)});const l=t("div",{class:"result",style:"margin-top:8px;font-weight:600;"}),p=t("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"Перевірити");p.addEventListener("click",()=>{let i=0;o.forEach(({block:r,item:a,name:f})=>{const s=Array.isArray(a.answer)?a.answer.map(String):[String(a.answer)],c=Array.from(r.querySelectorAll(`input[name='${f}']`)).filter(u=>u.checked).map(u=>u.value).sort(),h=s.slice().sort(),g=c.length===h.length&&c.every((u,y)=>u===h[y]);r.style.borderColor=g?"#10b981":"#ef4444";const b=r.querySelector(".exp");b&&(b.style.display=g?"none":"block"),g&&i++}),l.textContent=`Результат: ${i}/${o.length}`}),n.appendChild(p),n.appendChild(l)}function oe(n,e){n.appendChild(t("h3",{},e.prompt||"Fill the gaps"));const o=[];(e.items||[]).forEach((i,r)=>{const a=t("div",{style:"margin-bottom:10px;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"}),f=String(i.q||"").split(/___/),s=t("input",{type:"text",style:"padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});f.length>1?(a.appendChild(t("span",{},f[0])),a.appendChild(s),a.appendChild(t("span",{},f.slice(1).join("___")))):(a.appendChild(t("div",{style:"margin-bottom:6px;font-weight:600;"},i.q)),a.appendChild(s)),i.hint&&a.appendChild(j(i.hint)),o.push({row:a,input:s,answers:(i.answer||[]).map(d=>w(d))}),n.appendChild(a)});const l=t("div",{style:"margin-top:8px;font-weight:600;"}),p=t("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"Перевірити");p.addEventListener("click",()=>{let i=0;o.forEach(({row:r,input:a,answers:f})=>{const s=w(a.value),d=f.includes(s);r.style.borderColor=d?"#10b981":"#ef4444",d&&i++}),l.textContent=`Результат: ${i}/${o.length}`}),n.appendChild(p),n.appendChild(l)}function O(n,e){n.appendChild(t("h3",{},e.prompt||"Match pairs"));const o=e.pairs||[],l=M(o.map(a=>a.right)),p=[];o.forEach(a=>{const f=t("select",{style:"padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"},t("option",{value:""},"— обери —"),...l.map(d=>t("option",{value:d},d))),s=t("div",{style:"display:flex;align-items:center;gap:10px;margin:8px 0;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"},t("div",{style:"min-width:160px;font-weight:600;"},a.left),f);p.push({row:s,select:f,right:a.right}),n.appendChild(s)});const i=t("div",{style:"margin-top:8px;font-weight:600;"}),r=t("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"Перевірити");r.addEventListener("click",()=>{let a=0;p.forEach(({row:f,select:s,right:d})=>{const c=s.value===d;f.style.borderColor=c?"#10b981":"#ef4444",c&&a++}),i.textContent=`Результат: ${a}/${p.length}`}),n.appendChild(r),n.appendChild(i)}function ie(n,e){n.appendChild(t("h3",{},e.prompt||"Прочитайте текст та дайте відповіді"));const o=e.context||{},l=String(o.format||"narrative").toLowerCase(),p=Array.isArray(o.body)?o.body:[],i=t("div",{style:"margin:12px 0;padding:14px;border:1px solid #cbd5e1;border-radius:10px;background:#f8fafc;"});o.title&&i.appendChild(t("h4",{style:"margin:0 0 8px;font-size:18px;"},o.title)),l==="dialog"?p.forEach(d=>{if(!d)return;const c=typeof d=="object"&&d.speaker?`${d.speaker}:`:"",h=typeof d=="object"&&"line"in d?d.line:typeof d=="string"?d:"";i.appendChild(t("p",{style:"margin:4px 0;display:flex;gap:6px;align-items:flex-start;line-height:1.5;"},c?t("strong",{},c):null,t("span",{},h)))}):p.forEach((d,c)=>{const h=typeof d=="string"?d:d&&d.text?d.text:"";h&&i.appendChild(t("p",{style:c?"margin:8px 0 0;":"margin:0;"},h))}),n.appendChild(i);const r=Array.isArray(e.questions)?e.questions:[];if(!r.length)return;const a=[];r.forEach((d,c)=>{const h=t("div",{style:"margin-bottom:12px;padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"},t("div",{style:"margin-bottom:8px;font-weight:600;"},d.q||`Питання ${c+1}`)),g=Array.isArray(d.answer)?d.answer.map(String):d.answer!=null?[String(d.answer)]:[];if(Array.isArray(d.choices)&&d.choices.length){const b=`${e.id||"context"}-${c}`,u=g.length>1,y=g.every(C=>/^\d+$/.test(C));d.choices.forEach((C,x)=>{const m=`${b}-${x}`;h.appendChild(t("label",{for:m,style:"display:flex;align-items:center;gap:8px;margin:4px 0;"},t("input",{type:u?"checkbox":"radio",name:b,id:m,value:String(x)}),t("span",{},C)))}),a.push({block:h,type:"choices",allowMulti:u,getPicked:()=>{const x=Array.from(h.querySelectorAll(`input[name='${b}']`)).filter(m=>m.checked).map(m=>m.value);return y?x:x.map(m=>w(d.choices[Number(m)]||""))},expected:y?g:g.map(C=>w(C))})}else{const b=t("textarea",{rows:2,style:"width:100%;max-width:640px;padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});h.appendChild(b),a.push({block:h,type:"text",input:b,expected:g.map(u=>w(u))})}d.explanation&&h.appendChild(t("div",{class:"muted",style:"display:none;margin-top:6px;color:#475569;"},d.explanation)),n.appendChild(h)});const f=t("div",{style:"margin-top:8px;font-weight:600;"}),s=t("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"Перевірити");s.addEventListener("click",()=>{let d=0;a.forEach(c=>{let h=!1;if(c.type==="choices"){const b=c.getPicked().sort(),u=c.expected.slice().sort();h=b.length===u.length&&b.every((y,C)=>y===u[C])}else{const b=w(c.input.value);h=c.expected.length?c.expected.includes(b):!!b}c.block.style.borderColor=h?"#10b981":"#ef4444";const g=c.block.querySelector(".muted");g&&(g.style.display=h?"none":"block"),h&&d++}),f.textContent=`Результат: ${d}/${a.length}`}),n.appendChild(s),n.appendChild(f)}function P(n,e,o,l={}){const{showRemove:p=!0}=l,i=o||(e&&e.id?String(e.id):`task-${Math.random().toString(16).slice(2,8)}`),r=t("section",{style:"position:relative;margin:18px 0 26px;","data-task-id":e&&e.id?String(e.id):"","data-task-key":i}),a=t("div",{style:"position:absolute;top:6px;right:6px;display:flex;gap:6px;align-items:center;z-index:5;"}),{button:f,panel:s}=ne(e),d=K(f,s);if(a.appendChild(f),p){const g=t("button",{type:"button",title:"Видалити завдання","aria-label":"Видалити завдання",style:"border:none;background:transparent;color:#94a3b8;cursor:pointer;padding:2px;line-height:1;font-size:14px;opacity:0.6;",onmouseenter:()=>g.style.opacity="1",onmouseleave:()=>g.style.opacity="0.6",onclick:()=>{v.active&&v.active.panel===s&&k(),document.dispatchEvent(new CustomEvent("practice:taskRemoved",{detail:{key:i,task:e}})),d(),r.remove()}},"✕");a.appendChild(g)}r.appendChild(a),r.appendChild(s),e.title&&r.appendChild(t("h3",{},e.title));const c=e&&e.type;switch(String(c||"").trim().toLowerCase()){case"mcq":re(r,e);break;case"gap":oe(r,e);break;case"match":O(r,e);break;case"context":ie(r,e);break;case"transform":se(r,e);break;case"error":pe(r,e);break;case"order":de(r,e);break;case"short":le(r,e);break;case"roleplay":fe(r,e);break;case"dialogue-gap":ue(r,e);break;case"dialogue-order":he(r,e);break;case"truefalse":xe(r,e);break;case"definition-match":{const g={...e,prompt:e.prompt||"Поєднай слово з визначенням"};O(r,g);break}case"synonym-clue":ge(r,e);break;case"scramble":ye(r,e);break;case"wordpairs":{const g={...e,prompt:e.prompt||"Поєднай форму в однині та множині"};O(r,g);break}case"odd-one-out":be(r,e);break;case"open":ce(r,e);break;case"writing":me(r,e);break;default:r.appendChild(t("div",{class:"muted"},`Невідомий тип завдання: ${c}`))}return n.appendChild(r),r}function R(n,e={}){const o=D();if(!o||!n)return;const l=o.querySelector("#practice-body")||o,p=e.showRemove!==!1;P(l,n,e.key,{showRemove:p})}function W(n,e,o={}){if(!n)return null;const l=Array.isArray(e)?e.filter(Boolean):[],{title:p,level:i,description:r,keyPrefix:a="inline",showEmptyNote:f=!1,showRemove:s=!1}=o;if(!l.length){if(f){const c=t("p",{class:"muted practice-inline__empty"},"Практика для цієї теми поки відсутня.");n.appendChild(c)}return null}const d=t("section",{class:"practice-inline"});if(p||i||r){const c=t("header",{class:"practice-inline__header"});p&&c.appendChild(t("h3",{class:"practice-inline__title"},p)),i&&c.appendChild(t("span",{class:"practice-inline__badge"},i)),r&&c.appendChild(t("p",{class:"practice-inline__description muted"},r)),d.appendChild(c)}return l.forEach((c,h)=>{const g=`${a}-${h}`;P(d,c,g,{showRemove:s})}),n.appendChild(d),document.dispatchEvent(new CustomEvent("practice:inlineRendered",{detail:{tasks:l,container:n,options:o}})),d}function H(n,e={}){if(!n)return null;const o=document.createDocumentFragment(),l=e.showRemove!==!1;return P(o,n,e.key,{showRemove:l})}async function I(n){if(!n)return null;const e=S(n);try{const o=await fetch(e,{cache:"no-store"});return o.ok?await o.json():null}catch{return null}}async function ae(){const n=document.getElementById("practice-data");if(n)try{return JSON.parse(n.textContent)}catch{return null}const e=window.lessonContext||{},o=new Set;if(e.id&&o.add(`data/practice/${e.id}.json`),e.htmlPath){const p=String(e.htmlPath).replace(/^\.\/?/,"").replace(/\.html?$/i,"");if(p){o.add(`data/practice/${p}.json`);const i=p.split("/"),r=i[i.length-1];r&&o.add(`data/practice/${r}.json`)}}for(const p of o){const i=await I(p);if(i)return i}const l=B();return l?await I(l):null}function se(n,e){n.appendChild(t("h3",{},e.prompt||"Transform the sentence"));const o=[];(e.items||[]).forEach(i=>{const r=t("div",{style:"margin-bottom:10px;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"});r.appendChild(t("div",{style:"margin-bottom:6px;font-weight:600;"},i.q));const a=t("input",{type:"text",style:"width:100%;max-width:640px;padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});r.appendChild(a),i.hint&&r.appendChild(j(i.hint)),o.push({row:r,input:a,answers:(i.answer||[]).map(f=>w(f))}),n.appendChild(r)});const l=t("div",{style:"margin-top:8px;font-weight:600;"}),p=t("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"Перевірити");p.addEventListener("click",()=>{let i=0;o.forEach(({row:r,input:a,answers:f})=>{const s=f.includes(w(a.value));r.style.borderColor=s?"#10b981":"#ef4444",s&&i++}),l.textContent=`Результат: ${i}/${o.length}`}),n.appendChild(p),n.appendChild(l)}function pe(n,e){n.appendChild(t("h3",{},e.prompt||"Find and correct the error"));const o=[];(e.items||[]).forEach(i=>{const r=t("div",{style:"margin-bottom:10px;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"});r.appendChild(t("div",{style:"margin-bottom:6px;font-weight:600;"},i.q));const a=t("input",{type:"text",style:"width:100%;max-width:640px;padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});r.appendChild(a),i.hint&&r.appendChild(j(i.hint)),o.push({row:r,input:a,answers:(i.answer||[]).map(f=>w(f))}),n.appendChild(r)});const l=t("div",{style:"margin-top:8px;font-weight:600;"}),p=t("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"Перевірити");p.addEventListener("click",()=>{let i=0;o.forEach(({row:r,input:a,answers:f})=>{const s=f.includes(w(a.value));r.style.borderColor=s?"#10b981":"#ef4444",s&&i++}),l.textContent=`Результат: ${i}/${o.length}`}),n.appendChild(p),n.appendChild(l)}function de(n,e){n.appendChild(t("h3",{},e.prompt||"Put the words in order"));const o=[];(e.items||[]).forEach((i,r)=>{const a=w(Array.isArray(i.answer)?i.answer.join(" "):i.answer),f=M((i.tokens||[]).slice()),s=t("div",{style:"margin:10px 0;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"}),d=t("div",{style:"display:flex;flex-wrap:wrap;gap:6px;margin-bottom:6px;"}),c=t("div",{style:"display:flex;flex-wrap:wrap;gap:6px;min-height:36px;padding:6px;border:1px dashed #cbd5e1;border-radius:8px;background:#f8fafc;"}),h=new Set;function g(y,C){const x=t("button",{type:"button",style:"padding:4px 8px;border:1px solid #cbd5e1;border-radius:6px;background:#fff;cursor:pointer;"},y);return x.addEventListener("click",()=>{h.has(C)||(h.add(C),x.style.opacity=.5,c.appendChild(t("span",{class:"chip",style:"padding:4px 8px;border:1px solid #cbd5e1;border-radius:6px;background:#fff;"},y)))}),x}f.forEach((y,C)=>d.appendChild(g(y,`${r}-${C}`)));const b=t("div",{style:"margin-top:6px;display:flex;gap:8px;"}),u=t("button",{type:"button",class:"btn"},"Скинути");u.addEventListener("click",()=>{h.clear(),c.innerHTML="",Array.from(d.children).forEach(y=>y.style.opacity=1),s.style.borderColor="#e5e7eb"}),b.appendChild(u),s.appendChild(t("div",{style:"margin-bottom:6px;font-weight:600;"},i.q||"")),s.appendChild(d),s.appendChild(c),s.appendChild(b),o.push({row:s,outWrap:c,correctStr:a}),n.appendChild(s)});const l=t("div",{style:"margin-top:8px;font-weight:600;"}),p=t("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"Перевірити");p.addEventListener("click",()=>{let i=0;o.forEach(({row:r,outWrap:a,correctStr:f})=>{const d=w(Array.from(a.querySelectorAll(".chip")).map(c=>c.textContent).join(" "))===f;r.style.borderColor=d?"#10b981":"#ef4444",d&&i++}),l.textContent=`Результат: ${i}/${o.length}`}),n.appendChild(p),n.appendChild(l)}function le(n,e){n.appendChild(t("h3",{},e.prompt||"Short answer"));const o=[];(e.items||[]).forEach(i=>{const r=t("div",{style:"margin-bottom:10px;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"});r.appendChild(t("div",{style:"margin-bottom:6px;font-weight:600;"},i.q));const a=t("textarea",{rows:3,style:"width:100%;max-width:720px;padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});r.appendChild(a),o.push({row:r,input:a,keywords:(i.keywords||[]).map(f=>w(f))}),n.appendChild(r)});const l=t("div",{style:"margin-top:8px;font-weight:600;"}),p=t("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"Перевірити");p.addEventListener("click",()=>{let i=0,r=0;o.forEach(({row:a,input:f,keywords:s})=>{const d=w(f.value),c=s.filter(g=>d.includes(g)).length;i+=c,r+=s.length,a.style.borderColor=c===s.length?"#10b981":c>0?"#f59e0b":"#ef4444";const h=a.querySelector(".short-info")||t("div",{class:"short-info",style:"margin-top:6px;color:#475569;"});h.textContent=`Збіги ключових слів: ${c}/${s.length}`,a.contains(h)||a.appendChild(h)}),l.textContent=`Загальний збіг ключових слів: ${i}/${r}`}),n.appendChild(p),n.appendChild(l)}function ce(n,e){n.appendChild(t("h3",{},e.prompt||"Відповіді у вільній формі"));const o=Array.isArray(e&&e.items)?e.items.filter(Boolean):[];if(o.length){const p=t("div",{style:"display:flex;flex-direction:column;gap:12px;margin-top:12px;"});o.forEach((i,r)=>{const a=t("div",{style:"padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"}),f=i&&(i.situation||i.prompt||i.q)||`Ситуація ${r+1}`;a.appendChild(t("div",{style:"margin:0 0 6px;font-weight:600;color:#0f172a;"},f));const s=i&&Array.isArray(i.example_answers)?i.example_answers.filter(Boolean):[];if(s.length){a.appendChild(t("div",{class:"muted",style:"margin:0 0 6px;color:#64748b;"},"Приклад відповіді:"));const d=t("div",{style:"display:flex;flex-wrap:wrap;gap:8px;"});s.forEach(c=>{d.appendChild(t("span",{style:"display:inline-flex;align-items:center;padding:4px 10px;border-radius:9999px;background:#e2e8f0;color:#0f172a;font-size:14px;"},c))}),a.appendChild(d)}p.appendChild(a)}),n.appendChild(p)}const l=e&&e.scoring&&Array.isArray(e.scoring.criteria)?e.scoring.criteria.filter(Boolean):[];if(l.length){const p=t("div",{style:"margin-top:16px;padding:14px;border:1px dashed #cbd5e1;border-radius:10px;background:#f8fafc;"});p.appendChild(t("h4",{style:"margin:0 0 8px;font-size:16px;font-weight:600;color:#0f172a;"},"Критерії оцінювання"));const i=t("ul",{style:"margin:0;padding-left:18px;color:#475569;"});l.forEach(r=>{i.appendChild(t("li",{style:"margin:4px 0;"},r))}),p.appendChild(i),n.appendChild(p)}}function fe(n,e){n.appendChild(t("h3",{},e.prompt||"Role-play scenario"));const o=e&&typeof e.scenario=="object"?e.scenario:{},l=t("div",{style:"margin:12px 0;padding:14px;border:1px solid #cbd5e1;border-radius:10px;background:#f8fafc;"});let p=!1;o.setting&&(l.appendChild(t("p",{style:"margin:0 0 6px;font-weight:600;"},`Локація: ${o.setting}`)),p=!0),o.summary&&(l.appendChild(t("p",{style:"margin:0;color:#334155;"},o.summary)),p=!0),p&&n.appendChild(l);const i=Array.isArray(o.roles)?o.roles:[];if(i.length){const f=t("div",{style:"display:grid;gap:12px;margin-top:12px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));"});i.forEach((s,d)=>{const c=s&&s.name||`Student ${d+1}`,h=t("div",{style:"padding:14px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;box-shadow:0 1px 0 rgba(148, 163, 184, 0.2);"},t("div",{style:"font-weight:600;margin-bottom:6px;"},c));s&&s.goal&&h.appendChild(t("p",{style:"margin:0 0 6px;color:#0f172a;"},`Мета: ${s.goal}`));const b=(s&&Array.isArray(s.details)?s.details:typeof(s==null?void 0:s.details)=="string"?s.details.split(/[;,\n]/):[]).map(u=>String(u||"").trim()).filter(Boolean);if(b.length===1)h.appendChild(t("p",{style:"margin:0;color:#475569;"},b[0]));else if(b.length>1){const u=t("ul",{style:"margin:0;padding-left:18px;color:#475569;"});b.forEach(y=>{u.appendChild(t("li",{style:"margin:2px 0;"},y))}),h.appendChild(u)}f.appendChild(h)}),n.appendChild(f)}const r=Array.isArray(o.steps)?o.steps:[];if(r.length){const f=t("div",{style:"margin-top:16px;padding:14px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"});f.appendChild(t("h4",{style:"margin:0 0 6px;font-size:16px;font-weight:600;color:#0f172a;"},"Покроковий план діалогу"));const s=t("ol",{style:"margin:0 0 0 18px;padding:0;color:#475569;"});r.forEach(d=>{d&&s.appendChild(t("li",{style:"margin:4px 0;"},d))}),f.appendChild(s),n.appendChild(f)}const a=Array.isArray(e&&e.phrases)?e.phrases:[];if(a.length){n.appendChild(t("h4",{style:"margin:18px 0 8px;font-size:16px;font-weight:600;color:#0f172a;"},"Корисні фрази для діалогу"));const f=t("div",{style:"display:flex;flex-direction:column;gap:8px;"});a.forEach(s=>{const d=typeof s=="string"?s:s&&(s.phrase||s.text||s.value||""),c=s&&typeof s=="object"&&(s.translation||s.note||s.ua||s.uk)||"";if(!d)return;const h=`phrase-${Math.random().toString(36).slice(2,8)}`;f.appendChild(t("label",{for:h,style:"display:flex;gap:10px;align-items:flex-start;padding:10px 12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"},t("input",{id:h,type:"checkbox",style:"margin-top:4px;"}),t("div",{},t("span",{style:"font-weight:600;color:#0f172a;"},d),c?t("span",{class:"muted",style:"display:block;margin-top:4px;color:#475569;"},c):null)))}),n.appendChild(f)}}function ue(n,e){n.appendChild(t("h3",{},e.prompt||"Заповніть пропуски у діалозі"));const o=Array.isArray(e==null?void 0:e.answers)?e.answers.map(x=>w(x)):[],l=[];let p=null;function i(x){p&&p!==x&&(p.style.boxShadow="none"),x&&p!==x?(x.style.boxShadow="0 0 0 2px rgba(37, 99, 235, 0.35)",p=x):(x&&(x.style.boxShadow="none"),p=null)}function r(x){x&&(x.dataset.value="",x.textContent="___",x.style.borderColor="#cbd5e1",x.style.background="#fff",x.style.boxShadow="none")}const a=t("div",{style:"display:flex;flex-wrap:wrap;gap:8px;margin:12px 0;padding:10px;border:1px solid #e2e8f0;border-radius:10px;background:#f8fafc;"}),f=Array.isArray(e==null?void 0:e.words)?e.words:[],s=new Set,d=[];f.forEach(x=>{const m=String(x||"").trim();if(!m)return;const E=w(m);s.has(E)||(s.add(E),d.push(m))}),d.forEach(x=>{const m=t("button",{type:"button",class:"btn",style:"padding:6px 10px;border:1px solid #94a3b8;border-radius:999px;background:#fff;color:#0f172a;cursor:pointer;font-size:14px;line-height:1;",onclick:()=>{const E=p||l.find(L=>!L.dataset.value);E&&(E.dataset.value=x,E.textContent=x,E.style.borderColor="#2563eb",E.style.background="#eef2ff",i(null))}},x);m.dataset.word=x,a.appendChild(m)}),a.children.length&&n.appendChild(a);const c=t("div",{style:"display:flex;flex-direction:column;gap:10px;"}),h=Array.isArray(e==null?void 0:e.dialogue)?e.dialogue:[];let g=0;h.forEach(x=>{if(!x)return;const m=x.speaker||x.role||"",E=x.line||x.text||"",L=t("div",{style:"padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;display:flex;gap:10px;align-items:flex-start;"},m?t("strong",{style:"min-width:90px;"},`${m}:`):null),_=t("div",{style:"display:flex;flex-wrap:wrap;gap:6px;align-items:center;"}),F=String(E||"").split(/___/);F.forEach((U,we)=>{if(U&&_.appendChild(t("span",{},U)),we<F.length-1){const ve=o[g]||"",$=t("button",{type:"button",style:"min-width:52px;padding:4px 10px;border:1px solid #cbd5e1;border-radius:8px;background:#fff;color:#0f172a;cursor:pointer;",onclick:()=>{if($.dataset.value){r($),i($);return}i(p===$?null:$)},ondblclick:()=>{r($),i(null)}},"___");$.dataset.expected=ve,$.dataset.index=String(g),l.push($),g+=1,_.appendChild($)}}),L.appendChild(_),c.appendChild(L)}),n.appendChild(c);const b=t("div",{style:"margin-top:14px;display:flex;gap:10px;flex-wrap:wrap;align-items:center;"}),u=t("button",{type:"button",class:"btn primary"},"Перевірити"),y=t("button",{type:"button",class:"btn"},"Скинути"),C=t("div",{style:"font-weight:600;color:#0f172a;"});u.addEventListener("click",()=>{let x=0;l.forEach(m=>{const E=m.dataset.expected||"",L=w(m.dataset.value||m.textContent||""),_=E?L===E:!!L;m.style.borderColor=_?"#10b981":"#ef4444",m.style.background=_?"#ecfdf5":"#fee2e2",_&&(x+=1)}),l.length?C.textContent=`Результат: ${x}/${l.length}`:C.textContent=""}),y.addEventListener("click",()=>{l.forEach(x=>r(x)),C.textContent="",i(null)}),b.appendChild(u),b.appendChild(y),b.appendChild(C),n.appendChild(b)}function he(n,e){n.appendChild(t("h3",{},e.prompt||"Упорядкуйте діалог"));const o=Array.isArray(e==null?void 0:e.lines)?e.lines.map(u=>({speaker:(u==null?void 0:u.speaker)||(u==null?void 0:u.role)||"",text:(u==null?void 0:u.line)||(u==null?void 0:u.text)||""})):[],l=Array.isArray(e==null?void 0:e.solution)?e.solution.map(u=>Number.parseInt(u,10)):o.map((u,y)=>y),p=t("div",{style:"display:flex;flex-direction:column;gap:8px;margin-top:10px;padding:10px;border:1px solid #e2e8f0;border-radius:10px;background:#f8fafc;"}),i=t("div",{style:"margin-top:14px;padding:12px;border:1px dashed #cbd5e1;border-radius:10px;min-height:80px;display:flex;flex-direction:column;gap:8px;"}),r=new Set;function a({speaker:u,text:y}){return(u?`${u}: ${y}`:y).trim()}function f(u){if(!u)return;const y=Number.parseInt(u.dataset.index||"-1",10),C=u.dataset.buttonId;if(C){const x=p.querySelector(`[data-id="${C}"]`);x&&(x.disabled=!1,x.style.opacity="1")}r.delete(y),u.remove()}function s(u,y,C){const x=t("div",{class:"dialogue-chip",style:"padding:10px;border:1px solid #94a3b8;border-radius:10px;background:#fff;display:flex;justify-content:space-between;align-items:center;gap:12px;cursor:pointer;",onclick:m=>{m.stopPropagation(),f(x)}},t("span",{},y),t("span",{style:"color:#94a3b8;font-size:12px;"},"×"));x.dataset.index=String(u),x.dataset.buttonId=C,i.appendChild(x)}M(o.map((u,y)=>y)).forEach(u=>{const y=o[u],C=a(y),x=`line-${u}-${Math.random().toString(36).slice(2,6)}`,m=t("button",{type:"button",class:"btn",style:"text-align:left;padding:10px;border:1px solid #cbd5e1;border-radius:10px;background:#fff;color:#0f172a;cursor:pointer;",onclick:()=>{r.has(u)||(r.add(u),m.disabled=!0,m.style.opacity="0.5",s(u,C,x))},"data-id":x},C);p.appendChild(m)}),n.appendChild(p),n.appendChild(i);const c=t("div",{style:"margin-top:14px;display:flex;gap:10px;flex-wrap:wrap;align-items:center;"}),h=t("button",{type:"button",class:"btn primary"},"Перевірити"),g=t("button",{type:"button",class:"btn"},"Скинути"),b=t("div",{style:"font-weight:600;color:#0f172a;"});h.addEventListener("click",()=>{const u=Array.from(i.children).map(x=>Number.parseInt(x.dataset.index||"-1",10)),y=l.slice(),C=u.length===y.length&&u.every((x,m)=>x===y[m]);i.style.borderColor=C?"#10b981":"#ef4444",b.textContent=C?"Діалог впорядковано правильно!":`Поточний порядок: ${u.length}/${y.length} реплік. Перевірте послідовність.`}),g.addEventListener("click",()=>{Array.from(i.children).forEach(y=>f(y)),p.querySelectorAll("button").forEach(y=>{y.disabled=!1,y.style.opacity="1"}),r.clear(),i.style.borderColor="#cbd5e1",b.textContent=""}),c.appendChild(h),c.appendChild(g),c.appendChild(b),n.appendChild(c)}function xe(n,e){n.appendChild(t("h3",{},e.prompt||"Обери True або False"));const o=[];if((Array.isArray(e==null?void 0:e.items)?e.items:[]).forEach((a,f)=>{if(!a||!a.statement)return;const s=t("div",{style:"margin:8px 0;padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"},t("p",{style:"margin:0 0 8px;font-weight:600;"},a.statement)),d=`${e.id||"tf"}-${f}`,c=!!a.answer,h=t("label",{style:"display:inline-flex;align-items:center;gap:6px;margin-right:16px;"},t("input",{type:"radio",name:d,value:"true"}),"True"),g=t("label",{style:"display:inline-flex;align-items:center;gap:6px;"},t("input",{type:"radio",name:d,value:"false"}),"False"),b=t("div",{style:"display:flex;align-items:center;"});b.appendChild(h),b.appendChild(g),s.appendChild(b),o.push({row:s,name:d,expected:c}),n.appendChild(s)}),!o.length)return;const p=t("div",{style:"margin-top:14px;display:flex;gap:10px;align-items:center;flex-wrap:wrap;"}),i=t("button",{type:"button",class:"btn primary"},"Перевірити"),r=t("div",{style:"font-weight:600;color:#0f172a;"});i.addEventListener("click",()=>{let a=0;o.forEach(({row:f,name:s,expected:d})=>{const c=f.querySelector(`input[name="${s}"]:checked`),h=c?c.value===String(d):!1;f.style.borderColor=h?"#10b981":"#ef4444",h&&(a+=1)}),r.textContent=`Результат: ${a}/${o.length}`}),p.appendChild(i),p.appendChild(r),n.appendChild(p)}function ge(n,e){n.appendChild(t("h3",{},e.prompt||"Доберіть слово за описом"));const o=Array.isArray(e==null?void 0:e.wordBank)?e.wordBank:[];if(o.length){const a=t("div",{style:"margin:8px 0 12px;padding:10px;border:1px solid #e2e8f0;border-radius:10px;background:#f8fafc;display:flex;flex-wrap:wrap;gap:8px;"});o.forEach(f=>{const s=String(f||"").trim();s&&a.appendChild(t("span",{style:"padding:6px 10px;border:1px solid #94a3b8;border-radius:999px;background:#fff;font-size:14px;"},s))}),n.appendChild(a)}const l=[];if((Array.isArray(e==null?void 0:e.items)?e.items:[]).forEach(a=>{if(!a||!a.clue)return;const f=t("div",{style:"margin-bottom:10px;padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"});f.appendChild(t("p",{style:"margin:0 0 6px;font-weight:600;"},a.clue));const s=t("input",{type:"text",style:"width:100%;max-width:320px;padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});f.appendChild(s);const d=Array.isArray(a==null?void 0:a.answers)?a.answers.map(c=>w(c)):Array.isArray(a==null?void 0:a.answer)?a.answer.map(c=>w(c)):a!=null&&a.answer?[w(a.answer)]:[];l.push({row:f,input:s,answers:d}),n.appendChild(f)}),!l.length)return;const i=t("div",{style:"font-weight:600;color:#0f172a;"}),r=t("button",{type:"button",class:"btn primary"},"Перевірити");r.addEventListener("click",()=>{let a=0;l.forEach(({row:f,input:s,answers:d})=>{const c=w(s.value),h=d.length?d.includes(c):!!c;f.style.borderColor=h?"#10b981":"#ef4444",h&&(a+=1)}),i.textContent=`Результат: ${a}/${l.length}`}),n.appendChild(r),n.appendChild(i)}function ye(n,e){n.appendChild(t("h3",{},e.prompt||"Розшифруйте слова"));const o=[];if((Array.isArray(e==null?void 0:e.items)?e.items:[]).forEach(r=>{if(!r||!r.scrambled)return;const a=t("div",{style:"margin-bottom:10px;padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"});a.appendChild(t("div",{style:"margin-bottom:6px;font-weight:600;"},r.scrambled));const f=t("input",{type:"text",style:"width:100%;max-width:260px;padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});a.appendChild(f);const s=Array.isArray(r==null?void 0:r.answers)?r.answers.map(d=>w(d)):Array.isArray(r==null?void 0:r.answer)?r.answer.map(d=>w(d)):r!=null&&r.answer?[w(r.answer)]:[];o.push({row:a,input:f,answers:s}),n.appendChild(a)}),!o.length)return;const p=t("button",{type:"button",class:"btn primary"},"Перевірити"),i=t("div",{style:"margin-top:6px;font-weight:600;color:#0f172a;"});p.addEventListener("click",()=>{let r=0;o.forEach(({row:a,input:f,answers:s})=>{const d=w(f.value),c=s.length?s.includes(d):!!d;a.style.borderColor=c?"#10b981":"#ef4444",c&&(r+=1)}),i.textContent=`Результат: ${r}/${o.length}`}),n.appendChild(p),n.appendChild(i)}function be(n,e){n.appendChild(t("h3",{},e.prompt||"Знайди зайве слово"));const o=[];if((Array.isArray(e==null?void 0:e.items)?e.items:[]).forEach((r,a)=>{const f=Array.isArray(r==null?void 0:r.options)?r.options:[];if(!f.length)return;const s=t("div",{style:"margin-bottom:10px;padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"});s.appendChild(t("div",{style:"margin-bottom:6px;font-weight:600;"},`Набір ${a+1}`));const d=`${e.id||"odd"}-${a}`;f.forEach((g,b)=>{const u=`${d}-${b}`;s.appendChild(t("label",{for:u,style:"display:flex;align-items:center;gap:6px;margin:4px 0;"},t("input",{type:"radio",name:d,value:String(b),id:u}),g))});const c=String((r==null?void 0:r.explanation)||"").trim();if(c){const g=t("div",{class:"muted",style:"display:none;margin-top:6px;color:#475569;"});g.textContent=`Пояснення: ${c}`,s.appendChild(g)}const h=w((r==null?void 0:r.answer)||"");o.push({row:s,groupName:d,answerIndex:h}),n.appendChild(s)}),!o.length)return;const p=t("button",{type:"button",class:"btn primary"},"Перевірити"),i=t("div",{style:"margin-top:6px;font-weight:600;color:#0f172a;"});p.addEventListener("click",()=>{let r=0;o.forEach(({row:a,groupName:f,answerIndex:s})=>{const d=a.querySelector(`input[name="${f}"]:checked`),c=w(d?d.value:""),h=s?c===s:!!c;a.style.borderColor=h?"#10b981":"#ef4444";const g=a.querySelector(".muted");g&&(g.style.display=h?"none":"block"),h&&(r+=1)}),i.textContent=`Результат: ${r}/${o.length}`}),n.appendChild(p),n.appendChild(i)}function me(n,e){n.appendChild(t("h3",{},e.prompt||"Writing/Speaking prompt")),e.description&&n.appendChild(t("p",{class:"muted"},e.description));const o=t("div",{style:"margin-top:8px;"});(e.checklist||[]).forEach(i=>{const r=Math.random().toString(36).slice(2),a=t("label",{for:r,style:"display:flex;align-items:center;gap:8px;margin:6px 0;"},t("input",{id:r,type:"checkbox"}),t("span",{},i));o.appendChild(a)}),n.appendChild(o);const l=t("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"Позначити як перевірено"),p=t("div",{class:"muted",style:"margin-top:6px;"});l.addEventListener("click",()=>{p.textContent="Готово! Перевір список і за бажанням відправ наставнику."}),n.appendChild(l),n.appendChild(p)}function D(){let n=document.getElementById("practice");if(!n&&/\/grammar\//.test(location.pathname)){const e=t("div",{class:"container"});e.appendChild(t("hr",{class:"sep"})),n=t("section",{id:"practice"}),e.appendChild(n),document.body.appendChild(e)}return n}function Ce(){const n=D();if(!n)return;let e=n.querySelector("#practice-body");if(e||(e=t("div",{id:"practice-body"}),n.appendChild(e)),(window.lessonContext||{}).isCustomLesson){const l=n.querySelector("[data-practice-placeholder]");l&&(l.textContent="Практика для кожної теми розміщена одразу після теорії. Тут можете згенерувати додаткові завдання."),e&&(e.innerHTML='<p class="muted">Згенеруйте додаткові вправи або додайте власні завдання.</p>'),document.dispatchEvent(new CustomEvent("practice:dataLoaded",{detail:null})),document.dispatchEvent(new CustomEvent("practice:rendered",{detail:{ok:!1,reason:"custom-lesson"}}));return}ae().then(l=>{if(!l){document.dispatchEvent(new CustomEvent("practice:dataLoaded",{detail:null})),e.innerHTML='<p class="muted">Практика поки відсутня.</p>',document.dispatchEvent(new CustomEvent("practice:rendered",{detail:{ok:!1}}));return}e.innerHTML="";const p=t("div",{},t("h2",{},"Practice ",t("span",{class:"badge"},l.level||"B1")),l.title?t("p",{class:"muted"},l.title):null);e.appendChild(p);const i=(l.tasks||[]).map((r,a)=>({key:r&&r.id?String(r.id):`base-${a}`,task:r}));document.dispatchEvent(new CustomEvent("practice:dataLoaded",{detail:{title:l.title,level:l.level,entries:i}})),i.forEach(({task:r,key:a})=>P(e,r,a)),document.dispatchEvent(new CustomEvent("practice:rendered",{detail:{ok:!0}}))})}return document.addEventListener("DOMContentLoaded",Ce),window.practice=window.practice||{},Object.assign(window.practice,{appendTask:R,renderTaskList:W,createTaskElement:H}),{appendTask:R,renderTaskList:W,createTaskElement:H}}(),Be=Se.createTaskElement;document.addEventListener("click",A=>{const S=A.target.closest(".text-block");if(S){const B=S.innerHTML;navigator.clipboard.writeText(`<div class="text-block">${B}</div>`),console.log("Скопійовано")}});export{Le as a,Be as c,_e as g};
//# sourceMappingURL=practice-Bk48QDva.js.map
