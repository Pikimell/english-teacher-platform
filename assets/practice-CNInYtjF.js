import{i as Z,a as fe}from"./auth-CUcfS-ao.js";const _e=async(d=1,h=1e3)=>(await Z.get("/user")).data,re={},nt=async d=>{const h=JSON.stringify(d),w=re[h];if(w)return w;const e=await Z.post("/homework/list",d);return re[h]=e.data,e.data},Pe=async d=>(await Z.post("/homework",d)).data;function je(d,h){const e=d.items.find(I=>I._id===h.taskId).answers,E=e.findIndex(I=>I.name==h.name);E>=0?e[E]=h:e.push(h);const v={taskId:h.taskId,answers:e};return ae(v)}function qe(d,h){if(h.type==="radio")return je(d,h);const e=d.items.find(I=>I._id===h.taskId).answers,E=e.findIndex(I=>I.inputId==h.inputId),v={taskId:h.taskId,answers:e};return E>=0?e[E]=h:e.push(h),ae(v)}const rt=async d=>{const h=Object.keys(re);let w=re[h[0]];if(w)qe(w,d);else{const e={taskId:d.taskId,answers:[d]};return ae(e)}},ae=async({taskId:d,...h})=>(await Z.patch(`/homework/${d}`,h)).data,ot=async d=>{const h={page:1,limit:100,userEmail:d},w=await Z.post("/homework/lessons",h),{data:e}=w;return e.items=e.items.reverse(),e.items},j={users:null,request:null,active:null};function Me(){return j.users?Promise.resolve(j.users):(j.request||(j.request=_e().then(d=>{const h=Array.isArray(d==null?void 0:d.items)?d.items:[];return j.users=h,h}).catch(d=>{throw console.error("ÐÐµ Ð²Ð´Ð°Ð»Ð¾ÑÑ Ð·Ð°Ð²Ð°Ð½Ñ‚Ð°Ð¶Ð¸Ñ‚Ð¸ ÑÐ¿Ð¸ÑÐ¾Ðº ÑÑ‚ÑƒÐ´ÐµÐ½Ñ‚Ñ–Ð²",d),d}).finally(()=>{j.request=null})),j.request)}function Re(d){if(!d||typeof d!="object")return"ÐÐµÐ²Ñ–Ð´Ð¾Ð¼Ð¸Ð¹ ÑÑ‚ÑƒÐ´ÐµÐ½Ñ‚";const h=d.firstName||d.firstname||d.nameFirst||"",w=d.lastName||d.lastname||d.nameLast||"";return[h,w].map(v=>String(v||"").trim()).filter(Boolean).join(" ")||d.displayName||d.fullName||d.username||d.email||(d.id?`ID ${d.id}`:"")||"Ð‘ÐµÐ· Ñ–Ð¼ÐµÐ½Ñ–"}function U(){if(!j.active)return;const{panel:d,button:h}=j.active;d.style.display="none",d.dataset.open="false",h.setAttribute("aria-expanded","false"),j.active=null}const oe=new Set;let ne=!1;function ue(d){const{button:h,panel:w}=d;if(!(!h||!w)){if(!h.isConnected&&!w.isConnected){oe.delete(d);return}if(ne){h.hidden=!1;return}h.hidden=!0,w.style.display="none",w.dataset.open="false"}}function ze(d,h){const w={button:d,panel:h};return oe.add(w),ue(w),()=>{oe.delete(w)}}function De(d){const h=!!d;ne!==h&&(ne=h,ne||U(),oe.forEach(w=>ue(w)))}function We(d){if(!j.active)return;const{panel:h,button:w}=j.active,e=d.target;h.contains(e)||w.contains(e)||U()}function He(d){d.key==="Escape"&&U()}document.addEventListener("click",We);document.addEventListener("keydown",He);function V(d,h={},...w){const e=document.createElement(d);for(const[E,v]of Object.entries(h||{}))E==="class"?e.className=v:E==="html"?e.innerHTML=v:E.startsWith("on")&&typeof v=="function"?e.addEventListener(E.slice(2),v):e.setAttribute(E,v);for(const E of w)E!=null&&e.appendChild(typeof E=="string"?document.createTextNode(E):E);return e}const Y={triggerLabel:"ÐÐ°Ð´Ñ–ÑÐ»Ð°Ñ‚Ð¸",triggerClassName:"practice-share-trigger for-admin js-share-homework-btn",triggerStyle:"border:none;background:#2563eb;color:#fff;padding:4px 10px;border-radius:999px;font-size:12px;line-height:1;cursor:pointer;box-shadow:0 4px 12px rgba(37,99,235,0.24);",panelClassName:"practice-share-panel",panelStyle:"position:absolute;top:38px;right:0;min-width:240px;max-width:280px;border:1px solid #e2e8f0;border-radius:12px;background:#fff;box-shadow:0 18px 40px rgba(15,23,42,0.18);padding:8px;z-index:30;display:none;",emptyMessage:"Ð¡Ð¿Ð¸ÑÐ¾Ðº ÑÑ‚ÑƒÐ´ÐµÐ½Ñ‚Ñ–Ð² Ð¿Ð¾Ñ€Ð¾Ð¶Ð½Ñ–Ð¹",loadingMessage:"Ð—Ð°Ð²Ð°Ð½Ñ‚Ð°Ð¶ÐµÐ½Ð½Ñâ€¦",errorMessage:"ÐÐµ Ð²Ð´Ð°Ð»Ð¾ÑÑ Ð·Ð°Ð²Ð°Ð½Ñ‚Ð°Ð¶Ð¸Ñ‚Ð¸ ÑÑ‚ÑƒÐ´ÐµÐ½Ñ‚Ñ–Ð². Ð¡Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ñ‰Ðµ Ñ€Ð°Ð·.",formatStudentName:Re,fetchStudents:Me,getContext:null,onShare:()=>{},renderDetails:d=>d!=null&&d.email?V("span",{class:"muted",style:"font-size:12px;color:#475569;"},d.email):null};function Fe(d={}){const h={...Y,...d};return h.fetchStudents=typeof d.fetchStudents=="function"?d.fetchStudents:Y.fetchStudents,h.formatStudentName=typeof d.formatStudentName=="function"?d.formatStudentName:Y.formatStudentName,h.renderDetails=typeof d.renderDetails=="function"?d.renderDetails:Y.renderDetails,h.onShare=typeof d.onShare=="function"?d.onShare:Y.onShare,h.getContext=typeof d.getContext=="function"?d.getContext:()=>d.context,h}function Ve(d,h,w){if(d.innerHTML="",!h.length){d.appendChild(V("div",{class:"muted",style:"font-size:13px;text-align:center;padding:12px 8px;"},w.emptyMessage));return}const e=V("ul",{style:"list-style:none;margin:0;padding:0;max-height:220px;overflow:auto;"}),E=typeof w.getContext=="function"?w.getContext:Y.getContext;h.forEach(v=>{const I=V("button",{type:"button",style:"width:100%;background:transparent;border:none;text-align:left;padding:8px 10px;border-radius:8px;cursor:pointer;display:flex;flex-direction:column;gap:2px;",onmouseenter:()=>{I.style.backgroundColor="#f1f5f9"},onmouseleave:()=>{I.style.backgroundColor="transparent"},onclick:()=>{const q=typeof E=="function"?E(v):void 0;try{const O=w.onShare({student:v,context:q});if(O&&typeof O.then=="function"){I.disabled=!0,Promise.resolve(O).then(z=>{z!==!1&&U()}).catch(z=>{console.error("ÐŸÐ¾Ð¼Ð¸Ð»ÐºÐ° Ð¿Ñ–Ð´ Ñ‡Ð°Ñ Ð½Ð°Ð´ÑÐ¸Ð»Ð°Ð½Ð½Ñ Ð·Ð°Ð²Ð´Ð°Ð½Ð½Ñ",z),U()}).finally(()=>{I.disabled=!1});return}O!==!1&&U()}catch(O){console.error("ÐŸÐ¾Ð¼Ð¸Ð»ÐºÐ° Ð¿Ñ–Ð´ Ñ‡Ð°Ñ Ð½Ð°Ð´ÑÐ¸Ð»Ð°Ð½Ð½Ñ Ð·Ð°Ð²Ð´Ð°Ð½Ð½Ñ",O),U()}}},V("span",{style:"font-size:14px;font-weight:600;color:#0f172a;"},w.formatStudentName(v)),w.renderDetails?w.renderDetails(v):null),k=V("li",{style:"margin:0;padding:0;"},I);e.appendChild(k)}),d.appendChild(e)}function Ue(d){return V("div",{class:d.panelClassName,role:"dialog","aria-label":"ÐÐ°Ð´ÑÐ¸Ð»Ð°Ð½Ð½Ñ Ð·Ð°Ð²Ð´Ð°Ð½Ð½Ñ ÑÑ‚ÑƒÐ´ÐµÐ½Ñ‚Ñƒ",style:d.panelStyle,"data-open":"false"})}function Ge(d,h,w){if(h.dataset.open==="true"){U();return}j.active&&j.active.panel!==h&&U(),h.dataset.open="true",h.style.display="block",d.setAttribute("aria-expanded","true"),h.innerHTML="",h.appendChild(V("div",{class:"muted",style:"font-size:13px;padding:12px 8px;text-align:center;"},w.loadingMessage)),j.active={panel:h,button:d},Promise.resolve(w.fetchStudents()).then(E=>{Ve(h,Array.isArray(E)?E:[],w)}).catch(()=>{h.innerHTML="",h.appendChild(V("div",{style:"color:#ef4444;font-size:13px;text-align:center;padding:12px 8px;"},w.errorMessage))})}function Je(d,h){const w=V("button",{type:"button",class:h.triggerClassName,title:"ÐÐ°Ð´Ñ–ÑÐ»Ð°Ñ‚Ð¸ ÑÑ‚ÑƒÐ´ÐµÐ½Ñ‚Ñƒ","aria-haspopup":"dialog","aria-expanded":"false",style:h.triggerStyle,onclick:e=>{e.preventDefault(),Ge(w,d,h)}},h.triggerLabel);return w}function Qe(d={}){const h=Fe(d),w=Ue(h),e=Je(w,h),E=ze(e,w);return{button:e,panel:w,unregister:E}}function Ke(d){return!!(j.active&&j.active.panel===d)}function Xe(){return new Promise(d=>{const h=speechSynthesis.getVoices();if(h.length)return d(h);speechSynthesis.onvoiceschanged=()=>d(speechSynthesis.getVoices())})}function F(d){return String(d||"").trim().toLowerCase()}function Ye(d,h={}){if(!Array.isArray(d)||!d.length)return null;const{lang:w="en",voiceName:e,voice:E,voiceGender:v,gender:I}=h,k=F(w)||"en",q=e||(E&&/\s/.test(String(E))?String(E):null),z=F(I||v||!q&&E||null);let R=q&&d.find(B=>B.name===q)||q&&d.find(B=>F(B.name)===F(q))||null;const ee=B=>{if(!z)return!1;const H=F(B.name),X=F(B.voiceURI);return z==="male"?H.includes("male")||X.includes("male")||/\bmale\b|\bman\b|\bboy\b|m\d/.test(H):z==="female"?H.includes("female")||X.includes("female")||H.includes("woman")||H.includes("girl"):H.includes(z)||X.includes(z)},G=d.filter(B=>F(B.lang).startsWith(k));if(!R&&z&&(R=G.find(ee)||d.find(ee)||null),!R&&q&&F(q)){const B=F(q);R=G.find(H=>F(H.name).includes(B))||d.find(H=>F(H.name).includes(B))||null}return R||(R=G.find(B=>F(B.name).includes("female"))||G[0]||d.find(B=>F(B.name).includes("female"))||d[0]||null),R||null}async function he(d,{lang:h="en",voiceName:w,voice:e,voiceGender:E,gender:v,rate:I=1,pitch:k=1,volume:q=1}={}){await Xe();const O=new SpeechSynthesisUtterance(d),z=speechSynthesis.getVoices(),R=Ye(z,{lang:h,voiceName:w,voice:e,voiceGender:E,gender:v});return R?(O.voice=R,O.lang=R.lang||h||"en"):O.lang=h||"en",O.rate=I,O.pitch=k,O.volume=q,speechSynthesis.cancel(),speechSynthesis.speak(O),O}function it(d){const h=document.createElement("span");return h.textContent="ðŸ”Š",h.addEventListener("click",()=>{he(d)}),h.classList.add("play-speak-btn"),h}const Ze={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},ge=function(){const d=typeof import.meta<"u"&&Ze&&"/"||"/";function h(r){const t=d.endsWith("/")?d:`${d}/`,l=String(r||"");return/^[a-z]+:/i.test(l)||l.startsWith(t)?l:`${t}${l.replace(/^\/+/,"")}`}function w(){try{const t=new URL(window.location.href).pathname.split("/");let l=t.pop();(!l||!/\.html?$/i.test(l))&&(l="index.html");const u=l.replace(/\.html?$/i,".json");return t.push("practice",u),t.join("/")}catch{return null}}function e(r,t={},...l){const u=document.createElement(r);for(const[f,i]of Object.entries(t||{}))f==="class"?u.className=i:f==="html"?u.innerHTML=i:f.startsWith("on")&&typeof i=="function"?u.addEventListener(f.slice(2),i):u.setAttribute(f,i);for(const f of l)f!=null&&u.appendChild(typeof f=="string"?document.createTextNode(f):f);return u}function E(r){const t=r.slice();for(let l=t.length-1;l>0;l--){const u=Math.floor(Math.random()*(l+1));[t[l],t[u]]=[t[u],t[l]]}return t}function v(r){return String(r||"").trim().toLowerCase().replace(/\s+/g," ")}let I=0;function k(r="practice-input"){return I+=1,`${String(r||"practice-input").trim().replace(/[^a-z0-9_-]+/gi,"-").replace(/^-+|-+$/g,"")||"practice-input"}-${I}`}fe.subscribe(({user:r})=>{De(fe.isAdmin(r))});function q(r){const t=e("div",{class:"hint-wrap",style:"margin-top:6px;"}),l=e("button",{type:"button",class:"hint-toggle","aria-label":"ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚Ð¸ Ð¿Ñ–Ð´ÐºÐ°Ð·ÐºÑƒ",title:"ÐŸÑ–Ð´ÐºÐ°Ð·ÐºÐ°",style:"border:none;background:transparent;color:#94a3b8;cursor:pointer;padding:0;font-size:14px;line-height:1;"},"?"),u=e("div",{class:"hint-box muted",style:"display:none;margin-top:6px;color:#475569;"},`ÐŸÑ–Ð´ÐºÐ°Ð·ÐºÐ°: ${r}`);return l.addEventListener("click",()=>{const f=u.style.display==="none";u.style.display=f?"block":"none",l.setAttribute("aria-expanded",f?"true":"false")}),t.appendChild(l),t.appendChild(u),t}function O(r,t){T(r,t,"Choose the correct option");const l=[];(t.items||[]).forEach((i,n)=>{const o=`${t.id||"mcq"}-${n}`,g=Array.isArray(i.answer)&&i.answer.length>1,a=e("div",{class:"mcq-item",style:"margin-bottom:10px;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"},e("div",{class:"q",style:"margin-bottom:8px;font-weight:600;"},i.q));(i.choices||[]).forEach((p,c)=>{const s=k(`${o}-${c}`),b=e("label",{for:s,style:"display:flex;align-items:center;gap:8px;margin:4px 0;"},e("input",{type:g?"checkbox":"radio",name:o,id:s,value:String(c)}),e("span",{},p));a.appendChild(b)}),i.explanation&&a.appendChild(e("div",{class:"exp muted",style:"display:none;margin-top:6px;color:#475569;"},i.explanation)),l.push({block:a,item:i,name:o}),r.appendChild(a)});const u=e("div",{class:"result",style:"margin-top:8px;font-weight:600;"}),f=e("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€Ð¸Ñ‚Ð¸");f.addEventListener("click",()=>{let i=0;l.forEach(({block:n,item:o,name:g})=>{const a=Array.isArray(o.answer)?o.answer.map(String):[String(o.answer)],c=Array.from(n.querySelectorAll(`input[name='${g}']`)).filter(x=>x.checked).map(x=>x.value).sort(),s=a.slice().sort(),b=c.length===s.length&&c.every((x,C)=>x===s[C]);n.style.borderColor=b?"#10b981":"#ef4444";const y=n.querySelector(".exp");y&&(y.style.display=b?"none":"block"),b&&i++}),u.textContent=`Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: ${i}/${l.length}`}),r.appendChild(f),r.appendChild(u)}function z(r,t){T(r,t,"Fill the gaps");const l=[];(t.items||[]).forEach((i,n)=>{const o=e("div",{style:"margin-bottom:10px;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"}),g=String(i.q||"").split(/___/),a=k(`${t.id||"gap"}-${n}`),p=e("input",{type:"text",id:a,style:"padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});g.length>1?(o.appendChild(e("span",{},g[0])),o.appendChild(p),o.appendChild(e("span",{},g.slice(1).join("___")))):(o.appendChild(e("div",{style:"margin-bottom:6px;font-weight:600;"},i.q)),o.appendChild(p)),i.hint&&o.appendChild(q(i.hint)),l.push({row:o,input:p,answers:(i.answer||[]).map(c=>v(c))}),r.appendChild(o)});const u=e("div",{style:"margin-top:8px;font-weight:600;"}),f=e("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€Ð¸Ñ‚Ð¸");f.addEventListener("click",()=>{let i=0;l.forEach(({row:n,input:o,answers:g})=>{const a=v(o.value),p=g.includes(a);n.style.borderColor=p?"#10b981":"#ef4444",p&&i++}),u.textContent=`Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: ${i}/${l.length}`}),r.appendChild(f),r.appendChild(u)}function R(r,t){T(r,t,"Match pairs");const l=t.pairs||[],u=E(l.map(o=>o.right)),f=[];l.forEach((o,g)=>{const a=k(`${t.id||"match"}-${g}`),p=e("select",{id:a,style:"padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"},e("option",{value:""},"â€” Ð¾Ð±ÐµÑ€Ð¸ â€”"),...u.map(s=>e("option",{value:s},s))),c=e("div",{style:"display:flex;align-items:center;gap:10px;margin:8px 0;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"},e("label",{for:a,style:"min-width:160px;font-weight:600;"},o.left),p);f.push({row:c,select:p,right:o.right}),r.appendChild(c)});const i=e("div",{style:"margin-top:8px;font-weight:600;"}),n=e("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€Ð¸Ñ‚Ð¸");n.addEventListener("click",()=>{let o=0;f.forEach(({row:g,select:a,right:p})=>{const c=a.value===p;g.style.borderColor=c?"#10b981":"#ef4444",c&&o++}),i.textContent=`Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: ${o}/${f.length}`}),r.appendChild(n),r.appendChild(i)}function ee(r,t){T(r,t,"ÐŸÑ€Ð¾Ñ‡Ð¸Ñ‚Ð°Ð¹Ñ‚Ðµ Ñ‚ÐµÐºÑÑ‚ Ñ‚Ð° Ð´Ð°Ð¹Ñ‚Ðµ Ð²Ñ–Ð´Ð¿Ð¾Ð²Ñ–Ð´Ñ–");const l=t.context||{},u=String(l.format||"narrative").toLowerCase(),f=Array.isArray(l.body)?l.body:[],i=e("div",{style:"margin:12px 0;padding:14px;border:1px solid #cbd5e1;border-radius:10px;background:#f8fafc;"});l.title&&i.appendChild(e("h4",{style:"margin:0 0 8px;font-size:18px;"},l.title)),u==="dialog"?f.forEach(p=>{if(!p)return;const c=typeof p=="object"&&p.speaker?`${p.speaker}:`:"",s=typeof p=="object"&&"line"in p?p.line:typeof p=="string"?p:"";i.appendChild(e("p",{style:"margin:4px 0;display:flex;gap:6px;align-items:flex-start;line-height:1.5;"},c?e("strong",{},c):null,e("span",{},s)))}):f.forEach((p,c)=>{const s=typeof p=="string"?p:p&&p.text?p.text:"";s&&i.appendChild(e("p",{style:c?"margin:8px 0 0;":"margin:0;"},s))}),r.appendChild(i);const n=Array.isArray(t.questions)?t.questions:[];if(!n.length)return;const o=[];n.forEach((p,c)=>{const s=e("div",{style:"margin-bottom:8px;font-weight:600;"},p.q||`ÐŸÐ¸Ñ‚Ð°Ð½Ð½Ñ ${c+1}`),b=e("div",{style:"margin-bottom:12px;padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"},s),y=Array.isArray(p.answer)?p.answer.map(String):p.answer!=null?[String(p.answer)]:[];if(Array.isArray(p.choices)&&p.choices.length){const x=`${t.id||"context"}-${c}`,C=y.length>1,S=y.every(m=>/^\d+$/.test(m));p.choices.forEach((m,A)=>{const $=k(`${x}-${A}`);b.appendChild(e("label",{for:$,style:"display:flex;align-items:center;gap:8px;margin:4px 0;"},e("input",{type:C?"checkbox":"radio",name:x,id:$,value:String(A)}),e("span",{},m)))}),o.push({block:b,type:"choices",allowMulti:C,getPicked:()=>{const A=Array.from(b.querySelectorAll(`input[name='${x}']`)).filter($=>$.checked).map($=>$.value);return S?A:A.map($=>v(p.choices[Number($)]||""))},expected:S?y:y.map(m=>v(m))})}else{const x=k(`${t.id||"context-label"}-${c}`);s.setAttribute("id",x);const C=k(`${t.id||"context-text"}-${c}`),S=e("textarea",{id:C,rows:2,style:"width:100%;max-width:640px;padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});S.setAttribute("aria-labelledby",x),b.appendChild(S),o.push({block:b,type:"text",input:S,expected:y.map(m=>v(m))})}p.explanation&&b.appendChild(e("div",{class:"muted",style:"display:none;margin-top:6px;color:#475569;"},p.explanation)),r.appendChild(b)});const g=e("div",{style:"margin-top:8px;font-weight:600;"}),a=e("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€Ð¸Ñ‚Ð¸");a.addEventListener("click",()=>{let p=0;o.forEach(c=>{let s=!1;if(c.type==="choices"){const y=c.getPicked().sort(),x=c.expected.slice().sort();s=y.length===x.length&&y.every((C,S)=>C===x[S])}else{const y=v(c.input.value);s=c.expected.length?c.expected.includes(y):!!y}c.block.style.borderColor=s?"#10b981":"#ef4444";const b=c.block.querySelector(".muted");b&&(b.style.display=s?"none":"block"),s&&p++}),g.textContent=`Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: ${p}/${o.length}`}),r.appendChild(a),r.appendChild(g)}function G(r,t,l,u={}){const{showRemove:f=!0}=u,i=l||(t&&t.id?String(t.id):`task-${Math.random().toString(16).slice(2,8)}`),n=e("section",{style:"position:relative;margin:18px 0 26px;","data-task-id":t&&t.id?String(t.id):"","data-task-key":i}),o=e("div",{style:"position:absolute;top:6px;right:6px;display:flex;gap:6px;align-items:center;z-index:5;"}),{button:g,panel:a,unregister:p}=Qe({context:t,onShare:({student:b,context:y})=>{const x=window.location.search.slice(8),C=document.querySelector("h1"),S=C?C.textContent:"",m={lessonId:x,userEmail:b.email,lessonName:S,homeworkType:"task",homeworkData:JSON.stringify(y)};return Pe(m)}});if(o.appendChild(g),f){const b=e("button",{type:"button",title:"Ð’Ð¸Ð´Ð°Ð»Ð¸Ñ‚Ð¸ Ð·Ð°Ð²Ð´Ð°Ð½Ð½Ñ","aria-label":"Ð’Ð¸Ð´Ð°Ð»Ð¸Ñ‚Ð¸ Ð·Ð°Ð²Ð´Ð°Ð½Ð½Ñ",class:"for-admin",style:"border:none;background:transparent;color:#94a3b8;cursor:pointer;padding:2px;line-height:1;font-size:14px;opacity:0.6;",onmouseenter:()=>b.style.opacity="1",onmouseleave:()=>b.style.opacity="0.6",onclick:()=>{Ke(a)&&U(),document.dispatchEvent(new CustomEvent("practice:taskRemoved",{detail:{key:i,task:t}})),p(),n.remove()}},"âœ•");o.appendChild(b)}n.appendChild(o),n.appendChild(a),t.title&&n.appendChild(e("h3",{},t.title));const c=t&&t.type;switch(String(c||"").trim().toLowerCase()){case"mcq":O(n,t);break;case"gap":z(n,t);break;case"match":R(n,t);break;case"context":ee(n,t);break;case"transform":be(n,t);break;case"error":ye(n,t);break;case"order":me(n,t);break;case"short":Ce(n,t);break;case"roleplay":ve(n,t);break;case"dialogue-gap":Se(n,t);break;case"dialogue-order":Ae(n,t);break;case"truefalse":Ee(n,t);break;case"definition-match":{const b={...t,prompt:t.prompt||"ÐŸÐ¾Ñ”Ð´Ð½Ð°Ð¹ ÑÐ»Ð¾Ð²Ð¾ Ð· Ð²Ð¸Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½ÑÐ¼"};R(n,b);break}case"synonym-clue":$e(n,t);break;case"scramble":ke(n,t);break;case"wordpairs":{const b={...t,prompt:t.prompt||"ÐŸÐ¾Ñ”Ð´Ð½Ð°Ð¹ Ñ„Ð¾Ñ€Ð¼Ñƒ Ð² Ð¾Ð´Ð½Ð¸Ð½Ñ– Ñ‚Ð° Ð¼Ð½Ð¾Ð¶Ð¸Ð½Ñ–"};R(n,b);break}case"odd-one-out":Le(n,t);break;case"open":we(n,t);break;case"writing":Ie(n,t);break;case"audio":Ne(n,t);break;default:n.appendChild(e("div",{class:"muted"},`ÐÐµÐ²Ñ–Ð´Ð¾Ð¼Ð¸Ð¹ Ñ‚Ð¸Ð¿ Ð·Ð°Ð²Ð´Ð°Ð½Ð½Ñ: ${c}`))}return r.appendChild(n),n}function B(r,t={}){const l=de();if(!l||!r)return;const u=l.querySelector("#practice-body")||l,f=t.showRemove!==!1;G(u,r,t.key,{showRemove:f})}function H(r,t,l={}){if(!r)return null;const u=Array.isArray(t)?t.filter(Boolean):[],{title:f,level:i,description:n,keyPrefix:o="inline",showEmptyNote:g=!1,showRemove:a=!1}=l;if(!u.length){if(g){const c=e("p",{class:"muted practice-inline__empty"},"ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÐ° Ð´Ð»Ñ Ñ†Ñ–Ñ”Ñ— Ñ‚ÐµÐ¼Ð¸ Ð¿Ð¾ÐºÐ¸ Ð²Ñ–Ð´ÑÑƒÑ‚Ð½Ñ.");r.appendChild(c)}return null}const p=e("section",{class:"practice-inline"});if(f||i||n){const c=e("header",{class:"practice-inline__header"});f&&c.appendChild(e("h3",{class:"practice-inline__title"},f)),i&&c.appendChild(e("span",{class:"practice-inline__badge"},i)),n&&c.appendChild(e("p",{class:"practice-inline__description muted"},n)),p.appendChild(c)}return u.forEach((c,s)=>{const b=`${o}-${s}`;G(p,c,b,{showRemove:a})}),r.appendChild(p),document.dispatchEvent(new CustomEvent("practice:inlineRendered",{detail:{tasks:u,container:r,options:l}})),p}function X(r,t={}){if(!r)return null;const l=document.createDocumentFragment(),u=t.showRemove!==!1;return G(l,r,t.key,{showRemove:u})}async function le(r){if(!r)return null;const t=h(r);try{const l=await fetch(t,{cache:"no-store"});return l.ok?await l.json():null}catch{return null}}async function xe(){const r=document.getElementById("practice-data");if(r)try{return JSON.parse(r.textContent)}catch{return null}const t=window.lessonContext||{},l=new Set;if(t.id&&l.add(`data/practice/${t.id}.json`),t.htmlPath){const f=String(t.htmlPath).replace(/^\.\/?/,"").replace(/\.html?$/i,"");if(f){l.add(`data/practice/${f}.json`);const i=f.split("/"),n=i[i.length-1];n&&l.add(`data/practice/${n}.json`)}}for(const f of l){const i=await le(f);if(i)return i}const u=w();return u?await le(u):null}function be(r,t){T(r,t,"Transform the sentence");const l=[];(t.items||[]).forEach((i,n)=>{const o=e("div",{style:"margin-bottom:10px;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"});o.appendChild(e("div",{style:"margin-bottom:6px;font-weight:600;"},i.q));const g=k(`${t.id||"transform"}-${n}`),a=e("input",{type:"text",id:g,style:"width:100%;max-width:640px;padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});o.appendChild(a),i.hint&&o.appendChild(q(i.hint)),l.push({row:o,input:a,answers:(i.answer||[]).map(p=>v(p))}),r.appendChild(o)});const u=e("div",{style:"margin-top:8px;font-weight:600;"}),f=e("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€Ð¸Ñ‚Ð¸");f.addEventListener("click",()=>{let i=0;l.forEach(({row:n,input:o,answers:g})=>{const a=g.includes(v(o.value));n.style.borderColor=a?"#10b981":"#ef4444",a&&i++}),u.textContent=`Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: ${i}/${l.length}`}),r.appendChild(f),r.appendChild(u)}function ye(r,t){T(r,t,"Find and correct the error");const l=[];(t.items||[]).forEach((i,n)=>{const o=e("div",{style:"margin-bottom:10px;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"});o.appendChild(e("div",{style:"margin-bottom:6px;font-weight:600;"},i.q));const g=k(`${t.id||"error"}-${n}`),a=e("input",{type:"text",id:g,style:"width:100%;max-width:640px;padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});o.appendChild(a),i.hint&&o.appendChild(q(i.hint)),l.push({row:o,input:a,answers:(i.answer||[]).map(p=>v(p))}),r.appendChild(o)});const u=e("div",{style:"margin-top:8px;font-weight:600;"}),f=e("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€Ð¸Ñ‚Ð¸");f.addEventListener("click",()=>{let i=0;l.forEach(({row:n,input:o,answers:g})=>{const a=g.includes(v(o.value));n.style.borderColor=a?"#10b981":"#ef4444",a&&i++}),u.textContent=`Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: ${i}/${l.length}`}),r.appendChild(f),r.appendChild(u)}function me(r,t){T(r,t,"Put the words in order");const l=[];(t.items||[]).forEach((i,n)=>{const o=v(Array.isArray(i.answer)?i.answer.join(" "):i.answer),g=E((i.tokens||[]).slice()),a=e("div",{style:"margin:10px 0;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"}),p=e("div",{style:"display:flex;flex-wrap:wrap;gap:6px;margin-bottom:6px;"}),c=e("div",{style:"display:flex;flex-wrap:wrap;gap:6px;min-height:36px;padding:6px;border:1px dashed #cbd5e1;border-radius:8px;background:#f8fafc;"}),s=new Set;function b(C,S){const m=e("button",{type:"button",style:"padding:4px 8px;border:1px solid #cbd5e1;border-radius:6px;background:#fff;cursor:pointer;"},C);return m.addEventListener("click",()=>{s.has(S)||(s.add(S),m.style.opacity=.5,c.appendChild(e("span",{class:"chip",style:"padding:4px 8px;border:1px solid #cbd5e1;border-radius:6px;background:#fff;"},C)))}),m}g.forEach((C,S)=>p.appendChild(b(C,`${n}-${S}`)));const y=e("div",{style:"margin-top:6px;display:flex;gap:8px;"}),x=e("button",{type:"button",class:"btn"},"Ð¡ÐºÐ¸Ð½ÑƒÑ‚Ð¸");x.addEventListener("click",()=>{s.clear(),c.innerHTML="",Array.from(p.children).forEach(C=>C.style.opacity=1),a.style.borderColor="#e5e7eb"}),y.appendChild(x),a.appendChild(e("div",{style:"margin-bottom:6px;font-weight:600;"},i.q||"")),a.appendChild(p),a.appendChild(c),a.appendChild(y),l.push({row:a,outWrap:c,correctStr:o}),r.appendChild(a)});const u=e("div",{style:"margin-top:8px;font-weight:600;"}),f=e("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€Ð¸Ñ‚Ð¸");f.addEventListener("click",()=>{let i=0;l.forEach(({row:n,outWrap:o,correctStr:g})=>{const p=v(Array.from(o.querySelectorAll(".chip")).map(c=>c.textContent).join(" "))===g;n.style.borderColor=p?"#10b981":"#ef4444",p&&i++}),u.textContent=`Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: ${i}/${l.length}`}),r.appendChild(f),r.appendChild(u)}function Ce(r,t){T(r,t,"Short answer");const l=[];(t.items||[]).forEach((i,n)=>{const o=e("div",{style:"margin-bottom:10px;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"}),g=e("div",{style:"margin-bottom:6px;font-weight:600;"},i.q);o.appendChild(g);const a=k(`${t.id||"short-label"}-${n}`);g.setAttribute("id",a);const p=k(`${t.id||"short-text"}-${n}`),c=e("textarea",{id:p,rows:3,style:"width:100%;max-width:720px;padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});c.setAttribute("aria-labelledby",a),o.appendChild(c),l.push({row:o,input:c,keywords:(i.keywords||[]).map(s=>v(s))}),r.appendChild(o)});const u=e("div",{style:"margin-top:8px;font-weight:600;"}),f=e("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€Ð¸Ñ‚Ð¸");f.addEventListener("click",()=>{let i=0,n=0;l.forEach(({row:o,input:g,keywords:a})=>{const p=v(g.value),c=a.filter(b=>p.includes(b)).length;i+=c,n+=a.length,o.style.borderColor=c===a.length?"#10b981":c>0?"#f59e0b":"#ef4444";const s=o.querySelector(".short-info")||e("div",{class:"short-info",style:"margin-top:6px;color:#475569;"});s.textContent=`Ð—Ð±Ñ–Ð³Ð¸ ÐºÐ»ÑŽÑ‡Ð¾Ð²Ð¸Ñ… ÑÐ»Ñ–Ð²: ${c}/${a.length}`,o.contains(s)||o.appendChild(s)}),u.textContent=`Ð—Ð°Ð³Ð°Ð»ÑŒÐ½Ð¸Ð¹ Ð·Ð±Ñ–Ð³ ÐºÐ»ÑŽÑ‡Ð¾Ð²Ð¸Ñ… ÑÐ»Ñ–Ð²: ${i}/${n}`}),r.appendChild(f),r.appendChild(u)}function we(r,t){T(r,t,"Ð’Ñ–Ð´Ð¿Ð¾Ð²Ñ–Ð´Ñ– Ñƒ Ð²Ñ–Ð»ÑŒÐ½Ñ–Ð¹ Ñ„Ð¾Ñ€Ð¼Ñ–");const l=Array.isArray(t&&t.items)?t.items.filter(Boolean):[];if(l.length){const f=e("div",{style:"display:flex;flex-direction:column;gap:12px;margin-top:12px;"});l.forEach((i,n)=>{const o=e("div",{style:"padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"}),g=i&&(i.situation||i.prompt||i.q)||`Ð¡Ð¸Ñ‚ÑƒÐ°Ñ†Ñ–Ñ ${n+1}`;o.appendChild(e("div",{style:"margin:0 0 6px;font-weight:600;color:#0f172a;"},g));const a=i&&Array.isArray(i.example_answers)?i.example_answers.filter(Boolean):[];if(a.length){o.appendChild(e("div",{class:"muted",style:"margin:0 0 6px;color:#64748b;"},"ÐŸÑ€Ð¸ÐºÐ»Ð°Ð´ Ð²Ñ–Ð´Ð¿Ð¾Ð²Ñ–Ð´Ñ–:"));const p=e("div",{style:"display:flex;flex-wrap:wrap;gap:8px;"});a.forEach(c=>{p.appendChild(e("span",{style:"display:inline-flex;align-items:center;padding:4px 10px;border-radius:9999px;background:#e2e8f0;color:#0f172a;font-size:14px;"},c))}),o.appendChild(p)}f.appendChild(o)}),r.appendChild(f)}const u=t&&t.scoring&&Array.isArray(t.scoring.criteria)?t.scoring.criteria.filter(Boolean):[];if(u.length){const f=e("div",{style:"margin-top:16px;padding:14px;border:1px dashed #cbd5e1;border-radius:10px;background:#f8fafc;"});f.appendChild(e("h4",{style:"margin:0 0 8px;font-size:16px;font-weight:600;color:#0f172a;"},"ÐšÑ€Ð¸Ñ‚ÐµÑ€Ñ–Ñ— Ð¾Ñ†Ñ–Ð½ÑŽÐ²Ð°Ð½Ð½Ñ"));const i=e("ul",{style:"margin:0;padding-left:18px;color:#475569;"});u.forEach(n=>{i.appendChild(e("li",{style:"margin:4px 0;"},n))}),f.appendChild(i),r.appendChild(f)}}function ve(r,t){T(r,t,"Role-play scenario");const l=t&&typeof t.scenario=="object"?t.scenario:{},u=e("div",{style:"margin:12px 0;padding:14px;border:1px solid #cbd5e1;border-radius:10px;background:#f8fafc;"});let f=!1;l.setting&&(u.appendChild(e("p",{style:"margin:0 0 6px;font-weight:600;"},`Ð›Ð¾ÐºÐ°Ñ†Ñ–Ñ: ${l.setting}`)),f=!0),l.summary&&(u.appendChild(e("p",{style:"margin:0;color:#334155;"},l.summary)),f=!0),f&&r.appendChild(u);const i=Array.isArray(l.roles)?l.roles:[];if(i.length){const g=e("div",{style:"display:grid;gap:12px;margin-top:12px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));"});i.forEach((a,p)=>{const c=a&&a.name||`Student ${p+1}`,s=e("div",{style:"padding:14px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;box-shadow:0 1px 0 rgba(148, 163, 184, 0.2);"},e("div",{style:"font-weight:600;margin-bottom:6px;"},c));a&&a.goal&&s.appendChild(e("p",{style:"margin:0 0 6px;color:#0f172a;"},`ÐœÐµÑ‚Ð°: ${a.goal}`));const y=(a&&Array.isArray(a.details)?a.details:typeof(a==null?void 0:a.details)=="string"?a.details.split(/[;,\n]/):[]).map(x=>String(x||"").trim()).filter(Boolean);if(y.length===1)s.appendChild(e("p",{style:"margin:0;color:#475569;"},y[0]));else if(y.length>1){const x=e("ul",{style:"margin:0;padding-left:18px;color:#475569;"});y.forEach(C=>{x.appendChild(e("li",{style:"margin:2px 0;"},C))}),s.appendChild(x)}g.appendChild(s)}),r.appendChild(g)}const n=Array.isArray(l.steps)?l.steps:[];if(n.length){const g=e("div",{style:"margin-top:16px;padding:14px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"});g.appendChild(e("h4",{style:"margin:0 0 6px;font-size:16px;font-weight:600;color:#0f172a;"},"ÐŸÐ¾ÐºÑ€Ð¾ÐºÐ¾Ð²Ð¸Ð¹ Ð¿Ð»Ð°Ð½ Ð´Ñ–Ð°Ð»Ð¾Ð³Ñƒ"));const a=e("ol",{style:"margin:0 0 0 18px;padding:0;color:#475569;"});n.forEach(p=>{p&&a.appendChild(e("li",{style:"margin:4px 0;"},p))}),g.appendChild(a),r.appendChild(g)}const o=Array.isArray(t&&t.phrases)?t.phrases:[];if(o.length){r.appendChild(e("h4",{style:"margin:18px 0 8px;font-size:16px;font-weight:600;color:#0f172a;"},"ÐšÐ¾Ñ€Ð¸ÑÐ½Ñ– Ñ„Ñ€Ð°Ð·Ð¸ Ð´Ð»Ñ Ð´Ñ–Ð°Ð»Ð¾Ð³Ñƒ"));const g=e("div",{style:"display:flex;flex-direction:column;gap:8px;"});o.forEach((a,p)=>{const c=typeof a=="string"?a:a&&(a.phrase||a.text||a.value||""),s=a&&typeof a=="object"&&(a.translation||a.note||a.ua||a.uk)||"";if(!c)return;const b=k(`phrase-${p}`);g.appendChild(e("label",{for:b,style:"display:flex;gap:10px;align-items:flex-start;padding:10px 12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"},e("input",{id:b,type:"checkbox",style:"margin-top:4px;"}),e("div",{},e("span",{style:"font-weight:600;color:#0f172a;"},c),s?e("span",{class:"muted",style:"display:block;margin-top:4px;color:#475569;"},s):null)))}),r.appendChild(g)}}function Se(r,t){T(r,t,"Ð—Ð°Ð¿Ð¾Ð²Ð½Ñ–Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ¸ Ñƒ Ð´Ñ–Ð°Ð»Ð¾Ð·Ñ–");const l=Array.isArray(t==null?void 0:t.answers)?t.answers.map(m=>v(m)):[],u=[];let f=null;function i(m){f&&f!==m&&(f.style.boxShadow="none"),m&&f!==m?(m.style.boxShadow="0 0 0 2px rgba(37, 99, 235, 0.35)",f=m):(m&&(m.style.boxShadow="none"),f=null)}function n(m){m&&(m.dataset.value="",m.textContent="___",m.style.borderColor="#cbd5e1",m.style.background="#fff",m.style.boxShadow="none")}const o=e("div",{style:"display:flex;flex-wrap:wrap;gap:8px;margin:12px 0;padding:10px;border:1px solid #e2e8f0;border-radius:10px;background:#f8fafc;"}),g=Array.isArray(t==null?void 0:t.words)?t.words:[],a=new Set,p=[];g.forEach(m=>{const A=String(m||"").trim();if(!A)return;const $=v(A);a.has($)||(a.add($),p.push(A))}),p.forEach(m=>{const A=e("button",{type:"button",class:"btn",style:"padding:6px 10px;border:1px solid #94a3b8;border-radius:999px;background:#fff;color:#0f172a;cursor:pointer;font-size:14px;line-height:1;",onclick:()=>{const $=f||u.find(M=>!M.dataset.value);$&&($.dataset.value=m,$.textContent=m,$.style.borderColor="#2563eb",$.style.background="#eef2ff",i(null))}},m);A.dataset.word=m,o.appendChild(A)}),o.children.length&&r.appendChild(o);const c=e("div",{style:"display:flex;flex-direction:column;gap:10px;"}),s=Array.isArray(t==null?void 0:t.dialogue)?t.dialogue:[];let b=0;s.forEach(m=>{if(!m)return;const A=m.speaker||m.role||"",$=m.line||m.text||"",M=e("div",{style:"padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;display:flex;gap:10px;align-items:flex-start;"},A?e("strong",{style:"min-width:90px;"},`${A}:`):null),N=e("div",{style:"display:flex;flex-wrap:wrap;gap:6px;align-items:center;"}),D=String($||"").split(/___/);D.forEach((_,Q)=>{if(_&&N.appendChild(e("span",{},_)),Q<D.length-1){const K=l[b]||"",W=e("button",{type:"button",style:"min-width:52px;padding:4px 10px;border:1px solid #cbd5e1;border-radius:8px;background:#fff;color:#0f172a;cursor:pointer;",onclick:()=>{if(W.dataset.value){n(W),i(W);return}i(f===W?null:W)},ondblclick:()=>{n(W),i(null)}},"___");W.dataset.expected=K,W.dataset.index=String(b),u.push(W),b+=1,N.appendChild(W)}}),M.appendChild(N),c.appendChild(M)}),r.appendChild(c);const y=e("div",{style:"margin-top:14px;display:flex;gap:10px;flex-wrap:wrap;align-items:center;"}),x=e("button",{type:"button",class:"btn primary"},"ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€Ð¸Ñ‚Ð¸"),C=e("button",{type:"button",class:"btn"},"Ð¡ÐºÐ¸Ð½ÑƒÑ‚Ð¸"),S=e("div",{style:"font-weight:600;color:#0f172a;"});x.addEventListener("click",()=>{let m=0;u.forEach(A=>{const $=A.dataset.expected||"",M=v(A.dataset.value||A.textContent||""),N=$?M===$:!!M;A.style.borderColor=N?"#10b981":"#ef4444",A.style.background=N?"#ecfdf5":"#fee2e2",N&&(m+=1)}),u.length?S.textContent=`Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: ${m}/${u.length}`:S.textContent=""}),C.addEventListener("click",()=>{u.forEach(m=>n(m)),S.textContent="",i(null)}),y.appendChild(x),y.appendChild(C),y.appendChild(S),r.appendChild(y)}function Ae(r,t){T(r,t,"Ð£Ð¿Ð¾Ñ€ÑÐ´ÐºÑƒÐ¹Ñ‚Ðµ Ð´Ñ–Ð°Ð»Ð¾Ð³");const l=Array.isArray(t==null?void 0:t.lines)?t.lines.map(x=>({speaker:(x==null?void 0:x.speaker)||(x==null?void 0:x.role)||"",text:(x==null?void 0:x.line)||(x==null?void 0:x.text)||""})):[],u=Array.isArray(t==null?void 0:t.solution)?t.solution.map(x=>Number.parseInt(x,10)):l.map((x,C)=>C),f=e("div",{style:"display:flex;flex-direction:column;gap:8px;margin-top:10px;padding:10px;border:1px solid #e2e8f0;border-radius:10px;background:#f8fafc;"}),i=e("div",{style:"margin-top:14px;padding:12px;border:1px dashed #cbd5e1;border-radius:10px;min-height:80px;display:flex;flex-direction:column;gap:8px;"}),n=new Set;function o({speaker:x,text:C}){return(x?`${x}: ${C}`:C).trim()}function g(x){if(!x)return;const C=Number.parseInt(x.dataset.index||"-1",10),S=x.dataset.buttonId;if(S){const m=f.querySelector(`[data-id="${S}"]`);m&&(m.disabled=!1,m.style.opacity="1")}n.delete(C),x.remove()}function a(x,C,S){const m=e("div",{class:"dialogue-chip",style:"padding:10px;border:1px solid #94a3b8;border-radius:10px;background:#fff;display:flex;justify-content:space-between;align-items:center;gap:12px;cursor:pointer;",onclick:A=>{A.stopPropagation(),g(m)}},e("span",{},C),e("span",{style:"color:#94a3b8;font-size:12px;"},"Ã—"));m.dataset.index=String(x),m.dataset.buttonId=S,i.appendChild(m)}E(l.map((x,C)=>C)).forEach(x=>{const C=l[x],S=o(C),m=`line-${x}-${Math.random().toString(36).slice(2,6)}`,A=e("button",{type:"button",class:"btn",style:"text-align:left;padding:10px;border:1px solid #cbd5e1;border-radius:10px;background:#fff;color:#0f172a;cursor:pointer;",onclick:()=>{n.has(x)||(n.add(x),A.disabled=!0,A.style.opacity="0.5",a(x,S,m))},"data-id":m},S);f.appendChild(A)}),r.appendChild(f),r.appendChild(i);const c=e("div",{style:"margin-top:14px;display:flex;gap:10px;flex-wrap:wrap;align-items:center;"}),s=e("button",{type:"button",class:"btn primary"},"ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€Ð¸Ñ‚Ð¸"),b=e("button",{type:"button",class:"btn"},"Ð¡ÐºÐ¸Ð½ÑƒÑ‚Ð¸"),y=e("div",{style:"font-weight:600;color:#0f172a;"});s.addEventListener("click",()=>{const x=Array.from(i.children).map(m=>Number.parseInt(m.dataset.index||"-1",10)),C=u.slice(),S=x.length===C.length&&x.every((m,A)=>m===C[A]);i.style.borderColor=S?"#10b981":"#ef4444",y.textContent=S?"Ð”Ñ–Ð°Ð»Ð¾Ð³ Ð²Ð¿Ð¾Ñ€ÑÐ´ÐºÐ¾Ð²Ð°Ð½Ð¾ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾!":`ÐŸÐ¾Ñ‚Ð¾Ñ‡Ð½Ð¸Ð¹ Ð¿Ð¾Ñ€ÑÐ´Ð¾Ðº: ${x.length}/${C.length} Ñ€ÐµÐ¿Ð»Ñ–Ðº. ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€Ñ‚Ðµ Ð¿Ð¾ÑÐ»Ñ–Ð´Ð¾Ð²Ð½Ñ–ÑÑ‚ÑŒ.`}),b.addEventListener("click",()=>{Array.from(i.children).forEach(C=>g(C)),f.querySelectorAll("button").forEach(C=>{C.disabled=!1,C.style.opacity="1"}),n.clear(),i.style.borderColor="#cbd5e1",y.textContent=""}),c.appendChild(s),c.appendChild(b),c.appendChild(y),r.appendChild(c)}function Ee(r,t){T(r,t,"ÐžÐ±ÐµÑ€Ð¸ True Ð°Ð±Ð¾ False");const l=[];if((Array.isArray(t==null?void 0:t.items)?t.items:[]).forEach((o,g)=>{if(!o||!o.statement)return;const a=e("div",{style:"margin:8px 0;padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"},e("p",{style:"margin:0 0 8px;font-weight:600;"},o.statement)),p=`${t.id||"tf"}-${g}`,c=!!o.answer,s=k(`${p}-true`),b=e("label",{for:s,style:"display:inline-flex;align-items:center;gap:6px;margin-right:16px;"},e("input",{type:"radio",name:p,value:"true",id:s}),"True"),y=k(`${p}-false`),x=e("label",{for:y,style:"display:inline-flex;align-items:center;gap:6px;"},e("input",{type:"radio",name:p,value:"false",id:y}),"False"),C=e("div",{style:"display:flex;align-items:center;"});C.appendChild(b),C.appendChild(x),a.appendChild(C),l.push({row:a,name:p,expected:c}),r.appendChild(a)}),!l.length)return;const f=e("div",{style:"margin-top:14px;display:flex;gap:10px;align-items:center;flex-wrap:wrap;"}),i=e("button",{type:"button",class:"btn primary"},"ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€Ð¸Ñ‚Ð¸"),n=e("div",{style:"font-weight:600;color:#0f172a;"});i.addEventListener("click",()=>{let o=0;l.forEach(({row:g,name:a,expected:p})=>{const c=g.querySelector(`input[name="${a}"]:checked`),s=c?c.value===String(p):!1;g.style.borderColor=s?"#10b981":"#ef4444",s&&(o+=1)}),n.textContent=`Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: ${o}/${l.length}`}),f.appendChild(i),f.appendChild(n),r.appendChild(f)}function $e(r,t){T(r,t,"Ð”Ð¾Ð±ÐµÑ€Ñ–Ñ‚ÑŒ ÑÐ»Ð¾Ð²Ð¾ Ð·Ð° Ð¾Ð¿Ð¸ÑÐ¾Ð¼");const l=Array.isArray(t==null?void 0:t.wordBank)?t.wordBank:[];if(l.length){const o=e("div",{style:"margin:8px 0 12px;padding:10px;border:1px solid #e2e8f0;border-radius:10px;background:#f8fafc;display:flex;flex-wrap:wrap;gap:8px;"});l.forEach(g=>{const a=String(g||"").trim();a&&o.appendChild(e("span",{style:"padding:6px 10px;border:1px solid #94a3b8;border-radius:999px;background:#fff;font-size:14px;"},a))}),r.appendChild(o)}const u=[];if((Array.isArray(t==null?void 0:t.items)?t.items:[]).forEach((o,g)=>{if(!o||!o.clue)return;const a=e("div",{style:"margin-bottom:10px;padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"});a.appendChild(e("p",{style:"margin:0 0 6px;font-weight:600;"},o.clue));const p=k(`${t.id||"synonym"}-${g}`),c=e("input",{type:"text",id:p,style:"width:100%;max-width:320px;padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});a.appendChild(c);const s=Array.isArray(o==null?void 0:o.answers)?o.answers.map(b=>v(b)):Array.isArray(o==null?void 0:o.answer)?o.answer.map(b=>v(b)):o!=null&&o.answer?[v(o.answer)]:[];u.push({row:a,input:c,answers:s}),r.appendChild(a)}),!u.length)return;const i=e("div",{style:"font-weight:600;color:#0f172a;"}),n=e("button",{type:"button",class:"btn primary"},"ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€Ð¸Ñ‚Ð¸");n.addEventListener("click",()=>{let o=0;u.forEach(({row:g,input:a,answers:p})=>{const c=v(a.value),s=p.length?p.includes(c):!!c;g.style.borderColor=s?"#10b981":"#ef4444",s&&(o+=1)}),i.textContent=`Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: ${o}/${u.length}`}),r.appendChild(n),r.appendChild(i)}function ke(r,t){T(r,t,"Ð Ð¾Ð·ÑˆÐ¸Ñ„Ñ€ÑƒÐ¹Ñ‚Ðµ ÑÐ»Ð¾Ð²Ð°");const l=[];if((Array.isArray(t==null?void 0:t.items)?t.items:[]).forEach((n,o)=>{if(!n||!n.scrambled)return;const g=e("div",{style:"margin-bottom:10px;padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"});g.appendChild(e("div",{style:"margin-bottom:6px;font-weight:600;"},n.scrambled));const a=k(`${t.id||"scramble"}-${o}`),p=e("input",{type:"text",id:a,style:"width:100%;max-width:260px;padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});g.appendChild(p);const c=Array.isArray(n==null?void 0:n.answers)?n.answers.map(s=>v(s)):Array.isArray(n==null?void 0:n.answer)?n.answer.map(s=>v(s)):n!=null&&n.answer?[v(n.answer)]:[];l.push({row:g,input:p,answers:c}),r.appendChild(g)}),!l.length)return;const f=e("button",{type:"button",class:"btn primary"},"ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€Ð¸Ñ‚Ð¸"),i=e("div",{style:"margin-top:6px;font-weight:600;color:#0f172a;"});f.addEventListener("click",()=>{let n=0;l.forEach(({row:o,input:g,answers:a})=>{const p=v(g.value),c=a.length?a.includes(p):!!p;o.style.borderColor=c?"#10b981":"#ef4444",c&&(n+=1)}),i.textContent=`Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: ${n}/${l.length}`}),r.appendChild(f),r.appendChild(i)}function Le(r,t){T(r,t,"Ð—Ð½Ð°Ð¹Ð´Ð¸ Ð·Ð°Ð¹Ð²Ðµ ÑÐ»Ð¾Ð²Ð¾");const l=[];if((Array.isArray(t==null?void 0:t.items)?t.items:[]).forEach((n,o)=>{const g=Array.isArray(n==null?void 0:n.options)?n.options:[];if(!g.length)return;const a=e("div",{style:"margin-bottom:10px;padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"});a.appendChild(e("div",{style:"margin-bottom:6px;font-weight:600;"},`ÐÐ°Ð±Ñ–Ñ€ ${o+1}`));const p=`${t.id||"odd"}-${o}`;g.forEach((b,y)=>{const x=k(`${p}-${y}`);a.appendChild(e("label",{for:x,style:"display:flex;align-items:center;gap:6px;margin:4px 0;"},e("input",{type:"radio",name:p,value:String(y),id:x}),b))});const c=String((n==null?void 0:n.explanation)||"").trim();if(c){const b=e("div",{class:"muted",style:"display:none;margin-top:6px;color:#475569;"});b.textContent=`ÐŸÐ¾ÑÑÐ½ÐµÐ½Ð½Ñ: ${c}`,a.appendChild(b)}const s=v((n==null?void 0:n.answer)||"");l.push({row:a,groupName:p,answerIndex:s}),r.appendChild(a)}),!l.length)return;const f=e("button",{type:"button",class:"btn primary"},"ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€Ð¸Ñ‚Ð¸"),i=e("div",{style:"margin-top:6px;font-weight:600;color:#0f172a;"});f.addEventListener("click",()=>{let n=0;l.forEach(({row:o,groupName:g,answerIndex:a})=>{const p=o.querySelector(`input[name="${g}"]:checked`),c=v(p?p.value:""),s=a?c===a:!!c;o.style.borderColor=s?"#10b981":"#ef4444";const b=o.querySelector(".muted");b&&(b.style.display=s?"none":"block"),s&&(n+=1)}),i.textContent=`Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: ${n}/${l.length}`}),r.appendChild(f),r.appendChild(i)}function Ie(r,t){T(r,t,"Writing/Speaking prompt"),t.description&&r.appendChild(e("p",{class:"muted"},t.description));const l=e("div",{style:"margin-top:8px;"});(t.checklist||[]).forEach((i,n)=>{const o=k(`${t.id||"check"}-${n}`),g=e("label",{for:o,style:"display:flex;align-items:center;gap:8px;margin:6px 0;"},e("input",{id:o,type:"checkbox"}),e("span",{},i));l.appendChild(g)}),r.appendChild(l);const u=e("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"ÐŸÐ¾Ð·Ð½Ð°Ñ‡Ð¸Ñ‚Ð¸ ÑÐº Ð¿ÐµÑ€ÐµÐ²Ñ–Ñ€ÐµÐ½Ð¾"),f=e("div",{class:"muted",style:"margin-top:6px;"});u.addEventListener("click",()=>{f.textContent="Ð“Ð¾Ñ‚Ð¾Ð²Ð¾! ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€ ÑÐ¿Ð¸ÑÐ¾Ðº Ñ– Ð·Ð° Ð±Ð°Ð¶Ð°Ð½Ð½ÑÐ¼ Ð²Ñ–Ð´Ð¿Ñ€Ð°Ð² Ð½Ð°ÑÑ‚Ð°Ð²Ð½Ð¸ÐºÑƒ."}),r.appendChild(u),r.appendChild(f)}function Ne(r,t){T(r,t,"Audio task");const l=[],u=s=>{if(!s)return;if(Array.isArray(s)){s.forEach(u);return}const b=String(s).trim();b&&l.push(b)};u(t.audioSrc),u(t.audioUrl),u(t.audio),u(t.source),u(t.sources);const f=Array.from(new Set(l));if(f.length){const s=e("div",{style:"margin-top:8px;padding:12px;border:1px solid #cbd5e1;border-radius:10px;background:#f1f5f9;"}),b=e("audio",{controls:!0,style:"width:100%;display:block;"});f.forEach(y=>{b.appendChild(e("source",{src:h(y)}))}),b.appendChild(document.createTextNode("Ð’Ð°Ñˆ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€ Ð½Ðµ Ð¿Ñ–Ð´Ñ‚Ñ€Ð¸Ð¼ÑƒÑ” Ð²Ñ–Ð´Ñ‚Ð²Ð¾Ñ€ÐµÐ½Ð½Ñ Ð°ÑƒÐ´Ñ–Ð¾.")),s.appendChild(b),r.appendChild(s)}const i=Array.isArray(t.dialogs)?t.dialogs:[],n=[];if(i.forEach(s=>{if(s){if(typeof s=="string"){const b=s.trim();b&&n.push({text:b});return}if(typeof s=="object"){const b="text"in s?String(s.text||"").trim():"";if(!b)return;const y={text:b};s.voice&&(y.voice=s.voice),s.voiceName&&(y.voiceName=s.voiceName),s.gender&&(y.gender=s.gender),s.lang&&(y.lang=s.lang),s.rate!=null&&(y.rate=s.rate),s.pitch!=null&&(y.pitch=s.pitch),s.volume!=null&&(y.volume=s.volume),s.ttsOptions&&typeof s.ttsOptions=="object"&&(y.ttsOptions={...s.ttsOptions}),n.push(y)}}}),!n.length){if(Array.isArray(t.text))t.text.map(s=>String(s||"").trim()).filter(Boolean).forEach(s=>n.push({text:s}));else if(typeof t.text=="string"){const s=String(t.text||"").trim();s&&n.push({text:s})}}const o=typeof window<"u"&&"speechSynthesis"in window?window.speechSynthesis:null,g={};if(t.lang&&(g.lang=t.lang),t.voiceName&&(g.voiceName=t.voiceName),t.voice&&(g.voice=t.voice),t.gender&&(g.gender=t.gender),typeof t.ttsOptions=="object"&&t.ttsOptions&&Object.assign(g,t.ttsOptions),typeof t.voiceOptions=="object"&&t.voiceOptions&&Object.assign(g,t.voiceOptions),typeof t.speechOptions=="object"&&t.speechOptions&&Object.assign(g,t.speechOptions),n.length&&o){const s=e("div",{style:"margin-top:8px;display:flex;align-items:center;gap:10px;flex-wrap:wrap;"}),b=e("button",{type:"button",class:"btn primary",style:"padding:8px 14px;border-radius:8px;border:1px solid #0284c7;background:#0ea5e9;color:#fff;cursor:pointer;display:inline-flex;align-items:center;gap:6px;"},"â–¶ Play");b.setAttribute("aria-pressed","false");const y=e("button",{type:"button",class:"btn secondary",style:"padding:8px 14px;border-radius:8px;border:1px solid #cbd5e1;background:#fff;color:#0f172a;cursor:pointer;display:inline-flex;align-items:center;gap:6px;"},"ðŸ‘ ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚Ð¸ Ñ‚ÐµÐºÑÑ‚");y.setAttribute("aria-expanded","false");const x=(L,P,J)=>Math.min(J,Math.max(P,L)),C=k("speech-rate"),S=.5,m=1.5,A=L=>{const P=Number(L);return Number.isFinite(P)?P:1};let M=x(A(g.rate!=null?g.rate:1),S,m),N=!1,D=!1,_=0,Q=null,K=!1;const W=e("div",{class:"audio-transcript",style:"display:none;margin-top:12px;padding:12px;border:1px solid #cbd5e1;border-radius:10px;background:#fff;color:#0f172a;"});n.forEach((L,P)=>{const J=e("p",{style:P===0?"margin:0 0 6px 0;":"margin:6px 0 0 0;"},L.text);W.appendChild(J)});const pe=e("span",{style:"font-weight:600;min-width:42px;text-align:right;color:#0f172a;"},`${M.toFixed(1)}x`),ie=e("input",{type:"range",id:C,min:String(S),max:String(m),step:"0.1",value:String(M),style:"flex:1;"});ie.addEventListener("input",()=>{M=x(A(ie.value),S,m),N=!0,pe.textContent=`${M.toFixed(1)}x`});const Te=e("div",{style:"display:flex;align-items:center;gap:8px;padding:6px 10px;border:1px solid #e2e8f0;border-radius:8px;background:#fff;min-width:240px;"},e("label",{for:C,style:"font-size:14px;color:#475569;"},"Ð¨Ð²Ð¸Ð´ÐºÑ–ÑÑ‚ÑŒ"),ie,pe),ce=()=>{W.style.display=K?"block":"none",y.textContent=K?"ðŸ™ˆ Ð¡Ñ…Ð¾Ð²Ð°Ñ‚Ð¸ Ñ‚ÐµÐºÑÑ‚":"ðŸ‘ ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚Ð¸ Ñ‚ÐµÐºÑÑ‚",y.setAttribute("aria-expanded",K?"true":"false")},te=()=>{D=!1,_=0,Q&&(Q.onend=null,Q.onerror=null,Q=null),b.textContent="â–¶ Play",b.setAttribute("aria-pressed","false")},se=async()=>{if(!D||_>=n.length){te();return}const L=n[_],P={...g};L.lang&&(P.lang=L.lang),L.voiceName&&(P.voiceName=L.voiceName),L.voice&&(P.voice=L.voice),L.gender&&(P.gender=L.gender),L.rate!=null&&(P.rate=L.rate),L.pitch!=null&&(P.pitch=L.pitch),L.volume!=null&&(P.volume=L.volume),L.ttsOptions&&typeof L.ttsOptions=="object"&&L.ttsOptions&&Object.assign(P,L.ttsOptions),(N||P.rate==null)&&(P.rate=x(M,S,m));try{const J=await he(L.text,P);if(!J){_+=1,se();return}Q=J,J.onend=()=>{D&&(Q=null,_+=1,se())},J.onerror=te}catch{te()}};b.addEventListener("click",()=>{if(D)o&&o.cancel(),te();else{if(!n.length)return;D=!0,_=0,b.textContent="â¹ Stop",b.setAttribute("aria-pressed","true"),se()}}),y.addEventListener("click",()=>{K=!K,ce()}),ce(),s.appendChild(b),s.appendChild(y),s.appendChild(Te),f.length||s.appendChild(e("span",{class:"muted",style:"font-size:14px;"},"ÐŸÑ€Ð¾ÑÐ»ÑƒÑ…Ð°Ð¹Ñ‚Ðµ Ð´Ñ–Ð°Ð»Ð¾Ð³ Ð·Ð° Ð´Ð¾Ð¿Ð¾Ð¼Ð¾Ð³Ð¾ÑŽ ÑÐ¸Ð½Ñ‚ÐµÐ·Ñƒ Ð¼Ð¾Ð²Ð»ÐµÐ½Ð½Ñ.")),r.appendChild(s),r.appendChild(W)}else!f.length&&n.length&&r.appendChild(e("p",{class:"muted",style:"margin-top:8px;"},"Ð’Ð°Ñˆ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€ Ð½Ðµ Ð¿Ñ–Ð´Ñ‚Ñ€Ð¸Ð¼ÑƒÑ” ÑÐ¸Ð½Ñ‚ÐµÐ· Ð¼Ð¾Ð²Ð»ÐµÐ½Ð½Ñ."));const a=Array.isArray(t.questions)?t.questions.filter(Boolean):[];if(!a.length)return;const p=e("div",{style:"margin-top:16px;"}),c=[];if(a.forEach((s,b)=>{const y=typeof s=="string"?{prompt:s}:s&&typeof s=="object"?s:{prompt:String(s)},x=y.prompt||y.q||`Question ${b+1}`,C=e("div",{style:"margin-bottom:12px;padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"},e("div",{style:"font-weight:600;margin-bottom:8px;"},x));if(y.hint&&C.appendChild(q(y.hint)),Array.isArray(y.choices)&&y.choices.length){const m=(Array.isArray(y.answer)?y.answer:y.answer!=null?[y.answer]:[]).map(N=>String(N)),A=m.length>1,$=m.every(N=>/^\d+$/.test(N)),M=k(`${t.id||"audio"}-${b}`);y.choices.forEach((N,D)=>{const _=k(`${M}-${D}`);C.appendChild(e("label",{for:_,style:"display:flex;align-items:center;gap:8px;margin:4px 0;"},e("input",{type:A?"checkbox":"radio",name:M,id:_,value:String(D)}),e("span",{},N)))}),m.length&&c.push({type:"choices",block:C,getPicked:()=>{const D=Array.from(C.querySelectorAll(`input[name='${M}']`)).filter(_=>_.checked).map(_=>_.value);return $?D:D.map(_=>v(y.choices[Number(_)]||""))},expected:$?m.slice():m.map(N=>v(N))})}else{const S=e("textarea",{rows:y.rows||2,style:"width:100%;max-width:640px;padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});C.appendChild(S);const A=(Array.isArray(y.answer)?y.answer:y.answer!=null?[y.answer]:Array.isArray(y.answers)?y.answers:[]).map($=>v($)).filter(Boolean);A.length&&c.push({type:"text",block:C,input:S,expected:A})}p.appendChild(C)}),c.length){const s=e("div",{style:"margin-top:8px;font-weight:600;"}),b=e("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€Ð¸Ñ‚Ð¸");b.addEventListener("click",()=>{let y=0;c.forEach(x=>{if(x.type==="choices"){const C=x.getPicked().sort(),S=x.expected.slice().sort(),m=C.length===S.length&&C.every((A,$)=>A===S[$]);x.block.style.borderColor=m?"#10b981":"#ef4444",m&&y++}else if(x.type==="text"){const C=v(x.input.value),S=x.expected.includes(C);x.block.style.borderColor=S?"#10b981":"#ef4444",S&&y++}}),s.textContent=`Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: ${y}/${c.length}`}),p.appendChild(b),p.appendChild(s)}else p.appendChild(e("p",{class:"muted",style:"margin-top:4px;"},"Ð—Ð°Ð¿Ð¸ÑˆÑ–Ñ‚ÑŒ Ð²Ñ–Ð´Ð¿Ð¾Ð²Ñ–Ð´Ñ– â€” Ð²Ð¸ÐºÐ»Ð°Ð´Ð°Ñ‡ Ð¿ÐµÑ€ÐµÐ²Ñ–Ñ€Ð¸Ñ‚ÑŒ Ñ—Ñ… Ð¿Ñ–Ð·Ð½Ñ–ÑˆÐµ."));r.appendChild(p)}function de(){let r=document.getElementById("practice");if(!r&&/\/grammar\//.test(location.pathname)){const t=e("div",{class:"container"});t.appendChild(e("hr",{class:"sep"})),r=e("section",{id:"practice"}),t.appendChild(r),document.body.appendChild(t)}return r}function Oe(){return e("input",{type:"checkbox",class:"check-task-status"})}function T(r,t,l){r.appendChild(e("h3",{},Oe(),t.prompt||l))}function Be(){const r=de();if(!r)return;let t=r.querySelector("#practice-body");if(t||(t=e("div",{id:"practice-body"}),r.appendChild(t)),(window.lessonContext||{}).isCustomLesson){const u=r.querySelector("[data-practice-placeholder]");u&&(u.textContent="ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÐ° Ð´Ð»Ñ ÐºÐ¾Ð¶Ð½Ð¾Ñ— Ñ‚ÐµÐ¼Ð¸ Ñ€Ð¾Ð·Ð¼Ñ–Ñ‰ÐµÐ½Ð° Ð¾Ð´Ñ€Ð°Ð·Ñƒ Ð¿Ñ–ÑÐ»Ñ Ñ‚ÐµÐ¾Ñ€Ñ–Ñ—. Ð¢ÑƒÑ‚ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð·Ð³ÐµÐ½ÐµÑ€ÑƒÐ²Ð°Ñ‚Ð¸ Ð´Ð¾Ð´Ð°Ñ‚ÐºÐ¾Ð²Ñ– Ð·Ð°Ð²Ð´Ð°Ð½Ð½Ñ."),t&&(t.innerHTML='<p class="muted">Ð—Ð³ÐµÐ½ÐµÑ€ÑƒÐ¹Ñ‚Ðµ Ð´Ð¾Ð´Ð°Ñ‚ÐºÐ¾Ð²Ñ– Ð²Ð¿Ñ€Ð°Ð²Ð¸ Ð°Ð±Ð¾ Ð´Ð¾Ð´Ð°Ð¹Ñ‚Ðµ Ð²Ð»Ð°ÑÐ½Ñ– Ð·Ð°Ð²Ð´Ð°Ð½Ð½Ñ.</p>'),document.dispatchEvent(new CustomEvent("practice:dataLoaded",{detail:null})),document.dispatchEvent(new CustomEvent("practice:rendered",{detail:{ok:!1,reason:"custom-lesson"}}));return}xe().then(u=>{if(!u){document.dispatchEvent(new CustomEvent("practice:dataLoaded",{detail:null})),t.innerHTML='<p class="muted">ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÐ° Ð¿Ð¾ÐºÐ¸ Ð²Ñ–Ð´ÑÑƒÑ‚Ð½Ñ.</p>',document.dispatchEvent(new CustomEvent("practice:rendered",{detail:{ok:!1}}));return}t.innerHTML="";const f=e("div",{},e("h2",{},"Practice ",e("span",{class:"badge"},u.level||"B1")),u.title?e("p",{class:"muted"},u.title):null);t.appendChild(f);const i=(u.tasks||[]).map((n,o)=>({key:n&&n.id?String(n.id):`base-${o}`,task:n}));document.dispatchEvent(new CustomEvent("practice:dataLoaded",{detail:{title:u.title,level:u.level,entries:i}})),i.forEach(({task:n,key:o})=>G(t,n,o)),document.dispatchEvent(new CustomEvent("practice:rendered",{detail:{ok:!0}}))})}return(typeof window<"u"&&window.practiceConfig||{}).disableAutoInit||document.addEventListener("DOMContentLoaded",Be),window.practice=window.practice||{},Object.assign(window.practice,{appendTask:B,renderTaskList:H,createTaskElement:X}),{appendTask:B,renderTaskList:H,createTaskElement:X}}(),st=ge.createTaskElement,at=ge.renderTaskList;document.addEventListener("click",d=>{const h=d.target.closest(".text-block");if(h){const w=h.innerHTML;navigator.clipboard.writeText(`<div class="text-block">${w}</div>`),console.log("Ð¡ÐºÐ¾Ð¿Ñ–Ð¹Ð¾Ð²Ð°Ð½Ð¾")}});export{ot as a,nt as b,st as c,Qe as d,Pe as e,U as f,_e as g,it as h,Ke as i,rt as j,at as r,De as s};
//# sourceMappingURL=practice-CNInYtjF.js.map
