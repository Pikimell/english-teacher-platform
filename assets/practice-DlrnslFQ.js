import{i as J,a as ne}from"./auth-CUcfS-ao.js";const Ee=async(d=1,h=1e3)=>(await J.get("/user")).data,X={},Ge=async d=>{const h=JSON.stringify(d),w=X[h];if(w)return w;const e=await J.post("/homework/list",d);return X[h]=e.data,e.data},$e=async d=>(await J.post("/homework",d)).data;function ke(d,h){const e=d.items.find(L=>L._id===h.taskId).answers,$=e.findIndex(L=>L.name==h.name);$>=0?e[$]=h:e.push(h);const S={taskId:h.taskId,answers:e};return Z(S)}function Le(d,h){if(h.type==="radio")return ke(d,h);const e=d.items.find(L=>L._id===h.taskId).answers,$=e.findIndex(L=>L.inputId==h.inputId),S={taskId:h.taskId,answers:e};return $>=0?e[$]=h:e.push(h),Z(S)}const Je=async d=>{const h=Object.keys(X);let w=X[h[0]];if(w)Le(w,d);else{const e={taskId:d.taskId,answers:[d]};return Z(e)}},Z=async({taskId:d,...h})=>(await J.patch(`/homework/${d}`,h)).data,Qe=async d=>{const h={page:1,limit:100,userEmail:d},w=await J.post("/homework/lessons",h),{data:e}=w;return e.items=e.items.reverse(),e.items},B={users:null,request:null,active:null};function Ie(){return B.users?Promise.resolve(B.users):(B.request||(B.request=Ee().then(d=>{const h=Array.isArray(d==null?void 0:d.items)?d.items:[];return B.users=h,h}).catch(d=>{throw console.error("–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤",d),d}).finally(()=>{B.request=null})),B.request)}function Oe(d){if(!d||typeof d!="object")return"–ù–µ–≤—ñ–¥–æ–º–∏–π —Å—Ç—É–¥–µ–Ω—Ç";const h=d.firstName||d.firstname||d.nameFirst||"",w=d.lastName||d.lastname||d.nameLast||"";return[h,w].map(S=>String(S||"").trim()).filter(Boolean).join(" ")||d.displayName||d.fullName||d.username||d.email||(d.id?`ID ${d.id}`:"")||"–ë–µ–∑ —ñ–º–µ–Ω—ñ"}function H(){if(!B.active)return;const{panel:d,button:h}=B.active;d.style.display="none",d.dataset.open="false",h.setAttribute("aria-expanded","false"),B.active=null}const Y=new Set;let K=!1;function re(d){const{button:h,panel:w}=d;if(!(!h||!w)){if(!h.isConnected&&!w.isConnected){Y.delete(d);return}if(K){h.hidden=!1;return}h.hidden=!0,w.style.display="none",w.dataset.open="false"}}function Ne(d,h){const w={button:d,panel:h};return Y.add(w),re(w),()=>{Y.delete(w)}}function Be(d){const h=!!d;K!==h&&(K=h,K||H(),Y.forEach(w=>re(w)))}function _e(d){if(!B.active)return;const{panel:h,button:w}=B.active,e=d.target;h.contains(e)||w.contains(e)||H()}function Te(d){d.key==="Escape"&&H()}document.addEventListener("click",_e);document.addEventListener("keydown",Te);function W(d,h={},...w){const e=document.createElement(d);for(const[$,S]of Object.entries(h||{}))$==="class"?e.className=S:$==="html"?e.innerHTML=S:$.startsWith("on")&&typeof S=="function"?e.addEventListener($.slice(2),S):e.setAttribute($,S);for(const $ of w)$!=null&&e.appendChild(typeof $=="string"?document.createTextNode($):$);return e}const G={triggerLabel:"–ù–∞–¥—ñ—Å–ª–∞—Ç–∏",triggerClassName:"practice-share-trigger for-admin js-share-homework-btn",triggerStyle:"border:none;background:#2563eb;color:#fff;padding:4px 10px;border-radius:999px;font-size:12px;line-height:1;cursor:pointer;box-shadow:0 4px 12px rgba(37,99,235,0.24);",panelClassName:"practice-share-panel",panelStyle:"position:absolute;top:38px;right:0;min-width:240px;max-width:280px;border:1px solid #e2e8f0;border-radius:12px;background:#fff;box-shadow:0 18px 40px rgba(15,23,42,0.18);padding:8px;z-index:30;display:none;",emptyMessage:"–°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –ø–æ—Ä–æ–∂–Ω—ñ–π",loadingMessage:"–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è‚Ä¶",errorMessage:"–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.",formatStudentName:Oe,fetchStudents:Ie,getContext:null,onShare:()=>{},renderDetails:d=>d!=null&&d.email?W("span",{class:"muted",style:"font-size:12px;color:#475569;"},d.email):null};function Pe(d={}){const h={...G,...d};return h.fetchStudents=typeof d.fetchStudents=="function"?d.fetchStudents:G.fetchStudents,h.formatStudentName=typeof d.formatStudentName=="function"?d.formatStudentName:G.formatStudentName,h.renderDetails=typeof d.renderDetails=="function"?d.renderDetails:G.renderDetails,h.onShare=typeof d.onShare=="function"?d.onShare:G.onShare,h.getContext=typeof d.getContext=="function"?d.getContext:()=>d.context,h}function je(d,h,w){if(d.innerHTML="",!h.length){d.appendChild(W("div",{class:"muted",style:"font-size:13px;text-align:center;padding:12px 8px;"},w.emptyMessage));return}const e=W("ul",{style:"list-style:none;margin:0;padding:0;max-height:220px;overflow:auto;"}),$=typeof w.getContext=="function"?w.getContext:G.getContext;h.forEach(S=>{const L=W("button",{type:"button",style:"width:100%;background:transparent;border:none;text-align:left;padding:8px 10px;border-radius:8px;cursor:pointer;display:flex;flex-direction:column;gap:2px;",onmouseenter:()=>{L.style.backgroundColor="#f1f5f9"},onmouseleave:()=>{L.style.backgroundColor="transparent"},onclick:()=>{const _=typeof $=="function"?$(S):void 0;try{const I=w.onShare({student:S,context:_});if(I&&typeof I.then=="function"){L.disabled=!0,Promise.resolve(I).then(q=>{q!==!1&&H()}).catch(q=>{console.error("–ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥ —á–∞—Å –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è",q),H()}).finally(()=>{L.disabled=!1});return}I!==!1&&H()}catch(I){console.error("–ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥ —á–∞—Å –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è",I),H()}}},W("span",{style:"font-size:14px;font-weight:600;color:#0f172a;"},w.formatStudentName(S)),w.renderDetails?w.renderDetails(S):null),k=W("li",{style:"margin:0;padding:0;"},L);e.appendChild(k)}),d.appendChild(e)}function qe(d){return W("div",{class:d.panelClassName,role:"dialog","aria-label":"–ù–∞–¥—Å–∏–ª–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è —Å—Ç—É–¥–µ–Ω—Ç—É",style:d.panelStyle,"data-open":"false"})}function ze(d,h,w){if(h.dataset.open==="true"){H();return}B.active&&B.active.panel!==h&&H(),h.dataset.open="true",h.style.display="block",d.setAttribute("aria-expanded","true"),h.innerHTML="",h.appendChild(W("div",{class:"muted",style:"font-size:13px;padding:12px 8px;text-align:center;"},w.loadingMessage)),B.active={panel:h,button:d},Promise.resolve(w.fetchStudents()).then($=>{je(h,Array.isArray($)?$:[],w)}).catch(()=>{h.innerHTML="",h.appendChild(W("div",{style:"color:#ef4444;font-size:13px;text-align:center;padding:12px 8px;"},w.errorMessage))})}function Me(d,h){const w=W("button",{type:"button",class:h.triggerClassName,title:"–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç—É","aria-haspopup":"dialog","aria-expanded":"false",style:h.triggerStyle,onclick:e=>{e.preventDefault(),ze(w,d,h)}},h.triggerLabel);return w}function Re(d={}){const h=Pe(d),w=qe(h),e=Me(w,h),$=Ne(e,w);return{button:e,panel:w,unregister:$}}function De(d){return!!(B.active&&B.active.panel===d)}function We(){return new Promise(d=>{const h=speechSynthesis.getVoices();if(h.length)return d(h);speechSynthesis.onvoiceschanged=()=>d(speechSynthesis.getVoices())})}function M(d){return String(d||"").trim().toLowerCase()}function He(d,h={}){if(!Array.isArray(d)||!d.length)return null;const{lang:w="en",voiceName:e,voice:$,voiceGender:S,gender:L}=h,k=M(w)||"en",_=e||($&&/\s/.test(String($))?String($):null),q=M(L||S||!_&&$||null);let j=_&&d.find(O=>O.name===_)||_&&d.find(O=>M(O.name)===M(_))||null;const Q=O=>{if(!q)return!1;const z=M(O.name),V=M(O.voiceURI);return q==="male"?z.includes("male")||V.includes("male")||/\bmale\b|\bman\b|\bboy\b|m\d/.test(z):q==="female"?z.includes("female")||V.includes("female")||z.includes("woman")||z.includes("girl"):z.includes(q)||V.includes(q)},F=d.filter(O=>M(O.lang).startsWith(k));if(!j&&q&&(j=F.find(Q)||d.find(Q)||null),!j&&_&&M(_)){const O=M(_);j=F.find(z=>M(z.name).includes(O))||d.find(z=>M(z.name).includes(O))||null}return j||(j=F.find(O=>M(O.name).includes("female"))||F[0]||d.find(O=>M(O.name).includes("female"))||d[0]||null),j||null}async function oe(d,{lang:h="en",voiceName:w,voice:e,voiceGender:$,gender:S,rate:L=1,pitch:k=1,volume:_=1}={}){await We();const I=new SpeechSynthesisUtterance(d),q=speechSynthesis.getVoices(),j=He(q,{lang:h,voiceName:w,voice:e,voiceGender:$,gender:S});return j?(I.voice=j,I.lang=j.lang||h||"en"):I.lang=h||"en",I.rate=L,I.pitch=k,I.volume=_,speechSynthesis.cancel(),speechSynthesis.speak(I),I}function Ke(d){const h=document.createElement("span");return h.textContent="üîä",h.addEventListener("click",()=>{oe(d)}),h.classList.add("play-speak-btn"),h}const Fe={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},ie=function(){const d=typeof import.meta<"u"&&Fe&&"/"||"/";function h(r){const t=d.endsWith("/")?d:`${d}/`,l=String(r||"");return/^[a-z]+:/i.test(l)||l.startsWith(t)?l:`${t}${l.replace(/^\/+/,"")}`}function w(){try{const t=new URL(window.location.href).pathname.split("/");let l=t.pop();(!l||!/\.html?$/i.test(l))&&(l="index.html");const u=l.replace(/\.html?$/i,".json");return t.push("practice",u),t.join("/")}catch{return null}}function e(r,t={},...l){const u=document.createElement(r);for(const[f,i]of Object.entries(t||{}))f==="class"?u.className=i:f==="html"?u.innerHTML=i:f.startsWith("on")&&typeof i=="function"?u.addEventListener(f.slice(2),i):u.setAttribute(f,i);for(const f of l)f!=null&&u.appendChild(typeof f=="string"?document.createTextNode(f):f);return u}function $(r){const t=r.slice();for(let l=t.length-1;l>0;l--){const u=Math.floor(Math.random()*(l+1));[t[l],t[u]]=[t[u],t[l]]}return t}function S(r){return String(r||"").trim().toLowerCase().replace(/\s+/g," ")}let L=0;function k(r="practice-input"){return L+=1,`${String(r||"practice-input").trim().replace(/[^a-z0-9_-]+/gi,"-").replace(/^-+|-+$/g,"")||"practice-input"}-${L}`}ne.subscribe(({user:r})=>{Be(ne.isAdmin(r))});function _(r){const t=e("div",{class:"hint-wrap",style:"margin-top:6px;"}),l=e("button",{type:"button",class:"hint-toggle","aria-label":"–ü–æ–∫–∞–∑–∞—Ç–∏ –ø—ñ–¥–∫–∞–∑–∫—É",title:"–ü—ñ–¥–∫–∞–∑–∫–∞",style:"border:none;background:transparent;color:#94a3b8;cursor:pointer;padding:0;font-size:14px;line-height:1;"},"?"),u=e("div",{class:"hint-box muted",style:"display:none;margin-top:6px;color:#475569;"},`–ü—ñ–¥–∫–∞–∑–∫–∞: ${r}`);return l.addEventListener("click",()=>{const f=u.style.display==="none";u.style.display=f?"block":"none",l.setAttribute("aria-expanded",f?"true":"false")}),t.appendChild(l),t.appendChild(u),t}function I(r,t){N(r,t,"Choose the correct option");const l=[];(t.items||[]).forEach((i,n)=>{const o=`${t.id||"mcq"}-${n}`,x=Array.isArray(i.answer)&&i.answer.length>1,s=e("div",{class:"mcq-item",style:"margin-bottom:10px;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"},e("div",{class:"q",style:"margin-bottom:8px;font-weight:600;"},i.q));(i.choices||[]).forEach((p,c)=>{const a=k(`${o}-${c}`),y=e("label",{for:a,style:"display:flex;align-items:center;gap:8px;margin:4px 0;"},e("input",{type:x?"checkbox":"radio",name:o,id:a,value:String(c)}),e("span",{},p));s.appendChild(y)}),i.explanation&&s.appendChild(e("div",{class:"exp muted",style:"display:none;margin-top:6px;color:#475569;"},i.explanation)),l.push({block:s,item:i,name:o}),r.appendChild(s)});const u=e("div",{class:"result",style:"margin-top:8px;font-weight:600;"}),f=e("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏");f.addEventListener("click",()=>{let i=0;l.forEach(({block:n,item:o,name:x})=>{const s=Array.isArray(o.answer)?o.answer.map(String):[String(o.answer)],c=Array.from(n.querySelectorAll(`input[name='${x}']`)).filter(g=>g.checked).map(g=>g.value).sort(),a=s.slice().sort(),y=c.length===a.length&&c.every((g,C)=>g===a[C]);n.style.borderColor=y?"#10b981":"#ef4444";const b=n.querySelector(".exp");b&&(b.style.display=y?"none":"block"),y&&i++}),u.textContent=`–†–µ–∑—É–ª—å—Ç–∞—Ç: ${i}/${l.length}`}),r.appendChild(f),r.appendChild(u)}function q(r,t){N(r,t,"Fill the gaps");const l=[];(t.items||[]).forEach((i,n)=>{const o=e("div",{style:"margin-bottom:10px;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"}),x=String(i.q||"").split(/___/),s=k(`${t.id||"gap"}-${n}`),p=e("input",{type:"text",id:s,style:"padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});x.length>1?(o.appendChild(e("span",{},x[0])),o.appendChild(p),o.appendChild(e("span",{},x.slice(1).join("___")))):(o.appendChild(e("div",{style:"margin-bottom:6px;font-weight:600;"},i.q)),o.appendChild(p)),i.hint&&o.appendChild(_(i.hint)),l.push({row:o,input:p,answers:(i.answer||[]).map(c=>S(c))}),r.appendChild(o)});const u=e("div",{style:"margin-top:8px;font-weight:600;"}),f=e("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏");f.addEventListener("click",()=>{let i=0;l.forEach(({row:n,input:o,answers:x})=>{const s=S(o.value),p=x.includes(s);n.style.borderColor=p?"#10b981":"#ef4444",p&&i++}),u.textContent=`–†–µ–∑—É–ª—å—Ç–∞—Ç: ${i}/${l.length}`}),r.appendChild(f),r.appendChild(u)}function j(r,t){N(r,t,"Match pairs");const l=t.pairs||[],u=$(l.map(o=>o.right)),f=[];l.forEach((o,x)=>{const s=k(`${t.id||"match"}-${x}`),p=e("select",{id:s,style:"padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"},e("option",{value:""},"‚Äî –æ–±–µ—Ä–∏ ‚Äî"),...u.map(a=>e("option",{value:a},a))),c=e("div",{style:"display:flex;align-items:center;gap:10px;margin:8px 0;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"},e("label",{for:s,style:"min-width:160px;font-weight:600;"},o.left),p);f.push({row:c,select:p,right:o.right}),r.appendChild(c)});const i=e("div",{style:"margin-top:8px;font-weight:600;"}),n=e("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏");n.addEventListener("click",()=>{let o=0;f.forEach(({row:x,select:s,right:p})=>{const c=s.value===p;x.style.borderColor=c?"#10b981":"#ef4444",c&&o++}),i.textContent=`–†–µ–∑—É–ª—å—Ç–∞—Ç: ${o}/${f.length}`}),r.appendChild(n),r.appendChild(i)}function Q(r,t){N(r,t,"–ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ —Ç–µ–∫—Å—Ç —Ç–∞ –¥–∞–π—Ç–µ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ");const l=t.context||{},u=String(l.format||"narrative").toLowerCase(),f=Array.isArray(l.body)?l.body:[],i=e("div",{style:"margin:12px 0;padding:14px;border:1px solid #cbd5e1;border-radius:10px;background:#f8fafc;"});l.title&&i.appendChild(e("h4",{style:"margin:0 0 8px;font-size:18px;"},l.title)),u==="dialog"?f.forEach(p=>{if(!p)return;const c=typeof p=="object"&&p.speaker?`${p.speaker}:`:"",a=typeof p=="object"&&"line"in p?p.line:typeof p=="string"?p:"";i.appendChild(e("p",{style:"margin:4px 0;display:flex;gap:6px;align-items:flex-start;line-height:1.5;"},c?e("strong",{},c):null,e("span",{},a)))}):f.forEach((p,c)=>{const a=typeof p=="string"?p:p&&p.text?p.text:"";a&&i.appendChild(e("p",{style:c?"margin:8px 0 0;":"margin:0;"},a))}),r.appendChild(i);const n=Array.isArray(t.questions)?t.questions:[];if(!n.length)return;const o=[];n.forEach((p,c)=>{const a=e("div",{style:"margin-bottom:8px;font-weight:600;"},p.q||`–ü–∏—Ç–∞–Ω–Ω—è ${c+1}`),y=e("div",{style:"margin-bottom:12px;padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"},a),b=Array.isArray(p.answer)?p.answer.map(String):p.answer!=null?[String(p.answer)]:[];if(Array.isArray(p.choices)&&p.choices.length){const g=`${t.id||"context"}-${c}`,C=b.length>1,A=b.every(m=>/^\d+$/.test(m));p.choices.forEach((m,v)=>{const E=k(`${g}-${v}`);y.appendChild(e("label",{for:E,style:"display:flex;align-items:center;gap:8px;margin:4px 0;"},e("input",{type:C?"checkbox":"radio",name:g,id:E,value:String(v)}),e("span",{},m)))}),o.push({block:y,type:"choices",allowMulti:C,getPicked:()=>{const v=Array.from(y.querySelectorAll(`input[name='${g}']`)).filter(E=>E.checked).map(E=>E.value);return A?v:v.map(E=>S(p.choices[Number(E)]||""))},expected:A?b:b.map(m=>S(m))})}else{const g=k(`${t.id||"context-label"}-${c}`);a.setAttribute("id",g);const C=k(`${t.id||"context-text"}-${c}`),A=e("textarea",{id:C,rows:2,style:"width:100%;max-width:640px;padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});A.setAttribute("aria-labelledby",g),y.appendChild(A),o.push({block:y,type:"text",input:A,expected:b.map(m=>S(m))})}p.explanation&&y.appendChild(e("div",{class:"muted",style:"display:none;margin-top:6px;color:#475569;"},p.explanation)),r.appendChild(y)});const x=e("div",{style:"margin-top:8px;font-weight:600;"}),s=e("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏");s.addEventListener("click",()=>{let p=0;o.forEach(c=>{let a=!1;if(c.type==="choices"){const b=c.getPicked().sort(),g=c.expected.slice().sort();a=b.length===g.length&&b.every((C,A)=>C===g[A])}else{const b=S(c.input.value);a=c.expected.length?c.expected.includes(b):!!b}c.block.style.borderColor=a?"#10b981":"#ef4444";const y=c.block.querySelector(".muted");y&&(y.style.display=a?"none":"block"),a&&p++}),x.textContent=`–†–µ–∑—É–ª—å—Ç–∞—Ç: ${p}/${o.length}`}),r.appendChild(s),r.appendChild(x)}function F(r,t,l,u={}){const{showRemove:f=!0}=u,i=l||(t&&t.id?String(t.id):`task-${Math.random().toString(16).slice(2,8)}`),n=e("section",{style:"position:relative;margin:18px 0 26px;","data-task-id":t&&t.id?String(t.id):"","data-task-key":i}),o=e("div",{style:"position:absolute;top:6px;right:6px;display:flex;gap:6px;align-items:center;z-index:5;"}),{button:x,panel:s,unregister:p}=Re({context:t,onShare:({student:y,context:b})=>{const g=window.location.search.slice(8),C=document.querySelector("h1"),A=C?C.textContent:"",m={lessonId:g,userEmail:y.email,lessonName:A,homeworkType:"task",homeworkData:JSON.stringify(b)};return $e(m)}});if(o.appendChild(x),f){const y=e("button",{type:"button",title:"–í–∏–¥–∞–ª–∏—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è","aria-label":"–í–∏–¥–∞–ª–∏—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è",class:"for-admin",style:"border:none;background:transparent;color:#94a3b8;cursor:pointer;padding:2px;line-height:1;font-size:14px;opacity:0.6;",onmouseenter:()=>y.style.opacity="1",onmouseleave:()=>y.style.opacity="0.6",onclick:()=>{De(s)&&H(),document.dispatchEvent(new CustomEvent("practice:taskRemoved",{detail:{key:i,task:t}})),p(),n.remove()}},"‚úï");o.appendChild(y)}n.appendChild(o),n.appendChild(s),t.title&&n.appendChild(e("h3",{},t.title));const c=t&&t.type;switch(String(c||"").trim().toLowerCase()){case"mcq":I(n,t);break;case"gap":q(n,t);break;case"match":j(n,t);break;case"context":Q(n,t);break;case"transform":ae(n,t);break;case"error":le(n,t);break;case"order":de(n,t);break;case"short":pe(n,t);break;case"roleplay":fe(n,t);break;case"dialogue-gap":ue(n,t);break;case"dialogue-order":he(n,t);break;case"truefalse":ge(n,t);break;case"definition-match":{const y={...t,prompt:t.prompt||"–ü–æ—î–¥–Ω–∞–π —Å–ª–æ–≤–æ –∑ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è–º"};j(n,y);break}case"synonym-clue":xe(n,t);break;case"scramble":ye(n,t);break;case"wordpairs":{const y={...t,prompt:t.prompt||"–ü–æ—î–¥–Ω–∞–π —Ñ–æ—Ä–º—É –≤ –æ–¥–Ω–∏–Ω—ñ —Ç–∞ –º–Ω–æ–∂–∏–Ω—ñ"};j(n,y);break}case"odd-one-out":be(n,t);break;case"open":ce(n,t);break;case"writing":me(n,t);break;case"audio":Ce(n,t);break;default:n.appendChild(e("div",{class:"muted"},`–ù–µ–≤—ñ–¥–æ–º–∏–π —Ç–∏–ø –∑–∞–≤–¥–∞–Ω–Ω—è: ${c}`))}return r.appendChild(n),n}function O(r,t={}){const l=te();if(!l||!r)return;const u=l.querySelector("#practice-body")||l,f=t.showRemove!==!1;F(u,r,t.key,{showRemove:f})}function z(r,t,l={}){if(!r)return null;const u=Array.isArray(t)?t.filter(Boolean):[],{title:f,level:i,description:n,keyPrefix:o="inline",showEmptyNote:x=!1,showRemove:s=!1}=l;if(!u.length){if(x){const c=e("p",{class:"muted practice-inline__empty"},"–ü—Ä–∞–∫—Ç–∏–∫–∞ –¥–ª—è —Ü—ñ—î—ó —Ç–µ–º–∏ –ø–æ–∫–∏ –≤—ñ–¥—Å—É—Ç–Ω—è.");r.appendChild(c)}return null}const p=e("section",{class:"practice-inline"});if(f||i||n){const c=e("header",{class:"practice-inline__header"});f&&c.appendChild(e("h3",{class:"practice-inline__title"},f)),i&&c.appendChild(e("span",{class:"practice-inline__badge"},i)),n&&c.appendChild(e("p",{class:"practice-inline__description muted"},n)),p.appendChild(c)}return u.forEach((c,a)=>{const y=`${o}-${a}`;F(p,c,y,{showRemove:s})}),r.appendChild(p),document.dispatchEvent(new CustomEvent("practice:inlineRendered",{detail:{tasks:u,container:r,options:l}})),p}function V(r,t={}){if(!r)return null;const l=document.createDocumentFragment(),u=t.showRemove!==!1;return F(l,r,t.key,{showRemove:u})}async function ee(r){if(!r)return null;const t=h(r);try{const l=await fetch(t,{cache:"no-store"});return l.ok?await l.json():null}catch{return null}}async function se(){const r=document.getElementById("practice-data");if(r)try{return JSON.parse(r.textContent)}catch{return null}const t=window.lessonContext||{},l=new Set;if(t.id&&l.add(`data/practice/${t.id}.json`),t.htmlPath){const f=String(t.htmlPath).replace(/^\.\/?/,"").replace(/\.html?$/i,"");if(f){l.add(`data/practice/${f}.json`);const i=f.split("/"),n=i[i.length-1];n&&l.add(`data/practice/${n}.json`)}}for(const f of l){const i=await ee(f);if(i)return i}const u=w();return u?await ee(u):null}function ae(r,t){N(r,t,"Transform the sentence");const l=[];(t.items||[]).forEach((i,n)=>{const o=e("div",{style:"margin-bottom:10px;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"});o.appendChild(e("div",{style:"margin-bottom:6px;font-weight:600;"},i.q));const x=k(`${t.id||"transform"}-${n}`),s=e("input",{type:"text",id:x,style:"width:100%;max-width:640px;padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});o.appendChild(s),i.hint&&o.appendChild(_(i.hint)),l.push({row:o,input:s,answers:(i.answer||[]).map(p=>S(p))}),r.appendChild(o)});const u=e("div",{style:"margin-top:8px;font-weight:600;"}),f=e("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏");f.addEventListener("click",()=>{let i=0;l.forEach(({row:n,input:o,answers:x})=>{const s=x.includes(S(o.value));n.style.borderColor=s?"#10b981":"#ef4444",s&&i++}),u.textContent=`–†–µ–∑—É–ª—å—Ç–∞—Ç: ${i}/${l.length}`}),r.appendChild(f),r.appendChild(u)}function le(r,t){N(r,t,"Find and correct the error");const l=[];(t.items||[]).forEach((i,n)=>{const o=e("div",{style:"margin-bottom:10px;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"});o.appendChild(e("div",{style:"margin-bottom:6px;font-weight:600;"},i.q));const x=k(`${t.id||"error"}-${n}`),s=e("input",{type:"text",id:x,style:"width:100%;max-width:640px;padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});o.appendChild(s),i.hint&&o.appendChild(_(i.hint)),l.push({row:o,input:s,answers:(i.answer||[]).map(p=>S(p))}),r.appendChild(o)});const u=e("div",{style:"margin-top:8px;font-weight:600;"}),f=e("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏");f.addEventListener("click",()=>{let i=0;l.forEach(({row:n,input:o,answers:x})=>{const s=x.includes(S(o.value));n.style.borderColor=s?"#10b981":"#ef4444",s&&i++}),u.textContent=`–†–µ–∑—É–ª—å—Ç–∞—Ç: ${i}/${l.length}`}),r.appendChild(f),r.appendChild(u)}function de(r,t){N(r,t,"Put the words in order");const l=[];(t.items||[]).forEach((i,n)=>{const o=S(Array.isArray(i.answer)?i.answer.join(" "):i.answer),x=$((i.tokens||[]).slice()),s=e("div",{style:"margin:10px 0;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"}),p=e("div",{style:"display:flex;flex-wrap:wrap;gap:6px;margin-bottom:6px;"}),c=e("div",{style:"display:flex;flex-wrap:wrap;gap:6px;min-height:36px;padding:6px;border:1px dashed #cbd5e1;border-radius:8px;background:#f8fafc;"}),a=new Set;function y(C,A){const m=e("button",{type:"button",style:"padding:4px 8px;border:1px solid #cbd5e1;border-radius:6px;background:#fff;cursor:pointer;"},C);return m.addEventListener("click",()=>{a.has(A)||(a.add(A),m.style.opacity=.5,c.appendChild(e("span",{class:"chip",style:"padding:4px 8px;border:1px solid #cbd5e1;border-radius:6px;background:#fff;"},C)))}),m}x.forEach((C,A)=>p.appendChild(y(C,`${n}-${A}`)));const b=e("div",{style:"margin-top:6px;display:flex;gap:8px;"}),g=e("button",{type:"button",class:"btn"},"–°–∫–∏–Ω—É—Ç–∏");g.addEventListener("click",()=>{a.clear(),c.innerHTML="",Array.from(p.children).forEach(C=>C.style.opacity=1),s.style.borderColor="#e5e7eb"}),b.appendChild(g),s.appendChild(e("div",{style:"margin-bottom:6px;font-weight:600;"},i.q||"")),s.appendChild(p),s.appendChild(c),s.appendChild(b),l.push({row:s,outWrap:c,correctStr:o}),r.appendChild(s)});const u=e("div",{style:"margin-top:8px;font-weight:600;"}),f=e("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏");f.addEventListener("click",()=>{let i=0;l.forEach(({row:n,outWrap:o,correctStr:x})=>{const p=S(Array.from(o.querySelectorAll(".chip")).map(c=>c.textContent).join(" "))===x;n.style.borderColor=p?"#10b981":"#ef4444",p&&i++}),u.textContent=`–†–µ–∑—É–ª—å—Ç–∞—Ç: ${i}/${l.length}`}),r.appendChild(f),r.appendChild(u)}function pe(r,t){N(r,t,"Short answer");const l=[];(t.items||[]).forEach((i,n)=>{const o=e("div",{style:"margin-bottom:10px;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"}),x=e("div",{style:"margin-bottom:6px;font-weight:600;"},i.q);o.appendChild(x);const s=k(`${t.id||"short-label"}-${n}`);x.setAttribute("id",s);const p=k(`${t.id||"short-text"}-${n}`),c=e("textarea",{id:p,rows:3,style:"width:100%;max-width:720px;padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});c.setAttribute("aria-labelledby",s),o.appendChild(c),l.push({row:o,input:c,keywords:(i.keywords||[]).map(a=>S(a))}),r.appendChild(o)});const u=e("div",{style:"margin-top:8px;font-weight:600;"}),f=e("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏");f.addEventListener("click",()=>{let i=0,n=0;l.forEach(({row:o,input:x,keywords:s})=>{const p=S(x.value),c=s.filter(y=>p.includes(y)).length;i+=c,n+=s.length,o.style.borderColor=c===s.length?"#10b981":c>0?"#f59e0b":"#ef4444";const a=o.querySelector(".short-info")||e("div",{class:"short-info",style:"margin-top:6px;color:#475569;"});a.textContent=`–ó–±—ñ–≥–∏ –∫–ª—é—á–æ–≤–∏—Ö —Å–ª—ñ–≤: ${c}/${s.length}`,o.contains(a)||o.appendChild(a)}),u.textContent=`–ó–∞–≥–∞–ª—å–Ω–∏–π –∑–±—ñ–≥ –∫–ª—é—á–æ–≤–∏—Ö —Å–ª—ñ–≤: ${i}/${n}`}),r.appendChild(f),r.appendChild(u)}function ce(r,t){N(r,t,"–í—ñ–¥–ø–æ–≤—ñ–¥—ñ —É –≤—ñ–ª—å–Ω—ñ–π —Ñ–æ—Ä–º—ñ");const l=Array.isArray(t&&t.items)?t.items.filter(Boolean):[];if(l.length){const f=e("div",{style:"display:flex;flex-direction:column;gap:12px;margin-top:12px;"});l.forEach((i,n)=>{const o=e("div",{style:"padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"}),x=i&&(i.situation||i.prompt||i.q)||`–°–∏—Ç—É–∞—Ü—ñ—è ${n+1}`;o.appendChild(e("div",{style:"margin:0 0 6px;font-weight:600;color:#0f172a;"},x));const s=i&&Array.isArray(i.example_answers)?i.example_answers.filter(Boolean):[];if(s.length){o.appendChild(e("div",{class:"muted",style:"margin:0 0 6px;color:#64748b;"},"–ü—Ä–∏–∫–ª–∞–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ:"));const p=e("div",{style:"display:flex;flex-wrap:wrap;gap:8px;"});s.forEach(c=>{p.appendChild(e("span",{style:"display:inline-flex;align-items:center;padding:4px 10px;border-radius:9999px;background:#e2e8f0;color:#0f172a;font-size:14px;"},c))}),o.appendChild(p)}f.appendChild(o)}),r.appendChild(f)}const u=t&&t.scoring&&Array.isArray(t.scoring.criteria)?t.scoring.criteria.filter(Boolean):[];if(u.length){const f=e("div",{style:"margin-top:16px;padding:14px;border:1px dashed #cbd5e1;border-radius:10px;background:#f8fafc;"});f.appendChild(e("h4",{style:"margin:0 0 8px;font-size:16px;font-weight:600;color:#0f172a;"},"–ö—Ä–∏—Ç–µ—Ä—ñ—ó –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è"));const i=e("ul",{style:"margin:0;padding-left:18px;color:#475569;"});u.forEach(n=>{i.appendChild(e("li",{style:"margin:4px 0;"},n))}),f.appendChild(i),r.appendChild(f)}}function fe(r,t){N(r,t,"Role-play scenario");const l=t&&typeof t.scenario=="object"?t.scenario:{},u=e("div",{style:"margin:12px 0;padding:14px;border:1px solid #cbd5e1;border-radius:10px;background:#f8fafc;"});let f=!1;l.setting&&(u.appendChild(e("p",{style:"margin:0 0 6px;font-weight:600;"},`–õ–æ–∫–∞—Ü—ñ—è: ${l.setting}`)),f=!0),l.summary&&(u.appendChild(e("p",{style:"margin:0;color:#334155;"},l.summary)),f=!0),f&&r.appendChild(u);const i=Array.isArray(l.roles)?l.roles:[];if(i.length){const x=e("div",{style:"display:grid;gap:12px;margin-top:12px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));"});i.forEach((s,p)=>{const c=s&&s.name||`Student ${p+1}`,a=e("div",{style:"padding:14px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;box-shadow:0 1px 0 rgba(148, 163, 184, 0.2);"},e("div",{style:"font-weight:600;margin-bottom:6px;"},c));s&&s.goal&&a.appendChild(e("p",{style:"margin:0 0 6px;color:#0f172a;"},`–ú–µ—Ç–∞: ${s.goal}`));const b=(s&&Array.isArray(s.details)?s.details:typeof(s==null?void 0:s.details)=="string"?s.details.split(/[;,\n]/):[]).map(g=>String(g||"").trim()).filter(Boolean);if(b.length===1)a.appendChild(e("p",{style:"margin:0;color:#475569;"},b[0]));else if(b.length>1){const g=e("ul",{style:"margin:0;padding-left:18px;color:#475569;"});b.forEach(C=>{g.appendChild(e("li",{style:"margin:2px 0;"},C))}),a.appendChild(g)}x.appendChild(a)}),r.appendChild(x)}const n=Array.isArray(l.steps)?l.steps:[];if(n.length){const x=e("div",{style:"margin-top:16px;padding:14px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"});x.appendChild(e("h4",{style:"margin:0 0 6px;font-size:16px;font-weight:600;color:#0f172a;"},"–ü–æ–∫—Ä–æ–∫–æ–≤–∏–π –ø–ª–∞–Ω –¥—ñ–∞–ª–æ–≥—É"));const s=e("ol",{style:"margin:0 0 0 18px;padding:0;color:#475569;"});n.forEach(p=>{p&&s.appendChild(e("li",{style:"margin:4px 0;"},p))}),x.appendChild(s),r.appendChild(x)}const o=Array.isArray(t&&t.phrases)?t.phrases:[];if(o.length){r.appendChild(e("h4",{style:"margin:18px 0 8px;font-size:16px;font-weight:600;color:#0f172a;"},"–ö–æ—Ä–∏—Å–Ω—ñ —Ñ—Ä–∞–∑–∏ –¥–ª—è –¥—ñ–∞–ª–æ–≥—É"));const x=e("div",{style:"display:flex;flex-direction:column;gap:8px;"});o.forEach((s,p)=>{const c=typeof s=="string"?s:s&&(s.phrase||s.text||s.value||""),a=s&&typeof s=="object"&&(s.translation||s.note||s.ua||s.uk)||"";if(!c)return;const y=k(`phrase-${p}`);x.appendChild(e("label",{for:y,style:"display:flex;gap:10px;align-items:flex-start;padding:10px 12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"},e("input",{id:y,type:"checkbox",style:"margin-top:4px;"}),e("div",{},e("span",{style:"font-weight:600;color:#0f172a;"},c),a?e("span",{class:"muted",style:"display:block;margin-top:4px;color:#475569;"},a):null)))}),r.appendChild(x)}}function ue(r,t){N(r,t,"–ó–∞–ø–æ–≤–Ω—ñ—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏ —É –¥—ñ–∞–ª–æ–∑—ñ");const l=Array.isArray(t==null?void 0:t.answers)?t.answers.map(m=>S(m)):[],u=[];let f=null;function i(m){f&&f!==m&&(f.style.boxShadow="none"),m&&f!==m?(m.style.boxShadow="0 0 0 2px rgba(37, 99, 235, 0.35)",f=m):(m&&(m.style.boxShadow="none"),f=null)}function n(m){m&&(m.dataset.value="",m.textContent="___",m.style.borderColor="#cbd5e1",m.style.background="#fff",m.style.boxShadow="none")}const o=e("div",{style:"display:flex;flex-wrap:wrap;gap:8px;margin:12px 0;padding:10px;border:1px solid #e2e8f0;border-radius:10px;background:#f8fafc;"}),x=Array.isArray(t==null?void 0:t.words)?t.words:[],s=new Set,p=[];x.forEach(m=>{const v=String(m||"").trim();if(!v)return;const E=S(v);s.has(E)||(s.add(E),p.push(v))}),p.forEach(m=>{const v=e("button",{type:"button",class:"btn",style:"padding:6px 10px;border:1px solid #94a3b8;border-radius:999px;background:#fff;color:#0f172a;cursor:pointer;font-size:14px;line-height:1;",onclick:()=>{const E=f||u.find(T=>!T.dataset.value);E&&(E.dataset.value=m,E.textContent=m,E.style.borderColor="#2563eb",E.style.background="#eef2ff",i(null))}},m);v.dataset.word=m,o.appendChild(v)}),o.children.length&&r.appendChild(o);const c=e("div",{style:"display:flex;flex-direction:column;gap:10px;"}),a=Array.isArray(t==null?void 0:t.dialogue)?t.dialogue:[];let y=0;a.forEach(m=>{if(!m)return;const v=m.speaker||m.role||"",E=m.line||m.text||"",T=e("div",{style:"padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;display:flex;gap:10px;align-items:flex-start;"},v?e("strong",{style:"min-width:90px;"},`${v}:`):null),P=e("div",{style:"display:flex;flex-wrap:wrap;gap:6px;align-items:center;"}),U=String(E||"").split(/___/);U.forEach((R,Se)=>{if(R&&P.appendChild(e("span",{},R)),Se<U.length-1){const Ae=l[y]||"",D=e("button",{type:"button",style:"min-width:52px;padding:4px 10px;border:1px solid #cbd5e1;border-radius:8px;background:#fff;color:#0f172a;cursor:pointer;",onclick:()=>{if(D.dataset.value){n(D),i(D);return}i(f===D?null:D)},ondblclick:()=>{n(D),i(null)}},"___");D.dataset.expected=Ae,D.dataset.index=String(y),u.push(D),y+=1,P.appendChild(D)}}),T.appendChild(P),c.appendChild(T)}),r.appendChild(c);const b=e("div",{style:"margin-top:14px;display:flex;gap:10px;flex-wrap:wrap;align-items:center;"}),g=e("button",{type:"button",class:"btn primary"},"–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏"),C=e("button",{type:"button",class:"btn"},"–°–∫–∏–Ω—É—Ç–∏"),A=e("div",{style:"font-weight:600;color:#0f172a;"});g.addEventListener("click",()=>{let m=0;u.forEach(v=>{const E=v.dataset.expected||"",T=S(v.dataset.value||v.textContent||""),P=E?T===E:!!T;v.style.borderColor=P?"#10b981":"#ef4444",v.style.background=P?"#ecfdf5":"#fee2e2",P&&(m+=1)}),u.length?A.textContent=`–†–µ–∑—É–ª—å—Ç–∞—Ç: ${m}/${u.length}`:A.textContent=""}),C.addEventListener("click",()=>{u.forEach(m=>n(m)),A.textContent="",i(null)}),b.appendChild(g),b.appendChild(C),b.appendChild(A),r.appendChild(b)}function he(r,t){N(r,t,"–£–ø–æ—Ä—è–¥–∫—É–π—Ç–µ –¥—ñ–∞–ª–æ–≥");const l=Array.isArray(t==null?void 0:t.lines)?t.lines.map(g=>({speaker:(g==null?void 0:g.speaker)||(g==null?void 0:g.role)||"",text:(g==null?void 0:g.line)||(g==null?void 0:g.text)||""})):[],u=Array.isArray(t==null?void 0:t.solution)?t.solution.map(g=>Number.parseInt(g,10)):l.map((g,C)=>C),f=e("div",{style:"display:flex;flex-direction:column;gap:8px;margin-top:10px;padding:10px;border:1px solid #e2e8f0;border-radius:10px;background:#f8fafc;"}),i=e("div",{style:"margin-top:14px;padding:12px;border:1px dashed #cbd5e1;border-radius:10px;min-height:80px;display:flex;flex-direction:column;gap:8px;"}),n=new Set;function o({speaker:g,text:C}){return(g?`${g}: ${C}`:C).trim()}function x(g){if(!g)return;const C=Number.parseInt(g.dataset.index||"-1",10),A=g.dataset.buttonId;if(A){const m=f.querySelector(`[data-id="${A}"]`);m&&(m.disabled=!1,m.style.opacity="1")}n.delete(C),g.remove()}function s(g,C,A){const m=e("div",{class:"dialogue-chip",style:"padding:10px;border:1px solid #94a3b8;border-radius:10px;background:#fff;display:flex;justify-content:space-between;align-items:center;gap:12px;cursor:pointer;",onclick:v=>{v.stopPropagation(),x(m)}},e("span",{},C),e("span",{style:"color:#94a3b8;font-size:12px;"},"√ó"));m.dataset.index=String(g),m.dataset.buttonId=A,i.appendChild(m)}$(l.map((g,C)=>C)).forEach(g=>{const C=l[g],A=o(C),m=`line-${g}-${Math.random().toString(36).slice(2,6)}`,v=e("button",{type:"button",class:"btn",style:"text-align:left;padding:10px;border:1px solid #cbd5e1;border-radius:10px;background:#fff;color:#0f172a;cursor:pointer;",onclick:()=>{n.has(g)||(n.add(g),v.disabled=!0,v.style.opacity="0.5",s(g,A,m))},"data-id":m},A);f.appendChild(v)}),r.appendChild(f),r.appendChild(i);const c=e("div",{style:"margin-top:14px;display:flex;gap:10px;flex-wrap:wrap;align-items:center;"}),a=e("button",{type:"button",class:"btn primary"},"–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏"),y=e("button",{type:"button",class:"btn"},"–°–∫–∏–Ω—É—Ç–∏"),b=e("div",{style:"font-weight:600;color:#0f172a;"});a.addEventListener("click",()=>{const g=Array.from(i.children).map(m=>Number.parseInt(m.dataset.index||"-1",10)),C=u.slice(),A=g.length===C.length&&g.every((m,v)=>m===C[v]);i.style.borderColor=A?"#10b981":"#ef4444",b.textContent=A?"–î—ñ–∞–ª–æ–≥ –≤–ø–æ—Ä—è–¥–∫–æ–≤–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ!":`–ü–æ—Ç–æ—á–Ω–∏–π –ø–æ—Ä—è–¥–æ–∫: ${g.length}/${C.length} —Ä–µ–ø–ª—ñ–∫. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å.`}),y.addEventListener("click",()=>{Array.from(i.children).forEach(C=>x(C)),f.querySelectorAll("button").forEach(C=>{C.disabled=!1,C.style.opacity="1"}),n.clear(),i.style.borderColor="#cbd5e1",b.textContent=""}),c.appendChild(a),c.appendChild(y),c.appendChild(b),r.appendChild(c)}function ge(r,t){N(r,t,"–û–±–µ—Ä–∏ True –∞–±–æ False");const l=[];if((Array.isArray(t==null?void 0:t.items)?t.items:[]).forEach((o,x)=>{if(!o||!o.statement)return;const s=e("div",{style:"margin:8px 0;padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"},e("p",{style:"margin:0 0 8px;font-weight:600;"},o.statement)),p=`${t.id||"tf"}-${x}`,c=!!o.answer,a=k(`${p}-true`),y=e("label",{for:a,style:"display:inline-flex;align-items:center;gap:6px;margin-right:16px;"},e("input",{type:"radio",name:p,value:"true",id:a}),"True"),b=k(`${p}-false`),g=e("label",{for:b,style:"display:inline-flex;align-items:center;gap:6px;"},e("input",{type:"radio",name:p,value:"false",id:b}),"False"),C=e("div",{style:"display:flex;align-items:center;"});C.appendChild(y),C.appendChild(g),s.appendChild(C),l.push({row:s,name:p,expected:c}),r.appendChild(s)}),!l.length)return;const f=e("div",{style:"margin-top:14px;display:flex;gap:10px;align-items:center;flex-wrap:wrap;"}),i=e("button",{type:"button",class:"btn primary"},"–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏"),n=e("div",{style:"font-weight:600;color:#0f172a;"});i.addEventListener("click",()=>{let o=0;l.forEach(({row:x,name:s,expected:p})=>{const c=x.querySelector(`input[name="${s}"]:checked`),a=c?c.value===String(p):!1;x.style.borderColor=a?"#10b981":"#ef4444",a&&(o+=1)}),n.textContent=`–†–µ–∑—É–ª—å—Ç–∞—Ç: ${o}/${l.length}`}),f.appendChild(i),f.appendChild(n),r.appendChild(f)}function xe(r,t){N(r,t,"–î–æ–±–µ—Ä—ñ—Ç—å —Å–ª–æ–≤–æ –∑–∞ –æ–ø–∏—Å–æ–º");const l=Array.isArray(t==null?void 0:t.wordBank)?t.wordBank:[];if(l.length){const o=e("div",{style:"margin:8px 0 12px;padding:10px;border:1px solid #e2e8f0;border-radius:10px;background:#f8fafc;display:flex;flex-wrap:wrap;gap:8px;"});l.forEach(x=>{const s=String(x||"").trim();s&&o.appendChild(e("span",{style:"padding:6px 10px;border:1px solid #94a3b8;border-radius:999px;background:#fff;font-size:14px;"},s))}),r.appendChild(o)}const u=[];if((Array.isArray(t==null?void 0:t.items)?t.items:[]).forEach((o,x)=>{if(!o||!o.clue)return;const s=e("div",{style:"margin-bottom:10px;padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"});s.appendChild(e("p",{style:"margin:0 0 6px;font-weight:600;"},o.clue));const p=k(`${t.id||"synonym"}-${x}`),c=e("input",{type:"text",id:p,style:"width:100%;max-width:320px;padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});s.appendChild(c);const a=Array.isArray(o==null?void 0:o.answers)?o.answers.map(y=>S(y)):Array.isArray(o==null?void 0:o.answer)?o.answer.map(y=>S(y)):o!=null&&o.answer?[S(o.answer)]:[];u.push({row:s,input:c,answers:a}),r.appendChild(s)}),!u.length)return;const i=e("div",{style:"font-weight:600;color:#0f172a;"}),n=e("button",{type:"button",class:"btn primary"},"–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏");n.addEventListener("click",()=>{let o=0;u.forEach(({row:x,input:s,answers:p})=>{const c=S(s.value),a=p.length?p.includes(c):!!c;x.style.borderColor=a?"#10b981":"#ef4444",a&&(o+=1)}),i.textContent=`–†–µ–∑—É–ª—å—Ç–∞—Ç: ${o}/${u.length}`}),r.appendChild(n),r.appendChild(i)}function ye(r,t){N(r,t,"–†–æ–∑—à–∏—Ñ—Ä—É–π—Ç–µ —Å–ª–æ–≤–∞");const l=[];if((Array.isArray(t==null?void 0:t.items)?t.items:[]).forEach((n,o)=>{if(!n||!n.scrambled)return;const x=e("div",{style:"margin-bottom:10px;padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"});x.appendChild(e("div",{style:"margin-bottom:6px;font-weight:600;"},n.scrambled));const s=k(`${t.id||"scramble"}-${o}`),p=e("input",{type:"text",id:s,style:"width:100%;max-width:260px;padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});x.appendChild(p);const c=Array.isArray(n==null?void 0:n.answers)?n.answers.map(a=>S(a)):Array.isArray(n==null?void 0:n.answer)?n.answer.map(a=>S(a)):n!=null&&n.answer?[S(n.answer)]:[];l.push({row:x,input:p,answers:c}),r.appendChild(x)}),!l.length)return;const f=e("button",{type:"button",class:"btn primary"},"–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏"),i=e("div",{style:"margin-top:6px;font-weight:600;color:#0f172a;"});f.addEventListener("click",()=>{let n=0;l.forEach(({row:o,input:x,answers:s})=>{const p=S(x.value),c=s.length?s.includes(p):!!p;o.style.borderColor=c?"#10b981":"#ef4444",c&&(n+=1)}),i.textContent=`–†–µ–∑—É–ª—å—Ç–∞—Ç: ${n}/${l.length}`}),r.appendChild(f),r.appendChild(i)}function be(r,t){N(r,t,"–ó–Ω–∞–π–¥–∏ –∑–∞–π–≤–µ —Å–ª–æ–≤–æ");const l=[];if((Array.isArray(t==null?void 0:t.items)?t.items:[]).forEach((n,o)=>{const x=Array.isArray(n==null?void 0:n.options)?n.options:[];if(!x.length)return;const s=e("div",{style:"margin-bottom:10px;padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"});s.appendChild(e("div",{style:"margin-bottom:6px;font-weight:600;"},`–ù–∞–±—ñ—Ä ${o+1}`));const p=`${t.id||"odd"}-${o}`;x.forEach((y,b)=>{const g=k(`${p}-${b}`);s.appendChild(e("label",{for:g,style:"display:flex;align-items:center;gap:6px;margin:4px 0;"},e("input",{type:"radio",name:p,value:String(b),id:g}),y))});const c=String((n==null?void 0:n.explanation)||"").trim();if(c){const y=e("div",{class:"muted",style:"display:none;margin-top:6px;color:#475569;"});y.textContent=`–ü–æ—è—Å–Ω–µ–Ω–Ω—è: ${c}`,s.appendChild(y)}const a=S((n==null?void 0:n.answer)||"");l.push({row:s,groupName:p,answerIndex:a}),r.appendChild(s)}),!l.length)return;const f=e("button",{type:"button",class:"btn primary"},"–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏"),i=e("div",{style:"margin-top:6px;font-weight:600;color:#0f172a;"});f.addEventListener("click",()=>{let n=0;l.forEach(({row:o,groupName:x,answerIndex:s})=>{const p=o.querySelector(`input[name="${x}"]:checked`),c=S(p?p.value:""),a=s?c===s:!!c;o.style.borderColor=a?"#10b981":"#ef4444";const y=o.querySelector(".muted");y&&(y.style.display=a?"none":"block"),a&&(n+=1)}),i.textContent=`–†–µ–∑—É–ª—å—Ç–∞—Ç: ${n}/${l.length}`}),r.appendChild(f),r.appendChild(i)}function me(r,t){N(r,t,"Writing/Speaking prompt"),t.description&&r.appendChild(e("p",{class:"muted"},t.description));const l=e("div",{style:"margin-top:8px;"});(t.checklist||[]).forEach((i,n)=>{const o=k(`${t.id||"check"}-${n}`),x=e("label",{for:o,style:"display:flex;align-items:center;gap:8px;margin:6px 0;"},e("input",{id:o,type:"checkbox"}),e("span",{},i));l.appendChild(x)}),r.appendChild(l);const u=e("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"–ü–æ–∑–Ω–∞—á–∏—Ç–∏ —è–∫ –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ"),f=e("div",{class:"muted",style:"margin-top:6px;"});u.addEventListener("click",()=>{f.textContent="–ì–æ—Ç–æ–≤–æ! –ü–µ—Ä–µ–≤—ñ—Ä —Å–ø–∏—Å–æ–∫ —ñ –∑–∞ –±–∞–∂–∞–Ω–Ω—è–º –≤—ñ–¥–ø—Ä–∞–≤ –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫—É."}),r.appendChild(u),r.appendChild(f)}function Ce(r,t){N(r,t,"Audio task");const l=[],u=a=>{if(!a)return;if(Array.isArray(a)){a.forEach(u);return}const y=String(a).trim();y&&l.push(y)};u(t.audioSrc),u(t.audioUrl),u(t.audio),u(t.source),u(t.sources);const f=Array.from(new Set(l));if(f.length){const a=e("div",{style:"margin-top:8px;padding:12px;border:1px solid #cbd5e1;border-radius:10px;background:#f1f5f9;"}),y=e("audio",{controls:!0,style:"width:100%;display:block;"});f.forEach(b=>{y.appendChild(e("source",{src:h(b)}))}),y.appendChild(document.createTextNode("–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î –≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞—É–¥—ñ–æ.")),a.appendChild(y),r.appendChild(a)}const i=Array.isArray(t.dialogs)?t.dialogs:[],n=[];if(i.forEach(a=>{if(a){if(typeof a=="string"){const y=a.trim();y&&n.push({text:y});return}if(typeof a=="object"){const y="text"in a?String(a.text||"").trim():"";if(!y)return;const b={text:y};a.voice&&(b.voice=a.voice),a.voiceName&&(b.voiceName=a.voiceName),a.gender&&(b.gender=a.gender),a.lang&&(b.lang=a.lang),a.rate!=null&&(b.rate=a.rate),a.pitch!=null&&(b.pitch=a.pitch),a.volume!=null&&(b.volume=a.volume),a.ttsOptions&&typeof a.ttsOptions=="object"&&(b.ttsOptions={...a.ttsOptions}),n.push(b)}}}),!n.length){if(Array.isArray(t.text))t.text.map(a=>String(a||"").trim()).filter(Boolean).forEach(a=>n.push({text:a}));else if(typeof t.text=="string"){const a=String(t.text||"").trim();a&&n.push({text:a})}}const o=typeof window<"u"&&"speechSynthesis"in window?window.speechSynthesis:null,x={};if(t.lang&&(x.lang=t.lang),t.voiceName&&(x.voiceName=t.voiceName),t.voice&&(x.voice=t.voice),t.gender&&(x.gender=t.gender),typeof t.ttsOptions=="object"&&t.ttsOptions&&Object.assign(x,t.ttsOptions),typeof t.voiceOptions=="object"&&t.voiceOptions&&Object.assign(x,t.voiceOptions),typeof t.speechOptions=="object"&&t.speechOptions&&Object.assign(x,t.speechOptions),n.length&&o){const a=e("div",{style:"margin-top:8px;display:flex;align-items:center;gap:10px;flex-wrap:wrap;"}),y=e("button",{type:"button",class:"btn primary",style:"padding:8px 14px;border-radius:8px;border:1px solid #0284c7;background:#0ea5e9;color:#fff;cursor:pointer;display:inline-flex;align-items:center;gap:6px;"},"‚ñ∂ Play");y.setAttribute("aria-pressed","false");let b=!1,g=0,C=null;const A=()=>{b=!1,g=0,C&&(C.onend=null,C.onerror=null,C=null),y.textContent="‚ñ∂ Play",y.setAttribute("aria-pressed","false")},m=async()=>{if(!b||g>=n.length){A();return}const v=n[g],E={...x};v.lang&&(E.lang=v.lang),v.voiceName&&(E.voiceName=v.voiceName),v.voice&&(E.voice=v.voice),v.gender&&(E.gender=v.gender),v.rate!=null&&(E.rate=v.rate),v.pitch!=null&&(E.pitch=v.pitch),v.volume!=null&&(E.volume=v.volume),v.ttsOptions&&typeof v.ttsOptions=="object"&&v.ttsOptions&&Object.assign(E,v.ttsOptions);try{const T=await oe(v.text,E);if(!T){g+=1,m();return}C=T,T.onend=()=>{b&&(C=null,g+=1,m())},T.onerror=A}catch{A()}};y.addEventListener("click",()=>{if(b)o&&o.cancel(),A();else{if(!n.length)return;b=!0,g=0,y.textContent="‚èπ Stop",y.setAttribute("aria-pressed","true"),m()}}),a.appendChild(y),f.length||a.appendChild(e("span",{class:"muted",style:"font-size:14px;"},"–ü—Ä–æ—Å–ª—É—Ö–∞–π—Ç–µ –¥—ñ–∞–ª–æ–≥ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–∏–Ω—Ç–µ–∑—É –º–æ–≤–ª–µ–Ω–Ω—è.")),r.appendChild(a)}else!f.length&&n.length&&r.appendChild(e("p",{class:"muted",style:"margin-top:8px;"},"–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î —Å–∏–Ω—Ç–µ–∑ –º–æ–≤–ª–µ–Ω–Ω—è."));const s=Array.isArray(t.questions)?t.questions.filter(Boolean):[];if(!s.length)return;const p=e("div",{style:"margin-top:16px;"}),c=[];if(s.forEach((a,y)=>{const b=typeof a=="string"?{prompt:a}:a&&typeof a=="object"?a:{prompt:String(a)},g=b.prompt||b.q||`Question ${y+1}`,C=e("div",{style:"margin-bottom:12px;padding:12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;"},e("div",{style:"font-weight:600;margin-bottom:8px;"},g));if(b.hint&&C.appendChild(_(b.hint)),Array.isArray(b.choices)&&b.choices.length){const m=(Array.isArray(b.answer)?b.answer:b.answer!=null?[b.answer]:[]).map(P=>String(P)),v=m.length>1,E=m.every(P=>/^\d+$/.test(P)),T=k(`${t.id||"audio"}-${y}`);b.choices.forEach((P,U)=>{const R=k(`${T}-${U}`);C.appendChild(e("label",{for:R,style:"display:flex;align-items:center;gap:8px;margin:4px 0;"},e("input",{type:v?"checkbox":"radio",name:T,id:R,value:String(U)}),e("span",{},P)))}),m.length&&c.push({type:"choices",block:C,getPicked:()=>{const U=Array.from(C.querySelectorAll(`input[name='${T}']`)).filter(R=>R.checked).map(R=>R.value);return E?U:U.map(R=>S(b.choices[Number(R)]||""))},expected:E?m.slice():m.map(P=>S(P))})}else{const A=e("textarea",{rows:b.rows||2,style:"width:100%;max-width:640px;padding:6px 8px;border:1px solid #cbd5e1;border-radius:6px;"});C.appendChild(A);const v=(Array.isArray(b.answer)?b.answer:b.answer!=null?[b.answer]:Array.isArray(b.answers)?b.answers:[]).map(E=>S(E)).filter(Boolean);v.length&&c.push({type:"text",block:C,input:A,expected:v})}p.appendChild(C)}),c.length){const a=e("div",{style:"margin-top:8px;font-weight:600;"}),y=e("button",{type:"button",class:"btn primary",style:"margin-top:8px;"},"–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏");y.addEventListener("click",()=>{let b=0;c.forEach(g=>{if(g.type==="choices"){const C=g.getPicked().sort(),A=g.expected.slice().sort(),m=C.length===A.length&&C.every((v,E)=>v===A[E]);g.block.style.borderColor=m?"#10b981":"#ef4444",m&&b++}else if(g.type==="text"){const C=S(g.input.value),A=g.expected.includes(C);g.block.style.borderColor=A?"#10b981":"#ef4444",A&&b++}}),a.textContent=`–†–µ–∑—É–ª—å—Ç–∞—Ç: ${b}/${c.length}`}),p.appendChild(y),p.appendChild(a)}else p.appendChild(e("p",{class:"muted",style:"margin-top:4px;"},"–ó–∞–ø–∏—à—ñ—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ ‚Äî –≤–∏–∫–ª–∞–¥–∞—á –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç—å —ó—Ö –ø—ñ–∑–Ω—ñ—à–µ."));r.appendChild(p)}function te(){let r=document.getElementById("practice");if(!r&&/\/grammar\//.test(location.pathname)){const t=e("div",{class:"container"});t.appendChild(e("hr",{class:"sep"})),r=e("section",{id:"practice"}),t.appendChild(r),document.body.appendChild(t)}return r}function we(){return e("input",{type:"checkbox",class:"check-task-status"})}function N(r,t,l){r.appendChild(e("h3",{},we(),t.prompt||l))}function ve(){const r=te();if(!r)return;let t=r.querySelector("#practice-body");if(t||(t=e("div",{id:"practice-body"}),r.appendChild(t)),(window.lessonContext||{}).isCustomLesson){const u=r.querySelector("[data-practice-placeholder]");u&&(u.textContent="–ü—Ä–∞–∫—Ç–∏–∫–∞ –¥–ª—è –∫–æ–∂–Ω–æ—ó —Ç–µ–º–∏ —Ä–æ–∑–º—ñ—â–µ–Ω–∞ –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è —Ç–µ–æ—Ä—ñ—ó. –¢—É—Ç –º–æ–∂–µ—Ç–µ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –∑–∞–≤–¥–∞–Ω–Ω—è."),t&&(t.innerHTML='<p class="muted">–ó–≥–µ–Ω–µ—Ä—É–π—Ç–µ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –≤–ø—Ä–∞–≤–∏ –∞–±–æ –¥–æ–¥–∞–π—Ç–µ –≤–ª–∞—Å–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è.</p>'),document.dispatchEvent(new CustomEvent("practice:dataLoaded",{detail:null})),document.dispatchEvent(new CustomEvent("practice:rendered",{detail:{ok:!1,reason:"custom-lesson"}}));return}se().then(u=>{if(!u){document.dispatchEvent(new CustomEvent("practice:dataLoaded",{detail:null})),t.innerHTML='<p class="muted">–ü—Ä–∞–∫—Ç–∏–∫–∞ –ø–æ–∫–∏ –≤—ñ–¥—Å—É—Ç–Ω—è.</p>',document.dispatchEvent(new CustomEvent("practice:rendered",{detail:{ok:!1}}));return}t.innerHTML="";const f=e("div",{},e("h2",{},"Practice ",e("span",{class:"badge"},u.level||"B1")),u.title?e("p",{class:"muted"},u.title):null);t.appendChild(f);const i=(u.tasks||[]).map((n,o)=>({key:n&&n.id?String(n.id):`base-${o}`,task:n}));document.dispatchEvent(new CustomEvent("practice:dataLoaded",{detail:{title:u.title,level:u.level,entries:i}})),i.forEach(({task:n,key:o})=>F(t,n,o)),document.dispatchEvent(new CustomEvent("practice:rendered",{detail:{ok:!0}}))})}return(typeof window<"u"&&window.practiceConfig||{}).disableAutoInit||document.addEventListener("DOMContentLoaded",ve),window.practice=window.practice||{},Object.assign(window.practice,{appendTask:O,renderTaskList:z,createTaskElement:V}),{appendTask:O,renderTaskList:z,createTaskElement:V}}(),Xe=ie.createTaskElement,Ye=ie.renderTaskList;document.addEventListener("click",d=>{const h=d.target.closest(".text-block");if(h){const w=h.innerHTML;navigator.clipboard.writeText(`<div class="text-block">${w}</div>`),console.log("–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ")}});export{Qe as a,Ge as b,Xe as c,Re as d,$e as e,H as f,Ee as g,Ke as h,De as i,Je as j,Ye as r,Be as s};
//# sourceMappingURL=practice-DlrnslFQ.js.map
