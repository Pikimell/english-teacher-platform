{"version":3,"file":"custom-lessons.js","sources":["../src/scripts/custom-lessons.js"],"sourcesContent":["import { lessons } from '../data/lessons.js';\nimport {\n  loadCustomLessons,\n  createCustomLesson,\n  deleteCustomLesson,\n  subscribeToStorage,\n} from './custom-lessons-store.js';\n\nconst form = document.querySelector('[data-builder-form]');\nconst statusElement = document.querySelector('[data-builder-status]');\nconst savedListElement = document.querySelector('[data-saved-list]');\nconst savedEmptyElement = document.querySelector('[data-saved-empty]');\n\nconst groups = Array.from(document.querySelectorAll('[data-builder-group]'));\nlet currentCustomLessons = [];\n\nfunction setCurrentYear() {\n  const yearEl = document.querySelector('[data-component=\"copyright-year\"]');\n  if (yearEl) {\n    yearEl.textContent = String(new Date().getFullYear());\n  }\n}\n\nfunction normalise(value) {\n  const stringValue = String(value ?? '');\n  const normalizedValue =\n    typeof stringValue.normalize === 'function'\n      ? stringValue.normalize('NFKD')\n      : stringValue;\n  return normalizedValue\n    .toLowerCase()\n    .replace(/[\\u2019\\u2018\\u02bc'`]/g, '')\n    .replace(/[^a-z0-9\\u0400-\\u04FF]+/g, ' ')\n    .replace(/\\s+/g, ' ')\n    .trim();\n}\n\nfunction createTopicOption(lesson) {\n  const textContent = `${lesson.title} ${lesson.description || ''} ${(lesson.tags || []).join(' ')}`;\n  const label = document.createElement('label');\n  label.className = 'checkbox builder-option';\n  label.dataset.topicId = lesson.id;\n  label.dataset.searchSource = textContent;\n  label.innerHTML = `\n    <input type=\"checkbox\" name=\"topics\" value=\"${lesson.id}\" data-category=\"${lesson.category}\" />\n    <span class=\"builder-option__content\">\n      <span class=\"builder-option__title\">${lesson.title}</span>\n      <span class=\"builder-option__meta\">Рівень: ${lesson.level}${lesson.description ? ` · ${lesson.description}` : ''}</span>\n    </span>\n  `;\n  return label;\n}\n\nfunction populateGroups() {\n  groups.forEach((group) => {\n    const category = group.dataset.builderGroup;\n    const listElement = group.querySelector('[data-group-list]');\n    if (!category || !listElement) return;\n\n    const topics = lessons.filter((lesson) => lesson.category === category);\n    const fragment = document.createDocumentFragment();\n    topics\n      .sort((a, b) => a.title.localeCompare(b.title, 'uk'))\n      .forEach((topic) => fragment.appendChild(createTopicOption(topic)));\n\n    listElement.innerHTML = '';\n    listElement.appendChild(fragment);\n  });\n}\n\nfunction buildSearchTokens(value) {\n  return normalise(value)\n    .split(' ')\n    .filter(Boolean);\n}\n\nfunction getOptionTokens(option) {\n  if (!option) return [];\n\n  if (!option.dataset.searchTokensCache) {\n    const baseText = option.dataset.searchSource || option.textContent || '';\n    const tokens = buildSearchTokens(baseText);\n    option.dataset.searchTokensCache = tokens.join('|');\n  }\n\n  return option.dataset.searchTokensCache.split('|').filter(Boolean);\n}\n\nfunction setOptionVisibility(option, shouldShow) {\n  option.hidden = !shouldShow;\n  option.classList.toggle('is-hidden', !shouldShow);\n}\n\nfunction filterGroup(group, query) {\n  const options = Array.from(group.querySelectorAll('.builder-option'));\n  const queryTokens = buildSearchTokens(query);\n\n  if (queryTokens.length === 0) {\n    options.forEach((option) => setOptionVisibility(option, true));\n    group.dataset.matches = String(options.length);\n    group.removeAttribute('data-group-empty');\n    return;\n  }\n\n  let matches = 0;\n  options.forEach((option) => {\n    const optionTokens = getOptionTokens(option);\n    const isMatch = queryTokens.every((token) =>\n      optionTokens.some((optionToken) => optionToken.includes(token)),\n    );\n\n    setOptionVisibility(option, isMatch);\n\n    if (isMatch) {\n      matches += 1;\n    }\n  });\n\n  group.dataset.matches = String(matches);\n  if (matches === 0) {\n    group.dataset.groupEmpty = 'true';\n  } else {\n    delete group.dataset.groupEmpty;\n  }\n}\n\nfunction handleSearchInput(event) {\n  const input = event.target;\n  const group = input?.closest('[data-builder-group]');\n  if (!group) return;\n  filterGroup(group, input.value);\n}\n\nfunction toggleGroupVisibility(button) {\n  const group = button.closest('[data-builder-group]');\n  if (!group) return;\n  const body = group.querySelector('[data-group-body]');\n  if (!body) return;\n\n  const isHidden = body.hidden;\n  body.hidden = !isHidden;\n  button.textContent = body.hidden ? 'Розгорнути' : 'Згорнути';\n}\n\nfunction collectSelectedTopics() {\n  if (!form) return [];\n  return Array.from(form.querySelectorAll('input[name=\"topics\"]:checked')).map(\n    (input) => ({\n      id: input.value,\n      category: input.dataset.category,\n    }),\n  );\n}\n\nfunction setStatus(message, state = 'idle') {\n  if (!statusElement) return;\n  statusElement.textContent = message;\n  statusElement.dataset.state = state;\n}\n\nfunction createLessonId(title) {\n  const base = normalise(title)\n    .replace(/[^a-z0-9]+/g, '-')\n    .replace(/^-+|-+$/g, '')\n    .slice(0, 32);\n  const suffix = Date.now().toString(36);\n  return `custom-${base || 'lesson'}-${suffix}`;\n}\n\nfunction handleFormSubmit(event) {\n  event.preventDefault();\n  setStatus('Зберігаємо…', 'saving');\n\n  const formData = new FormData(form);\n  const title = String(formData.get('title') || '').trim();\n  if (!title) {\n    setStatus('Вкажіть назву уроку.', 'error');\n    return;\n  }\n\n  const selected = collectSelectedTopics();\n  if (!selected.length) {\n    setStatus('Оберіть принаймні одну тему.', 'error');\n    return;\n  }\n\n  const id = createLessonId(title);\n  const topicIds = selected.map((item) => item.id);\n  const lesson = createCustomLesson({ id, title, topicIds });\n  currentCustomLessons = loadCustomLessons();\n  renderSavedLessons();\n  form.reset();\n  groups.forEach((group) => {\n    filterGroup(group, '');\n  });\n  setStatus(`Урок «${lesson.title}» збережено.`, 'success');\n  if (statusElement) {\n    const link = document.createElement('a');\n    link.href = `lesson.html?custom=${encodeURIComponent(lesson.id)}`;\n    link.textContent = ' Відкрити';\n    link.className = 'builder-status__link';\n    statusElement.appendChild(link);\n  }\n}\n\nfunction describeLessonTopics(topicIds) {\n  const topics = topicIds\n    .map((id) => lessons.find((lesson) => lesson.id === id))\n    .filter(Boolean);\n  const grammarCount = topics.filter((topic) => topic.category === 'grammar').length;\n  const lexicalCount = topics.filter((topic) => topic.category === 'lexical').length;\n  const titles = topics.map((topic) => topic.title);\n\n  return {\n    grammarCount,\n    lexicalCount,\n    titles,\n  };\n}\n\nfunction renderSavedLessons() {\n  if (!savedListElement || !savedEmptyElement) return;\n\n  const lessonsToRender = currentCustomLessons\n    .slice()\n    .sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n\n  savedListElement.innerHTML = '';\n\n  if (!lessonsToRender.length) {\n    savedEmptyElement.hidden = false;\n    return;\n  }\n\n  savedEmptyElement.hidden = true;\n\n  const fragment = document.createDocumentFragment();\n  lessonsToRender.forEach((lesson) => {\n    const meta = describeLessonTopics(lesson.topicIds || []);\n    const card = document.createElement('article');\n    card.className = 'builder-card';\n\n    const title = document.createElement('h3');\n    title.className = 'builder-card__title';\n    title.textContent = lesson.title;\n\n    const metaEl = document.createElement('p');\n    metaEl.className = 'builder-card__meta';\n    const metaParts = [];\n    if (meta.grammarCount) metaParts.push(`Граматика: ${meta.grammarCount}`);\n    if (meta.lexicalCount) metaParts.push(`Лексика: ${meta.lexicalCount}`);\n    metaEl.textContent = metaParts.join(' · ');\n\n    const topics = document.createElement('p');\n    topics.className = 'builder-card__topics';\n    topics.textContent = meta.titles.join(', ');\n\n    const actions = document.createElement('div');\n    actions.className = 'builder-card__actions';\n\n    const openLink = document.createElement('a');\n    openLink.className = 'button button--ghost';\n    openLink.href = `lesson.html?custom=${encodeURIComponent(lesson.id)}`;\n    openLink.textContent = 'Відкрити';\n\n    const deleteButton = document.createElement('button');\n    deleteButton.className = 'button button--danger';\n    deleteButton.type = 'button';\n    deleteButton.dataset.deleteId = lesson.id;\n    deleteButton.textContent = 'Видалити';\n\n    actions.appendChild(openLink);\n    actions.appendChild(deleteButton);\n\n    card.appendChild(title);\n    if (metaParts.length) {\n      card.appendChild(metaEl);\n    }\n    if (meta.titles.length) {\n      card.appendChild(topics);\n    }\n    card.appendChild(actions);\n    fragment.appendChild(card);\n  });\n\n  savedListElement.appendChild(fragment);\n}\n\nfunction handleSavedListClick(event) {\n  const button = event.target.closest('button[data-delete-id]');\n  if (!button) return;\n  const { deleteId } = button.dataset;\n  if (!deleteId) return;\n  const removed = deleteCustomLesson(deleteId);\n  if (removed) {\n    currentCustomLessons = loadCustomLessons();\n    renderSavedLessons();\n  }\n}\n\nfunction syncWithStorage() {\n  currentCustomLessons = loadCustomLessons();\n  renderSavedLessons();\n}\n\nfunction initControls() {\n  groups.forEach((group) => {\n    const searchInput = group.querySelector('[data-group-search]');\n    const toggleButton = group.querySelector('[data-group-toggle]');\n\n    searchInput?.addEventListener('input', handleSearchInput);\n    toggleButton?.addEventListener('click', (event) => {\n      toggleGroupVisibility(event.currentTarget);\n    });\n  });\n\n  form?.addEventListener('submit', handleFormSubmit);\n  savedListElement?.addEventListener('click', handleSavedListClick);\n\n  subscribeToStorage((lessonsFromStorage) => {\n    currentCustomLessons = lessonsFromStorage;\n    renderSavedLessons();\n  });\n}\n\nfunction init() {\n  setCurrentYear();\n  populateGroups();\n  syncWithStorage();\n  initControls();\n}\n\ninit();\n"],"names":["form","statusElement","savedListElement","savedEmptyElement","groups","currentCustomLessons","setCurrentYear","yearEl","normalise","value","stringValue","createTopicOption","lesson","textContent","label","populateGroups","group","category","listElement","topics","lessons","fragment","b","topic","buildSearchTokens","getOptionTokens","option","baseText","tokens","setOptionVisibility","shouldShow","filterGroup","query","options","queryTokens","matches","optionTokens","isMatch","token","optionToken","handleSearchInput","event","input","toggleGroupVisibility","button","body","isHidden","collectSelectedTopics","setStatus","message","state","createLessonId","title","base","suffix","handleFormSubmit","formData","selected","id","topicIds","item","createCustomLesson","loadCustomLessons","renderSavedLessons","link","describeLessonTopics","grammarCount","lexicalCount","titles","lessonsToRender","a","meta","card","metaEl","metaParts","actions","openLink","deleteButton","handleSavedListClick","deleteId","deleteCustomLesson","syncWithStorage","initControls","searchInput","toggleButton","subscribeToStorage","lessonsFromStorage","init"],"mappings":"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"}