{"version":3,"file":"revision-test.js","sources":["../src/features/revision-tests/revision-test-detail.js"],"sourcesContent":["import { renderPracticeTaskList } from '@features/practice/practice.js';\nimport { findRevisionTestBySlug } from './revision-tests-registry.js';\n\nfunction setTextContent(element, value, options = {}) {\n  if (!element) return;\n  const { prefix = '', suffix = '' } = options;\n  if (value) {\n    element.textContent = `${prefix}${value}${suffix}`;\n    element.hidden = false;\n  } else {\n    element.textContent = '';\n    element.hidden = true;\n  }\n}\n\nfunction collectMetaItems(test) {\n  const items = [];\n  if (test.level) {\n    items.push(`Рівень: ${test.level}`);\n  }\n  if (Number.isFinite(test.duration) && test.duration > 0) {\n    items.push(`Тривалість: ~${test.duration} хв`);\n  }\n  const taskCount = Array.isArray(test.tasks) ? test.tasks.length : 0;\n  if (taskCount) {\n    items.push(`Кількість завдань: ${taskCount}`);\n  }\n  if (Array.isArray(test.tags) && test.tags.length) {\n    items.push(`Мітки: ${test.tags.join(', ')}`);\n  }\n  return items;\n}\n\nfunction renderSummary(test) {\n  const summarySection = document.querySelector('[data-test-summary]');\n  const descriptionElement = document.querySelector('[data-test-description]');\n  const metaElement = document.querySelector('[data-test-meta]');\n\n  if (!summarySection || !descriptionElement || !metaElement) return;\n\n  const hasDescription =\n    typeof test.description === 'string' && test.description.trim().length > 0;\n  const metaItems = collectMetaItems(test);\n\n  if (!hasDescription && metaItems.length === 0) {\n    summarySection.hidden = true;\n    descriptionElement.textContent = '';\n    metaElement.innerHTML = '';\n    return;\n  }\n\n  const taglineElement = document.querySelector('[data-test-tagline]');\n  const trimmedDescription = hasDescription ? test.description.trim() : '';\n  const showDescription =\n    hasDescription &&\n    (!taglineElement || taglineElement.textContent !== trimmedDescription);\n  descriptionElement.textContent = showDescription ? trimmedDescription : '';\n  descriptionElement.hidden = !showDescription;\n\n  if (metaItems.length) {\n    metaElement.innerHTML = metaItems.map(item => `<li>${item}</li>`).join('');\n    metaElement.hidden = false;\n  } else {\n    metaElement.innerHTML = '';\n    metaElement.hidden = true;\n  }\n\n  summarySection.hidden = false;\n}\n\nfunction renderPractice(test) {\n  const practiceRoot = document.querySelector('[data-test-practice]');\n  const practiceNote = document.querySelector('.revision-practice__note');\n  if (!practiceRoot) return;\n\n  practiceRoot.innerHTML = '';\n  const tasks = Array.isArray(test.tasks) ? test.tasks.filter(Boolean) : [];\n  if (!tasks.length) {\n    if (practiceNote) {\n      practiceNote.hidden = true;\n    }\n    const note = document.createElement('p');\n    note.className = 'muted';\n    note.textContent =\n      'Для цієї контрольної роботи поки що немає завдань. Додайте їх у відповідний файл у `src/data/revision-tests`.';\n    practiceRoot.appendChild(note);\n    return;\n  }\n\n  if (practiceNote) {\n    practiceNote.hidden = false;\n  }\n\n  renderPracticeTaskList(practiceRoot, tasks, {\n    title: test.title,\n    level: test.level,\n    description: test.description,\n    keyPrefix: test.id || test.slug,\n    showRemove: false,\n  });\n}\n\nfunction showError(message) {\n  const container = document.querySelector('[data-test-content]');\n  if (container) {\n    container.innerHTML = `<p class=\"muted\">${message}</p>`;\n  }\n}\n\nfunction init() {\n  const params = new URLSearchParams(window.location.search);\n  const slug = params.get('test');\n\n  if (!slug) {\n    showError(\n      'Не вдалося визначити, яку контрольну роботу потрібно відкрити. Перейдіть зі списку на сторінці контрольних.'\n    );\n    return;\n  }\n\n  const test = findRevisionTestBySlug(slug);\n  if (!test) {\n    showError(\n      'Контрольну роботу не знайдено. Перевірте, чи правильно вказано посилання, або відкрийте список контрольних.'\n    );\n    return;\n  }\n\n  const titleElement = document.querySelector('[data-test-title]');\n  const eyebrowElement = document.querySelector('[data-test-eyebrow]');\n  const taglineElement = document.querySelector('[data-test-tagline]');\n  const levelElement = document.querySelector('[data-test-level]');\n  const durationElement = document.querySelector('[data-test-duration]');\n  const tagsElement = document.querySelector('[data-test-tags]');\n\n  if (titleElement) {\n    titleElement.textContent = test.title || 'Контрольна робота';\n  }\n\n  if (eyebrowElement) {\n    eyebrowElement.textContent = 'Контрольна робота';\n  }\n\n  const metaItems = collectMetaItems(test);\n  const trimmedDescription =\n    typeof test.description === 'string' ? test.description.trim() : '';\n  if (taglineElement) {\n    if (trimmedDescription) {\n      taglineElement.textContent = trimmedDescription;\n    } else if (metaItems.length) {\n      taglineElement.textContent = metaItems.join(' • ');\n    } else {\n      taglineElement.textContent =\n        'Використайте завдання нижче, щоб перевірити знання учня.';\n    }\n  }\n\n  setTextContent(levelElement, test.level, { prefix: 'Рівень: ' });\n  setTextContent(durationElement, Number.isFinite(test.duration) ? `~${test.duration} хв` : '', {\n    prefix: 'Тривалість: ',\n  });\n  setTextContent(\n    tagsElement,\n    Array.isArray(test.tags) && test.tags.length ? test.tags.join(', ') : '',\n    { prefix: 'Мітки: ' }\n  );\n\n  renderSummary(test);\n  renderPractice(test);\n}\n\ninit();\n\nconst footerYear = document.querySelector('[data-component=\"copyright-year\"]');\nif (footerYear) {\n  footerYear.textContent = String(new Date().getFullYear());\n}\n"],"names":["setTextContent","element","value","options","prefix","suffix","collectMetaItems","test","items","taskCount","renderSummary","summarySection","descriptionElement","metaElement","hasDescription","metaItems","taglineElement","trimmedDescription","showDescription","item","renderPractice","practiceRoot","practiceNote","tasks","note","renderPracticeTaskList","showError","message","container","init","slug","findRevisionTestBySlug","titleElement","eyebrowElement","levelElement","durationElement","tagsElement","footerYear"],"mappings":"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"}