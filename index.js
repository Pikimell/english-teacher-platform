import"./assets/main-ClRbC28d.js";import{s as $,l,b as L,a as I}from"./assets/custom-lessons-store-BKMVZjuV.js";import{c as y}from"./assets/custom-lesson-presets-BlE7b2P4.js";const n={search:"",category:"all",level:"all"},h=document.querySelector('[data-filter="search"]'),v=document.querySelector('[data-filter="level"]'),C=Array.from(document.querySelectorAll("[data-category]")),d=document.querySelector("[data-lessons-section]"),p=document.querySelector("[data-lessons-grid]"),f=document.querySelector("[data-lessons-empty]"),c={total:document.querySelector("[data-stat-total]"),grammar:document.querySelector("[data-stat-grammar]"),lexical:document.querySelector("[data-stat-lexical]")};function m(e){return e.trim().toLowerCase()}function g(e){return String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function S(){C.forEach(e=>{const t=e.dataset.category===n.category,a=e.dataset.category==="all"?n.category==="all":t;e.classList.toggle("chip--filled",a),e.setAttribute("aria-pressed",String(a))})}function A(e){var s;const t=((s=L[e.category])==null?void 0:s.label)??e.category,r=`lesson.html?topic=${encodeURIComponent(e.id)}&category=${encodeURIComponent(e.category)}&level=${encodeURIComponent(e.level)}&title=${encodeURIComponent(e.title)}&file=${encodeURIComponent(e.htmlPath)}`,a=Array.isArray(e.tags)?e.tags:[];return`
    <article class="lesson-card" data-lesson-id="${e.id}" data-category="${e.category}" data-level="${e.level}">
      <a class="lesson-card__link" href="${r}">
        <div class="lesson-card__meta">
          <span class="lesson-card__category">${t}</span>
          <span class="lesson-card__level" aria-label="Рівень">${e.level}</span>
        </div>
        <h3 class="lesson-card__title">${e.title}</h3>
        <p class="lesson-card__description">${e.description}</p>
        ${a.length?`<ul class="lesson-card__tags">${a.map(o=>`<li>${o}</li>`).join("")}</ul>`:""}
        <span class="lesson-card__cta">Перейти до матеріалу</span>
      </a>
    </article>
  `}function _(e){const t=(e.topicIds||[]).map(o=>l.find(u=>u.id===o)).filter(Boolean),r=Array.from(new Set(t.map(o=>o.level))).sort(),a=t.filter(o=>o.category==="grammar").length,s=t.filter(o=>o.category==="lexical").length;return{topics:t,levels:r,grammarCount:a,lexicalCount:s}}function x(e,t=_(e)){const r=e.description||t.topics.map(o=>o.title).slice(0,3).join(", "),a=e.level||(t.levels.length?t.levels.join(", "):"мікси рівнів"),s=[];return a&&s.push(`Рівні: ${g(a)}`),t.grammarCount&&s.push(`Граматика: ${t.grammarCount}`),t.lexicalCount&&s.push(`Лексика: ${t.lexicalCount}`),`
    <article class="lesson-card lesson-card--custom" data-custom-lesson-id="${e.id}" data-custom-source="${e.source||"local"}">
      <a class="lesson-card__link" href="lesson.html?custom=${encodeURIComponent(e.id)}">
        
       <h3 class="lesson-card__title">${g(e.title)}</h3>
        ${s.length?`<p class="lesson-card__meta">${s.join(" · ")}</p>`:""}
        <p class="lesson-card__description">${g(r||"Урок містить кілька тем.")}</p>
        
        <span class="lesson-card__cta">Відкрити комбінований урок</span>
      </a>
    </article>
  `}function k(){return Array.isArray(y)?y.filter(e=>e&&typeof e=="object"&&e.id).map((e,t)=>({...e,topicIds:Array.isArray(e.topicIds)?[...e.topicIds]:[],source:"preset",sortIndex:t})):[]}function q(){return I().filter(e=>e&&typeof e=="object"&&e.id).map((e,t)=>({...e,topicIds:Array.isArray(e.topicIds)?[...e.topicIds]:[],source:"local",sortIndex:1e3+t}))}function T(){const e=new Map;return k().forEach(t=>{e.has(t.id)||e.set(t.id,t)}),q().forEach(t=>{e.set(t.id,t)}),Array.from(e.values())}function b(){const e=s=>{const o=s?new Date(s).getTime():0;return Number.isFinite(o)?o:0},r=T().slice().sort((s,o)=>{const u=e(o.createdAt)-e(s.createdAt);return u!==0?u:(s.sortIndex||0)-(o.sortIndex||0)}).map(s=>{const o=_(s);return{type:"custom",lesson:s,meta:o}}),a=l.map(s=>({type:"catalog",lesson:s}));return[...r,...a]}function E(e){return n.category==="all"?!0:e.type==="catalog"?e.lesson.category===n.category:!1}function R(e){var a;if(n.level==="all")return!0;if(e.type==="catalog")return e.lesson.level===n.level;const t=e.lesson.level;return t?t===n.level:(((a=e.meta)==null?void 0:a.levels)??[]).includes(n.level)}function j(e,t){const a=((t==null?void 0:t.topics)??[]).flatMap(s=>[s.title,s.description,...s.tags||[]].filter(Boolean));return[e.title,e.description,...e.tags||[],e.level,...a].filter(Boolean).map(s=>m(String(s)))}function M(e,t){return t?e.type==="catalog"?[e.lesson.title,e.lesson.description,...e.lesson.tags??[]].filter(Boolean).map(s=>m(String(s))).some(s=>s.includes(t)):j(e.lesson,e.meta).some(a=>a.includes(t)):!0}function B(){const e=b(),t=m(n.search);return e.filter(r=>!E(r)||!R(r)?!1:M(r,t))}function i(){if(!p||!f)return;const e=B();if(!e.length){p.innerHTML="",f.hidden=!1,d&&(d.dataset.hasResults="false");return}const t=e.map(r=>r.type==="custom"?x(r.lesson,r.meta):A(r.lesson)).join("");p.innerHTML=t,f.hidden=!0,d&&(d.dataset.hasResults="true")}function U(){c.total&&(c.total.textContent=String(l.length)),c.grammar&&(c.grammar.textContent=String(l.filter(e=>e.category==="grammar").length)),c.lexical&&(c.lexical.textContent=String(l.filter(e=>e.category==="lexical").length))}function w(e){n.search=e.target.value,i()}function P(e){n.level=e.target.value,i()}function D(e){const t=e.currentTarget.dataset.category;t&&(n.category=t,S(),i())}function H(){const e=document.querySelector('[data-component="copyright-year"]');e&&(e.textContent=String(new Date().getFullYear()))}function Y(){U(),S(),i(),H(),h&&h.addEventListener("input",w),v&&v.addEventListener("change",P),C.forEach(e=>{e.addEventListener("click",D)}),$(()=>{i()})}Y();
//# sourceMappingURL=index.js.map
